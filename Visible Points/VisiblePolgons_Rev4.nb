(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    101403,       2331]
NotebookOptionsPosition[     97355,       2255]
NotebookOutlinePosition[     97727,       2271]
CellTagsIndexPosition[     97684,       2268]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "a", " ", "Nested", " ", "list", " ", "of", " ", "pair", 
    " ", "of", " ", "points", " ", "representing", " ", "each", " ", "line", 
    " ", "in", " ", "polygon"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lineList", "[", "list_", "]"}], ":=", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"list", ",", 
        RowBox[{"First", "[", "list", "]"}]}], "]"}], ",", "2", ",", "1"}], 
     "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.760802532026407*^9, 3.7608026249231467`*^9}, {
  3.760802678975656*^9, 3.760802687697389*^9}, {3.760803348506281*^9, 
  3.760803349726018*^9}},
 CellLabel->"In[208]:=",
 CellID->141966600,ExpressionUUID->"88d9f809-dc68-4788-9626-b8ba37abf48a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "a", " ", "Vector", " ", "for", " ", "a", " ", "line", " ",
     "between", " ", "two", " ", "points"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vector", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x2", "-", "x1"}], ",", 
     RowBox[{"y2", "-", "y1"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7584068810924025`*^9, 3.75840691133554*^9}, 
   3.7585649723581924`*^9, 3.7590244926122665`*^9, {3.761068203338044*^9, 
   3.761068204944496*^9}, {3.7610689112909594`*^9, 3.761068916365572*^9}},
 CellLabel->"In[209]:=",
 CellID->126976910,ExpressionUUID->"036b12bf-8e74-40c6-8773-b88969294126"],

Cell["\<\
Reference : https : // demonstrations.wolfram.com/SegmentIntersection\
\>", "Text",
 CellChangeTimes->{{3.7616058650092936`*^9, 
  3.761605896089101*^9}},ExpressionUUID->"0642877f-fdb6-4d68-b4e1-\
3f38f444b863"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "parametric", " ", "equation", " ", "of", " ", "the", " ", 
     "line", " ", "containing", " ", "the", " ", "points", " ", 
     FormBox["a",
      TraditionalForm], " ", "and", " ", 
     FormBox["b",
      TraditionalForm], " ", "is", " ", 
     FormBox[
      RowBox[{"a", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"(", 
         RowBox[{"b", "-", "a"}], ")"}]}]}],
      TraditionalForm]}], ",", " ", 
    RowBox[{"where", " ", 
     FormBox[
      RowBox[{"0", "\[LessEqual]", "\[Lambda]", "\[LessEqual]", "1"}],
      TraditionalForm], " ", "for", " ", "points", " ", "between", " ", 
     FormBox["a",
      TraditionalForm], " ", "and", " ", 
     RowBox[{
      FormBox["b",
       TraditionalForm], ".", " ", "The"}], " ", "value", " ", "of", " ", 
     FormBox["\[Lambda]",
      TraditionalForm], " ", "is", " ", "given", " ", "by"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], "]"}], "[", "p_", "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "p"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}]}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.4281084522943907`*^9, 3.428108457088719*^9}, 
   3.4281085989154177`*^9, {3.428109418727551*^9, 3.428109419857239*^9}, {
   3.428117842316123*^9, 3.4281178428869658`*^9}, {3.4281179104322577`*^9, 
   3.428117911200409*^9}, 3.4281192939076843`*^9, {3.428145787108582*^9, 
   3.4281457888069077`*^9}, {3.50090385468817*^9, 3.5009038573034554`*^9}, {
   3.761605768653043*^9, 3.7616057689312773`*^9}, 3.761605910628242*^9, {
   3.7626542824215937`*^9, 3.7626542886133804`*^9}, {3.7626543313306875`*^9, 
   3.762654333925927*^9}},
 CellLabel->"In[210]:=",
 CellID->91357628,ExpressionUUID->"708bcef0-023e-4ed0-b2fc-09beb59b29aa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", 
     FormBox["p",
      TraditionalForm], " ", "on", " ", "the", " ", 
     RowBox[{"line", ".", " ", "For"}], " ", 
     FormBox["p",
      TraditionalForm], " ", "not", " ", "on", " ", "the", " ", "line"}], ",",
     " ", 
    RowBox[{
     FormBox["\[Lambda]",
      TraditionalForm], " ", "gives", " ", "the", " ", "closest", " ", 
     "point", " ", "on", " ", "the", " ", 
     RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Two", " ", "lines"}], ",", " ", 
    RowBox[{
     SubscriptBox["L", 
      RowBox[{"1", " "}]], "containing", " ", "the", " ", "points", " ", "a", 
     " ", "and", " ", "b", " ", "with", " ", "line", " ", 
     FormBox[
      SubscriptBox["L", "2"],
      TraditionalForm], " ", "containing", " ", "the", " ", "points", " ", 
     FormBox["c",
      TraditionalForm], " ", "and", " ", 
     FormBox["d",
      TraditionalForm]}], ",", " ", 
    RowBox[{"intersect", " ", "at", " ", "a", " ", 
     RowBox[{
      RowBox[{"point", " ", "\[DoubleLongLeftRightArrow]", " ", 
       FormBox[
        RowBox[{
         FormBox[
          TagBox[
           RowBox[{"\[LeftBracketingBar]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "-", "b"}], ",", 
              RowBox[{"c", "-", "d"}]}], "}"}], "\[RightBracketingBar]"}],
           {Det}],
          TraditionalForm], "\[NotEqual]", "0"}],
        TraditionalForm]}], ".", "  ", "Compute"}], " ", "the", " ", 
     "intersection", " ", 
     RowBox[{"point", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LineIntersectionPoint", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c_", ",", "d_"}], "}"}]}], "}"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Det", "[", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"c", "-", "d"}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"Det", "[", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"a", "-", "b"}], ")"}]}]}], 
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "-", "b"}], ",", 
       RowBox[{"c", "-", "d"}]}], "}"}], "]"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.4281084522943907`*^9, 3.428108457088719*^9}, 
   3.4281085989154177`*^9, {3.428109418727551*^9, 3.428109419857239*^9}, {
   3.428117842316123*^9, 3.4281178428869658`*^9}, {3.4281179104322577`*^9, 
   3.428117911200409*^9}, 3.4281192939076843`*^9, {3.428145787108582*^9, 
   3.4281457888069077`*^9}, {3.50090385468817*^9, 3.5009038573034554`*^9}, {
   3.5009039001263857`*^9, 3.500903903357723*^9}, 3.500904008130921*^9, {
   3.5009048198824835`*^9, 3.50090482194969*^9}, {3.7616057550025682`*^9, 
   3.7616057609376574`*^9}},
 CellLabel->"In[211]:=",
 CellID->1379934535,ExpressionUUID->"f4a0dd36-4d89-448e-9721-7a6e1410da37"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Use", " ", 
    FormBox[
     RowBox[{
      FormBox[
       TagBox[
        RowBox[{"\[LeftBracketingBar]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "-", "b"}], ",", 
           RowBox[{"c", "-", "d"}]}], "}"}], "\[RightBracketingBar]"}],
        {Det}],
       TraditionalForm], "\[NotEqual]", "0"}],
     TraditionalForm], " ", "along", " ", "with", " ", "the", " ", 
    "condition", " ", 
    FormBox[
     RowBox[{"0", "\[LessEqual]", "\[Lambda]", "\[LessEqual]", "1"}],
     TraditionalForm], " ", "to", " ", "determine", " ", "whether", " ", 
    "two", " ", "segments", " ", 
    RowBox[{"intersect", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SegmentIntersectionQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"c_", ",", "d_"}], "}"}]}]}], "}"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Det", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"a", "-", "b"}], ",", 
          RowBox[{"c", "-", "d"}]}], "}"}], "]"}], "\[Equal]", "0"}], ",", 
      "False", ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", "=", 
          RowBox[{"LineIntersectionPoint", "[", 
           RowBox[{"{", 
            RowBox[{"p1", ",", "p2"}], "}"}], "]"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"0", "\[LessEqual]", "  ", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", "p1", "]"}], "[", "p", "]"}], 
           "\[LessEqual]", "  ", "1"}], ")"}], " ", "&&", 
         RowBox[{"(", 
          RowBox[{"0", "\[LessEqual]", "  ", 
           RowBox[{
            RowBox[{"\[Lambda]", "[", "p2", "]"}], "[", "p", "]"}], 
           "\[LessEqual]", "  ", "1"}], ")"}], "&&", " ", 
         RowBox[{"Not", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"p", "\[Equal]", " ", "a"}], " ", "||", "  ", 
            RowBox[{"p", "\[Equal]", " ", "b"}], " ", "||", "  ", 
            RowBox[{"p", "\[Equal]", " ", "c"}], " ", "||", "  ", 
            RowBox[{"p", "\[Equal]", " ", "d"}]}], ")"}]}]}]}], "  ", "]"}]}],
      "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "made", " ", "a", "  ", "change", " ", "in", " ", "the", " ", 
     "condition"}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4281120146814823`*^9, 3.428112038173441*^9}, {
   3.4281156218433657`*^9, 3.428115623999099*^9}, {3.428117226280767*^9, 
   3.428117227670485*^9}, {3.428117869609064*^9, 3.428117887706465*^9}, 
   3.428117957558598*^9, {3.4281190826590567`*^9, 3.4281190913794613`*^9}, {
   3.42811912287589*^9, 3.428119141904117*^9}, {3.4281191810207863`*^9, 
   3.4281191816062098`*^9}, {3.428120493598702*^9, 3.428120496943215*^9}, {
   3.428145791126446*^9, 3.428145800901572*^9}, {3.500889749371381*^9, 
   3.500889800208735*^9}, 3.5009034278288603`*^9, 3.5009038327477703`*^9, {
   3.500904329717358*^9, 3.5009043324100313`*^9}, {3.7615783582430353`*^9, 
   3.7615783608420687`*^9}, {3.7615784098649197`*^9, 
   3.7615784623365545`*^9}, {3.7615785340138035`*^9, 
   3.7615785412933445`*^9}, {3.761578623094496*^9, 3.7615786263358383`*^9}, {
   3.761578699864112*^9, 3.761578746837474*^9}, {3.7616057453114967`*^9, 
   3.761605746258957*^9}, {3.7626536723509507`*^9, 3.762653677816164*^9}, {
   3.762653926453739*^9, 3.762653928787074*^9}, {3.7626541830724773`*^9, 
   3.7626542003908863`*^9}, {3.7635775164198837`*^9, 
   3.7635775259739723`*^9}, {3.7635778270623765`*^9, 3.763577836000063*^9}, {
   3.7635790725384912`*^9, 3.763579190961801*^9}, {3.7635792381035557`*^9, 
   3.763579242357274*^9}, {3.763579365272222*^9, 3.7635794041264677`*^9}, {
   3.7635794875724025`*^9, 3.7635794883617067`*^9}, {3.7635806648743563`*^9, 
   3.763580686258615*^9}, {3.7635808515727286`*^9, 3.763580898507636*^9}, {
   3.7635816496363373`*^9, 3.7635817073519993`*^9}},
 CellLabel->"In[212]:=",
 CellID->1016457520,ExpressionUUID->"fa04a22e-df40-4dc8-ba08-b52380cf9848"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{" ", 
     RowBox[{"Returns", " ", "the", " ", "angle", " ", "made", " ", 
      RowBox[{"in", " ", "[", 
       RowBox[{"o", ",", 
        RowBox[{"2", "Pi"}]}]}]}], ")"}], " ", "Range"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Reference", ":", " ", "https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "111629"}], "/", "calculating"}], "-", "the", "-",
      "angle", "-", "between", "-", "the", "-", "line", "-", "joining", "-", 
     "two", "-", "points", "-", "and", "-", "the", "-", "x", "-", "axis"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getAngle", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"x2", "-", "x1"}], ",", 
       RowBox[{"y2", "-", "y1"}]}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.762211812183926*^9, 3.762211812227189*^9}, {
  3.762212133389465*^9, 3.7622121673627377`*^9}, {3.762212462429222*^9, 
  3.762212464180242*^9}, {3.7622125740765963`*^9, 3.7622125761070414`*^9}, {
  3.762212606447076*^9, 3.7622126078563104`*^9}, {3.762212782962586*^9, 
  3.762212784950568*^9}, {3.7622129567595778`*^9, 3.762212959837753*^9}, {
  3.7622138703932433`*^9, 3.7622138731561513`*^9}, {3.762393097385004*^9, 
  3.7623931256973104`*^9}, {3.762393422476513*^9, 3.762393430482111*^9}, {
  3.7623938017506027`*^9, 3.7623938052821507`*^9}, {3.76239386930202*^9, 
  3.7623938920402184`*^9}, {3.7623940390591536`*^9, 3.7623940446881514`*^9}},
 CellLabel->
  "In[213]:=",ExpressionUUID->"836c3ddb-844c-4fdf-a831-21622428b376"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertexList", "[", "list_", "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"list", ",", 
      RowBox[{"list", "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], "]"}], ",", "3",
     ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7632217125289803`*^9, 3.76322172258762*^9}, {
   3.7632255886478095`*^9, 3.7632255905058174`*^9}, {3.7632256227611103`*^9, 
   3.763225629488167*^9}, 3.7632256596711035`*^9, {3.7632257080789433`*^9, 
   3.76322578038266*^9}, {3.7632272291279907`*^9, 3.763227236570083*^9}},
 CellLabel->
  "In[214]:=",ExpressionUUID->"f964c0c7-a2c9-4aab-82e0-244a9cf7bd7f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "true", " ", "if", " ", "pt", "  ", "is", " ", "inside", " ", "polygon"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"testpoint", "[", 
    RowBox[{"poly_", ",", "pt_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Round", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "@", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "-", 
               RowBox[{"RotateRight", "[", "#", "]"}]}], ")"}], "&"}], "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"ArcTan", "@@", 
                RowBox[{"(", 
                 RowBox[{"pt", "-", "#"}], ")"}]}], "&"}], "/@", "poly"}], 
             ")"}]}], ",", 
           RowBox[{"2", " ", "Pi"}], ",", 
           RowBox[{"-", "Pi"}]}], "]"}]}], "/", "2"}], "/", "Pi"}], ")"}], 
     "]"}], "\[NotEqual]", "0"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7635624224713607`*^9, 3.7635624330425425`*^9}, {
  3.763579666001822*^9, 3.7635796671075287`*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"0df7685d-e127-4097-a63f-82b5941f3211"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "o", ",", "boundpoly", ",", "poly1", ",", "poly2", ",", 
       "listofAllLines", ",", "sortedList", ",", "sortedText", ",", 
       RowBox[{"jList", "=", 
        RowBox[{"{", "}"}]}], ",", "InfinteLine", ",", "i", ",", 
       RowBox[{"visibleList", "=", 
        RowBox[{"{", "}"}]}], ",", "wi", ",", "wip", ",", 
       RowBox[{"oldO", "=", 
        RowBox[{"{", "}"}]}], ",", 
       RowBox[{"oldP", "=", 
        RowBox[{"{", "}"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Obsctale", " ", "Centroids"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"o", "=", 
       RowBox[{"{", 
        RowBox[{"o1", ",", "o2"}], "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Obstacle", " ", "and", " ", "Boundary", " ", "Polygon", " ", 
        "Points"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"boundpoly", "=", 
       RowBox[{"5", 
        RowBox[{"CirclePoints", "@", "4"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"poly1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"o1", "+", "#"}], ")"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"CirclePoints", "@", "6"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"poly2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"o2", "+", "#"}], ")"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"CirclePoints", "@", "4"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "List", " ", "of", " ", "all", " ", "lines", " ", "in", " ", "space"}],
        "*)"}], "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"oldO", " ", "\[NotEqual]", " ", "o"}], " ", "||", 
         RowBox[{"oldP", "\[NotEqual]", " ", "p"}]}], ",", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"listofAllLines", "=", 
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"lineList", "@", 
             RowBox[{"(", "boundpoly", ")"}]}], ",", 
            RowBox[{"lineList", "@", 
             RowBox[{"(", "poly1", ")"}]}], ",", 
            RowBox[{"lineList", "@", 
             RowBox[{"(", "poly2", ")"}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Line", " ", "Parallel", " ", "to", " ", "X", " ", "axis"}],
           "*)"}], "\[IndentingNewLine]", 
         RowBox[{"InfinteLine", "=", 
          RowBox[{"{", 
           RowBox[{"p", ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Max", "@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
                   "&"}], "/@", 
                 RowBox[{"(", 
                  RowBox[{"Join", "[", 
                   RowBox[{"boundpoly", ",", "poly1", ",", "poly2"}], "]"}], 
                  ")"}]}], ")"}]}], ",", 
              RowBox[{
              "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "}"}]}], "}"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"sortedList", "=", 
          RowBox[{"N", "@", 
           RowBox[{"Sort", "[", 
            RowBox[{
             RowBox[{"Join", "[", 
              RowBox[{
               RowBox[{"vertexList", "@", 
                RowBox[{"(", 
                 RowBox[{"Reverse", "@", "boundpoly"}], ")"}]}], ",", 
               RowBox[{"vertexList", "@", "poly1"}], ",", 
               RowBox[{"vertexList", "@", "poly2"}]}], "]"}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"getAngle", "[", 
                  RowBox[{"{", 
                   RowBox[{"p", ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], "\[NotEqual]", 
                 "  ", 
                 RowBox[{"getAngle", "[", 
                  RowBox[{"{", 
                   RowBox[{"p", ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"getAngle", "[", 
                  RowBox[{"{", 
                   RowBox[{"p", ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], "<", 
                 RowBox[{"getAngle", "[", 
                  RowBox[{"{", 
                   RowBox[{"p", ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}]}], ",", 
                RowBox[{
                 RowBox[{"Norm", "[", 
                  RowBox[{"p", "-", 
                   RowBox[{
                   "#1", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}], "<", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"p", "-", 
                   RowBox[{
                   "#2", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}]}], "]"}], " ", 
              "&"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "get", " ", "the", " ", "intersection", " ", "of", " ", "lines", 
           " ", "for", " ", "the", " ", "Infinteline"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"SegmentIntersectionQ", "[", 
               RowBox[{"{", 
                RowBox[{"InfinteLine", ",", "#"}], "}"}], "]"}], "\[Equal]", 
              "True"}], ",", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"jList", ",", "#"}], "]"}]}], "]"}], "&"}], "/@", 
          "listofAllLines"}], ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Store", " ", "the", " ", "sorted", " ", "values", " ", "in", " ", 
           "J", " ", "list"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"jList", "=", 
          RowBox[{"Sort", "[", 
           RowBox[{"jList", ",", 
            RowBox[{
             RowBox[{
              RowBox[{"EuclideanDistance", "[", 
               RowBox[{
                RowBox[{"LineIntersectionPoint", "[", 
                 RowBox[{"Chop", "@", 
                  RowBox[{"{", 
                   RowBox[{"InfinteLine", ",", "#"}], "}"}]}], "]"}], ",", 
                "p"}], "]"}], "<", 
              RowBox[{"EuclideanDistance", "[", 
               RowBox[{
                RowBox[{"LineIntersectionPoint", "[", 
                 RowBox[{"Chop", "@", 
                  RowBox[{"{", 
                   RowBox[{"InfinteLine", ",", "#"}], "}"}]}], "]"}], ",", 
                "p"}], "]"}]}], "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"oldO", "=", "o"}], ";", "\[IndentingNewLine]", 
         RowBox[{"oldP", "=", "p"}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", " ", 
            RowBox[{"Length", "@", "sortedList"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "@", 
               RowBox[{"intersectInteriorQRev2", "[", 
                RowBox[{"p", ",", 
                 RowBox[{
                 "sortedList", "\[LeftDoubleBracket]", "i", 
                  "\[RightDoubleBracket]"}]}], "]"}]}], ",", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"i", "\[Equal]", "1"}], " ", "||", 
                 RowBox[{"Not", "@", 
                  RowBox[{"pointOnSegmentQ", "[", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], ",", 
                    RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], 
                   "]"}]}]}], ",", "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Or", "@@", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", 
                    RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], ",", "#"}], "}"}], "]"}], ")"}], "&"}], "/@", 
                    "jList"}], ")"}]}], ",", 
                  RowBox[{"wi", "=", "False"}], " ", ",", 
                  RowBox[{"wi", "=", "True"}]}], "]"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{"wip", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"Or", "@@", 
                    RowBox[{"(", 
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                    "}"}], ",", "#"}], "}"}], "]"}], ")"}]}], "&"}], "/@", 
                    "jList"}], ",", 
                    RowBox[{"wi", "=", "False"}], ",", 
                    RowBox[{"wi", "=", "True"}]}], "]"}], ",", 
                  RowBox[{"wi", "=", "False"}]}], "]"}]}], "]"}], ",", 
              RowBox[{"wi", "=", "False"}]}], "]"}], ";", 
            RowBox[{"wip", "=", "wi"}], ";", 
            RowBox[{"If", "[", 
             RowBox[{"wi", ",", 
              RowBox[{
               RowBox[{"AppendTo", "[", 
                RowBox[{"visibleList", ",", 
                 RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                  RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], "]"}],
                ";", "\[IndentingNewLine]", 
               RowBox[{"AppendTo", "[", 
                RowBox[{"jList", ",", 
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], 
                  "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
               RowBox[{"jList", " ", "=", 
                RowBox[{"DeleteCases", "[", 
                 RowBox[{"jList", ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}], ",", 
                    RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                    RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}]}], 
                   "}"}]}], "]"}]}]}]}], "]"}]}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"tripoly", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], ",", 
            "p", ",", 
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
           "}"}], ")"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"lineList", "@", "visibleList"}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"Print", "@", "tripoly"}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Number", " ", "Text", " ", "to", " ", "the", " ", "Sorted", " ", 
        "Lines"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sortedText", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}], "+", 
            RowBox[{"Mean", "@", 
             RowBox[{"{", 
              RowBox[{"p", ",", 
               RowBox[{"sortedList", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], 
              "}"}]}]}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "sortedList"}], ",", "1"}], "}"}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"m", "=", 
         RowBox[{"Length", "@", "printJList"}]}], ";"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{"Boundary", " ", "Polygon"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", "White", ",", 
            RowBox[{"Polygon", "@", "boundpoly"}]}], "}"}], "}"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
          "Lines", " ", "from", " ", "point", " ", "P", " ", "and", " ", 
           "point", " ", "P"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Opacity", "[", "0.2", "]"}], ",", "Blue", ",", 
              RowBox[{
               RowBox[{
                RowBox[{"Line", "@", 
                 RowBox[{"(", 
                  RowBox[{"{", 
                   RowBox[{"p", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "}"}], ")"}]}], "&"}], "/@", 
               "sortedList"}]}], "}"}], "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", "sortedText"}], "}"}], "}"}]}], "*)"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"LightYellow", ",", 
            RowBox[{"Polygon", "@", "tripoly"}]}], "}"}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Blue", ",", 
            RowBox[{"PointSize", "\[Rule]", "Large"}], ",", 
            RowBox[{"Point", "@", "p"}]}], "}"}], "}"}], 
         "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Obstacle", " ", "Polygons"}], "*)"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
            RowBox[{"Opacity", "[", "0.1", "]"}], ",", "White", ",", 
            RowBox[{"Polygon", "@", "poly1"}]}], "}"}], "}"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
            RowBox[{"Opacity", "[", "0.1", "]"}], ",", "White", ",", 
            RowBox[{"Polygon", "@", "poly2"}]}], "}"}], "}"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{"Infinite", " ", "Line"}], "*)"}], "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Blue", ",", 
              RowBox[{"Line", "@", "InfinteLine"}]}], "}"}], "}"}], 
           "\[IndentingNewLine]", ",", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"Green", ",", 
              RowBox[{"Line", "@", "jList"}]}], "}"}], "}"}]}], "*)"}], 
         "\[IndentingNewLine]", ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"Red", ",", 
            RowBox[{"Point", "@", "visibleList"}]}], "}"}], "}"}]}], 
        "\[IndentingNewLine]", "\[IndentingNewLine]", "}"}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"o1", ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], ",", 
     RowBox[{"3", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{"3", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"ControlType", "\[Rule]", " ", "Locator"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"o2", ",", 
       RowBox[{"{", 
        RowBox[{"2", ",", "2"}], "}"}]}], "}"}], ",", 
     RowBox[{"3", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{"3", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"ControlType", "\[Rule]", " ", "Locator"}]}], "}"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "1", ",", "\"\<Slider\>\""}], "}"}], ",", "1", ",", 
       "m", ",", "1"}], "}"}]}], "*)"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"m", ",", "1"}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", " ", "None"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", 
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{"-", "2"}]}], "}"}]}], "}"}], ",", 
     RowBox[{"3", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{"3", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", 
     RowBox[{"ControlType", "\[Rule]", " ", "Locator"}], ",", 
     RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}]}], 
  "\[IndentingNewLine]", "]"}]], "Input",
 CellChangeTimes->{{3.7610632850026383`*^9, 3.7610634044432917`*^9}, {
   3.7610634393800025`*^9, 3.76106366583322*^9}, {3.761063698951275*^9, 
   3.761064014200367*^9}, {3.76106406454311*^9, 3.7610640903980417`*^9}, {
   3.761064151318804*^9, 3.7610643227700787`*^9}, {3.7610643561995735`*^9, 
   3.7610644721828504`*^9}, {3.7610645156355233`*^9, 
   3.7610645469549627`*^9}, {3.7610654017897687`*^9, 
   3.7610654404246683`*^9}, {3.7610661042570777`*^9, 
   3.7610661283642144`*^9}, {3.76106615902466*^9, 3.7610662625796537`*^9}, 
   3.761066356202894*^9, {3.7610664141790705`*^9, 3.7610664161879864`*^9}, {
   3.761066448209195*^9, 3.7610664611800375`*^9}, {3.761066608632526*^9, 
   3.761066610129567*^9}, {3.7610667663547916`*^9, 3.761067016841116*^9}, {
   3.7610670665970125`*^9, 3.7610671375792527`*^9}, {3.76106722167597*^9, 
   3.761067396307845*^9}, {3.7610674321168566`*^9, 3.76106744679383*^9}, {
   3.7610675372073355`*^9, 3.7610677631863213`*^9}, {3.7610678718503895`*^9, 
   3.7610678749426203`*^9}, {3.761067941656019*^9, 3.7610679538872633`*^9}, {
   3.7610680076367493`*^9, 3.7610680705723968`*^9}, {3.7610682208082695`*^9, 
   3.7610682334450207`*^9}, {3.7610684070249414`*^9, 
   3.7610684271108565`*^9}, {3.7610695288854094`*^9, 3.761069573160529*^9}, {
   3.761069643059186*^9, 3.761069840204541*^9}, {3.761069964249875*^9, 
   3.7610700239776583`*^9}, {3.7610701626851463`*^9, 3.761070165051691*^9}, {
   3.7610701986982927`*^9, 3.7610703116632147`*^9}, {3.7612713159758515`*^9, 
   3.7612713824898777`*^9}, {3.761271469588868*^9, 3.761271474538613*^9}, 
   3.7612715719240503`*^9, {3.76127167912918*^9, 3.7612717043756523`*^9}, {
   3.761271873437318*^9, 3.7612719321013565`*^9}, {3.7612720384627495`*^9, 
   3.7612720935713143`*^9}, {3.761272237592925*^9, 3.761272369191801*^9}, {
   3.7612724046140223`*^9, 3.761272408299162*^9}, {3.761272927692134*^9, 
   3.7612729282007437`*^9}, {3.761272969905201*^9, 3.761273051074975*^9}, {
   3.7612732117939854`*^9, 3.7612732568683944`*^9}, {3.7612737551424656`*^9, 
   3.7612737626095343`*^9}, {3.7615747207753363`*^9, 3.761574788256281*^9}, {
   3.7615749402685757`*^9, 3.7615749439218397`*^9}, {3.761576432071761*^9, 
   3.7615764457900505`*^9}, {3.7615765108230414`*^9, 
   3.7615765209998503`*^9}, {3.7615765531667986`*^9, 3.7615765550846806`*^9}, 
   3.7615781151762733`*^9, {3.76158145243258*^9, 3.7615814735925136`*^9}, {
   3.7615836110734425`*^9, 3.761583760113132*^9}, {3.761583802698967*^9, 
   3.7615839351790547`*^9}, {3.761584139444584*^9, 3.7615841719798126`*^9}, {
   3.7615842210310535`*^9, 3.761584223317712*^9}, {3.7615842658384*^9, 
   3.7615842678208838`*^9}, {3.76158434358031*^9, 3.761584728352324*^9}, {
   3.7615852703820295`*^9, 3.761585424317153*^9}, 3.7615854910318956`*^9, {
   3.7616058149661527`*^9, 3.7616058153361616`*^9}, {3.762210039433366*^9, 
   3.7622101448646517`*^9}, {3.7622102762886963`*^9, 3.76221030788791*^9}, {
   3.762210380421874*^9, 3.762210433261532*^9}, {3.762211092970248*^9, 
   3.762211440329764*^9}, {3.762211499374782*^9, 3.762211590246029*^9}, {
   3.7622117046467123`*^9, 3.7622117304267993`*^9}, {3.7622124779026546`*^9, 
   3.7622125856029615`*^9}, {3.762212620942935*^9, 3.7622127430779276`*^9}, {
   3.7622127874414597`*^9, 3.762212974887085*^9}, {3.7622133300516405`*^9, 
   3.762213414502288*^9}, {3.7622134648643513`*^9, 3.7622134932811584`*^9}, {
   3.762213526667012*^9, 3.762213558762929*^9}, {3.7622135926265354`*^9, 
   3.7622136139302692`*^9}, {3.762213655150919*^9, 3.762213761740939*^9}, {
   3.762213836930204*^9, 3.7622138465066676`*^9}, {3.762213916317742*^9, 
   3.762213951091195*^9}, {3.7623927320343447`*^9, 3.76239304478363*^9}, {
   3.762393149677205*^9, 3.7623931806144996`*^9}, {3.762393232701253*^9, 
   3.762393234105488*^9}, {3.76239331338515*^9, 3.762393317628816*^9}, {
   3.7623933562176685`*^9, 3.7623933622565036`*^9}, {3.7623933926931343`*^9, 
   3.7623934160566764`*^9}, {3.7623939136644044`*^9, 
   3.7623940201497374`*^9}, {3.762394251144202*^9, 3.7623942566883907`*^9}, {
   3.762394290660581*^9, 3.7623944682807484`*^9}, {3.7623945291819334`*^9, 
   3.762394534950496*^9}, {3.7623946350489044`*^9, 3.7623946773597927`*^9}, {
   3.762394809398458*^9, 3.762394835287246*^9}, {3.7623948741643324`*^9, 
   3.762394983777285*^9}, {3.7623950149988213`*^9, 3.762395081084118*^9}, {
   3.7623951204259925`*^9, 3.7623953284594746`*^9}, 3.762395374193233*^9, {
   3.762395498280487*^9, 3.7623955262846346`*^9}, {3.762395558434676*^9, 
   3.762395622201217*^9}, {3.762395777291175*^9, 3.7623959568262663`*^9}, {
   3.762396022102762*^9, 3.7623961191223927`*^9}, {3.762649414624845*^9, 
   3.7626494356513467`*^9}, {3.762650242499755*^9, 3.76265031563943*^9}, 
   3.762650452844496*^9, {3.762652503427812*^9, 3.7626525490861716`*^9}, {
   3.7626526493386354`*^9, 3.762652756312374*^9}, {3.7626527908524337`*^9, 
   3.7626528072076817`*^9}, {3.762652844546075*^9, 3.762652847262675*^9}, {
   3.7626529217958875`*^9, 3.7626529896814337`*^9}, {3.7626530200095477`*^9, 
   3.762653073362696*^9}, {3.762653104533358*^9, 3.762653109596302*^9}, {
   3.76265314158049*^9, 3.762653182662476*^9}, {3.7626532184967504`*^9, 
   3.7626532376760616`*^9}, {3.762653310977437*^9, 3.7626533550570507`*^9}, {
   3.7626533969074807`*^9, 3.762653558436535*^9}, {3.7626536064224405`*^9, 
   3.7626536296808896`*^9}, {3.762653706850101*^9, 3.762653714441229*^9}, {
   3.762653770446453*^9, 3.762653771680445*^9}, {3.762653827852303*^9, 
   3.762653828272382*^9}, {3.7626539580639906`*^9, 3.762654115331834*^9}, {
   3.762654371941435*^9, 3.7626544993697724`*^9}, {3.762654542845087*^9, 
   3.7626546822049456`*^9}, {3.762654900748481*^9, 3.762654925950856*^9}, {
   3.7626551537879615`*^9, 3.7626553158295794`*^9}, {3.7626554133921933`*^9, 
   3.762655416834526*^9}, {3.7626555324710903`*^9, 3.7626555387028446`*^9}, {
   3.762655587312931*^9, 3.762655614082803*^9}, {3.7626556552183027`*^9, 
   3.762655698662418*^9}, {3.7626934794717464`*^9, 3.762693481119744*^9}, {
   3.762698596224823*^9, 3.762698670708673*^9}, 3.762698731509883*^9, {
   3.762698803962064*^9, 3.7626988293306446`*^9}, {3.7626989117655735`*^9, 
   3.7626989226781473`*^9}, {3.7626989770541267`*^9, 
   3.7626989856841803`*^9}, {3.7627012765667286`*^9, 3.762701282143115*^9}, {
   3.762701342380327*^9, 3.7627013996639376`*^9}, {3.7627014335265427`*^9, 
   3.7627014787268543`*^9}, {3.762701520140205*^9, 3.7627015205464907`*^9}, 
   3.762705447697254*^9, {3.763244734230598*^9, 3.763244752346192*^9}, {
   3.7632581743553104`*^9, 3.763258194332582*^9}, 3.763258250591772*^9, {
   3.7632583209596252`*^9, 3.7632583221118402`*^9}, {3.7632583928084526`*^9, 
   3.763258432317236*^9}, {3.7632584861530666`*^9, 3.7632584941014137`*^9}, {
   3.763258529744892*^9, 3.7632585974307985`*^9}, {3.7632586299674473`*^9, 
   3.7632587176704226`*^9}, {3.763258748792323*^9, 3.7632587567034245`*^9}, 
   3.7632588440482454`*^9, {3.763258915841169*^9, 3.7632589276517076`*^9}, {
   3.7632599948956184`*^9, 3.76326003002724*^9}, {3.7632600790100517`*^9, 
   3.7632600884699802`*^9}, {3.7632601331088786`*^9, 3.763260172222765*^9}, {
   3.7632602193190007`*^9, 3.7632602947830043`*^9}, {3.7632603356109686`*^9, 
   3.763260415187608*^9}, {3.7632604643039217`*^9, 3.763260499452874*^9}, {
   3.7632605353592243`*^9, 3.763260613656707*^9}, {3.763260654079373*^9, 
   3.763260879127033*^9}, 3.763260913611108*^9, {3.7632609643826733`*^9, 
   3.7632609819202847`*^9}, {3.7632610190364723`*^9, 
   3.7632610368591347`*^9}, {3.7632610702265854`*^9, 
   3.7632611497663565`*^9}, {3.7632611969853115`*^9, 
   3.7632613455895243`*^9}, {3.7632613840294485`*^9, 
   3.7632615811200786`*^9}, {3.7632616357346354`*^9, 3.763261742912507*^9}, {
   3.7632618114223304`*^9, 3.763261926723977*^9}, {3.763262012933181*^9, 
   3.763262013992261*^9}, {3.763262044489561*^9, 3.76326204506758*^9}, {
   3.763262116152605*^9, 3.763262292757662*^9}, {3.763262325805498*^9, 
   3.7632623922926683`*^9}, {3.7632624231173573`*^9, 3.763262465462245*^9}, {
   3.7632625014202533`*^9, 3.76326251388682*^9}, {3.7632626669497223`*^9, 
   3.7632627243409295`*^9}, {3.763262815709516*^9, 3.7632629215628505`*^9}, 
   3.763262977337104*^9, {3.7632631079368973`*^9, 3.7632631081925097`*^9}, {
   3.7632632016770887`*^9, 3.7632632613605323`*^9}, {3.763263346026462*^9, 
   3.763263397850175*^9}, {3.7632634468033695`*^9, 3.7632634491557074`*^9}, {
   3.7632634862092376`*^9, 3.7632635209252844`*^9}, {3.7632635854629097`*^9, 
   3.763263587888767*^9}, {3.763264055623017*^9, 3.763264057520314*^9}, {
   3.7632640892033854`*^9, 3.7632641398688984`*^9}, 3.7632641853353186`*^9, {
   3.763264225563844*^9, 3.7632644841879444`*^9}, {3.76326458261981*^9, 
   3.763264847150422*^9}, 3.763264946337144*^9, {3.7632650524734516`*^9, 
   3.7632651688292885`*^9}, {3.763265206650627*^9, 3.7632652070605755`*^9}, {
   3.7632652370950994`*^9, 3.7632652965092573`*^9}, {3.7632653721819253`*^9, 
   3.763265393497857*^9}, {3.763265495012374*^9, 3.763265539987446*^9}, {
   3.763265683138357*^9, 3.7632658014509015`*^9}, {3.7632658950236187`*^9, 
   3.763265897346979*^9}, {3.763265936994251*^9, 3.7632660256691604`*^9}, 
   3.7632665234375668`*^9, {3.763266568841438*^9, 3.76326667276729*^9}, {
   3.763266707888018*^9, 3.763266714240859*^9}, {3.7632667631538506`*^9, 
   3.763266784832614*^9}, {3.763266820451153*^9, 3.7632668399334917`*^9}, {
   3.7633114787755327`*^9, 3.763311491857848*^9}, {3.7633115533073263`*^9, 
   3.763311642065763*^9}, {3.763311688026507*^9, 3.7633118792976933`*^9}, {
   3.7633119574651046`*^9, 3.763311961708699*^9}, {3.763312002807035*^9, 
   3.763312008146197*^9}, {3.763312107066289*^9, 3.763312108665326*^9}, {
   3.7633121543426247`*^9, 3.7633121774997025`*^9}, {3.7633123132208085`*^9, 
   3.7633123796147156`*^9}, {3.763312542111749*^9, 3.7633126151498327`*^9}, {
   3.7633126827522697`*^9, 3.7633127186507688`*^9}, {3.763312760542296*^9, 
   3.76331278810371*^9}, 3.763312822815153*^9, {3.7633128684220552`*^9, 
   3.76331294079317*^9}, {3.763312972751542*^9, 3.763313196261938*^9}, {
   3.763318308500495*^9, 3.7633184172790155`*^9}, {3.763318454727439*^9, 
   3.7633184795690575`*^9}, {3.7633185291191635`*^9, 
   3.7633185598154173`*^9}, {3.763318595075079*^9, 3.763318688553288*^9}, {
   3.7633187443306446`*^9, 3.763318762972345*^9}, 3.763323003619627*^9, {
   3.763323078580861*^9, 3.7633232959898324`*^9}, {3.763323334593171*^9, 
   3.7633234241179824`*^9}, {3.763323470124205*^9, 3.7633234717430296`*^9}, {
   3.7633235062468376`*^9, 3.7633235721163845`*^9}, 3.7633236059009295`*^9, {
   3.7633237678272195`*^9, 3.7633237692007966`*^9}, 3.7633238055696793`*^9, {
   3.763323848052415*^9, 3.763323987089448*^9}, {3.763324078917862*^9, 
   3.7633241057049427`*^9}, {3.76332414115007*^9, 3.7633241788791995`*^9}, 
   3.76332438567412*^9, {3.763324427867857*^9, 3.763324439990131*^9}, {
   3.7633244715810604`*^9, 3.763324569336935*^9}, {3.7633246063426943`*^9, 
   3.7633246114721746`*^9}, {3.7633246590215616`*^9, 
   3.7633247768126335`*^9}, {3.763324809827171*^9, 3.7633248923122826`*^9}, {
   3.7633249702053146`*^9, 3.7633250150719166`*^9}, {3.763325070729065*^9, 
   3.7633251469041595`*^9}, 3.763325358952749*^9, {3.76332538942076*^9, 
   3.763325551649897*^9}, {3.763325595361883*^9, 3.763325759587208*^9}, {
   3.7633258225952983`*^9, 3.763325956555542*^9}, {3.763326116940193*^9, 
   3.7633261234267864`*^9}, {3.763326219023765*^9, 3.763326223362852*^9}, {
   3.7633262656936607`*^9, 3.763326295779066*^9}, {3.76356178798265*^9, 
   3.76356192567375*^9}, {3.76356196977443*^9, 3.763562015599578*^9}, {
   3.763562061514203*^9, 3.763562087748957*^9}, {3.763562125070998*^9, 
   3.763562165334386*^9}, {3.7635622046127076`*^9, 3.76356227990858*^9}, {
   3.76356232072657*^9, 3.763562328092678*^9}, {3.763562471972331*^9, 
   3.7635624788967447`*^9}, {3.7635627092959104`*^9, 3.763562717782089*^9}, {
   3.7635627563905053`*^9, 3.7635627598018208`*^9}, {3.7635627956229353`*^9, 
   3.763562832617628*^9}, {3.7635689572125125`*^9, 3.763568961665244*^9}, {
   3.7635689921040354`*^9, 3.7635690213482704`*^9}, {3.76356931196206*^9, 
   3.7635693262550445`*^9}, {3.763569517089736*^9, 3.7635696418405805`*^9}, {
   3.7635697283167877`*^9, 3.7635697461908875`*^9}, {3.7635697862514286`*^9, 
   3.7635697938964605`*^9}, {3.763569851867762*^9, 3.763569981459463*^9}, {
   3.763570025575801*^9, 3.7635700438045287`*^9}, {3.7635702244181213`*^9, 
   3.7635702268027525`*^9}, {3.7635703342769337`*^9, 
   3.7635704352261343`*^9}, {3.763570524034799*^9, 3.7635705248641663`*^9}, {
   3.763570558243432*^9, 3.763570566409751*^9}, {3.7635705987016354`*^9, 
   3.763570676228245*^9}, {3.7635707502160606`*^9, 3.7635707527385836`*^9}, {
   3.7635707854880705`*^9, 3.7635707876822867`*^9}, {3.7635708200262575`*^9, 
   3.7635708253119516`*^9}, {3.763575689508105*^9, 3.7635757167921195`*^9}, {
   3.7635758690448904`*^9, 3.763575914820011*^9}, 3.7635759668813267`*^9, {
   3.763576022585419*^9, 3.7635760789005113`*^9}, {3.7635762460187173`*^9, 
   3.763576251230462*^9}, {3.7635763314304466`*^9, 3.763576343876134*^9}, {
   3.7635764654239426`*^9, 3.7635765176158953`*^9}, {3.763576659250139*^9, 
   3.7635767077042446`*^9}, {3.763576792357956*^9, 3.7635768529242115`*^9}, {
   3.763576907452589*^9, 3.7635769131453447`*^9}, {3.763576956304472*^9, 
   3.7635769719203253`*^9}, {3.763577152960684*^9, 3.7635771797732344`*^9}, {
   3.763577666843608*^9, 3.7635777141658936`*^9}, {3.763577895684903*^9, 
   3.7635780454688826`*^9}, 3.763578124420875*^9, {3.7635789162621365`*^9, 
   3.7635789859002275`*^9}, {3.7635790432191277`*^9, 3.763579057476848*^9}, {
   3.763579275606776*^9, 3.7635793032563353`*^9}, {3.7635795864288054`*^9, 
   3.763579746122672*^9}, {3.7635797793394794`*^9, 3.763579800629965*^9}, {
   3.763579882238236*^9, 3.763579889743476*^9}, 3.7635800591636*^9, {
   3.7635801719099536`*^9, 3.763580188601144*^9}, {3.76358029025426*^9, 
   3.7635803296017914`*^9}, {3.7635803864141927`*^9, 3.763580403112635*^9}, {
   3.7635804426088185`*^9, 3.7635804894347944`*^9}, {3.7635805689492745`*^9, 
   3.763580577055135*^9}, 3.763580617726554*^9, {3.7635807434816837`*^9, 
   3.7635807439254694`*^9}, {3.7635807968846054`*^9, 3.763580800770816*^9}, {
   3.7635809066287236`*^9, 3.7635809330013776`*^9}, {3.7635809633420787`*^9, 
   3.763580992685117*^9}, {3.7635810389253125`*^9, 3.7635810397775126`*^9}, {
   3.76358109457882*^9, 3.7635813086025677`*^9}, {3.7635813649708486`*^9, 
   3.7635813886749797`*^9}, {3.763581420023385*^9, 3.7635815150102177`*^9}, {
   3.7635815936840506`*^9, 3.7635815985029225`*^9}, {3.7635817967115483`*^9, 
   3.763581892348754*^9}, {3.763581927897236*^9, 3.7635819284596767`*^9}, {
   3.7635819655951385`*^9, 3.76358205835909*^9}, {3.763582091802004*^9, 
   3.763582155617432*^9}, {3.763582258514086*^9, 3.763582353723151*^9}, {
   3.7635823853482523`*^9, 3.763582389587899*^9}, {3.763582771305092*^9, 
   3.7635827722077227`*^9}, 3.7635829063510995`*^9, {3.7637325430631227`*^9, 
   3.7637325686607304`*^9}, {3.7637327680247555`*^9, 3.763732782321548*^9}},
 CellLabel->
  "In[226]:=",ExpressionUUID->"69c02ee2-f928-4595-b37a-29c71f52dfde"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`m$$ = 
    1, $CellContext`o1$$ = {-0.6349999999999998, -2.24}, $CellContext`o2$$ = \
{-0.9300000000000002, -0.06000000000000005}, $CellContext`p$$ = {2.13, 
    0.9500000000000002}, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`o1$$], {0, 0}}, {-3, -3}, {3, 3}}, {{
       Hold[$CellContext`o2$$], {2, 2}}, {-3, -3}, {3, 3}}, {{
       Hold[$CellContext`m$$], 1}}, {{
       Hold[$CellContext`p$$], {1, -2}}, {-3, -3}, {3, 3}}}, 
    Typeset`size$$ = {576., {283., 292.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`o1$570062$$ = {0, 0}, $CellContext`o2$570063$$ = {0, 
    0}, $CellContext`p$570064$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`m$$ = 
        1, $CellContext`o1$$ = {0, 0}, $CellContext`o2$$ = {2, 
         2}, $CellContext`p$$ = {1, -2}}, "ControllerVariables" :> {
        Hold[$CellContext`o1$$, $CellContext`o1$570062$$, {0, 0}], 
        Hold[$CellContext`o2$$, $CellContext`o2$570063$$, {0, 0}], 
        Hold[$CellContext`p$$, $CellContext`p$570064$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`o$, $CellContext`boundpoly$, $CellContext`poly1$, \
$CellContext`poly2$, $CellContext`listofAllLines$, $CellContext`sortedList$, \
$CellContext`sortedText$, $CellContext`jList$ = {}, \
$CellContext`InfinteLine$, $CellContext`i$, $CellContext`visibleList$ = {}, \
$CellContext`wi$, $CellContext`wip$, $CellContext`oldO$ = {}, \
$CellContext`oldP$ = {}}, $CellContext`o$ = {$CellContext`o1$$, \
$CellContext`o2$$}; $CellContext`boundpoly$ = 
         5 CirclePoints[4]; $CellContext`poly1$ = Map[$CellContext`o1$$ + #& , 
           CirclePoints[6]]; $CellContext`poly2$ = 
         Map[$CellContext`o2$$ + #& , 
           CirclePoints[4]]; If[
          
          Or[$CellContext`oldO$ != $CellContext`o$, $CellContext`oldP$ != \
$CellContext`p$$], $CellContext`listofAllLines$ = Join[
             $CellContext`lineList[$CellContext`boundpoly$], 
             $CellContext`lineList[$CellContext`poly1$], 
             $CellContext`lineList[$CellContext`poly2$]]; \
$CellContext`InfinteLine$ = {$CellContext`p$$, {
              Max[
               Map[Part[#, 1]& , 
                
                Join[$CellContext`boundpoly$, $CellContext`poly1$, \
$CellContext`poly2$]]], 
              Part[$CellContext`p$$, 2]}}; $CellContext`sortedList$ = N[
             Sort[
              Join[
               $CellContext`vertexList[
                Reverse[$CellContext`boundpoly$]], 
               $CellContext`vertexList[$CellContext`poly1$], 
               $CellContext`vertexList[$CellContext`poly2$]], 
              If[$CellContext`getAngle[{$CellContext`p$$, 
                  Part[#, 2]}] != $CellContext`getAngle[{$CellContext`p$$, 
                  Part[#2, 2]}], $CellContext`getAngle[{$CellContext`p$$, 
                  Part[#, 2]}] < $CellContext`getAngle[{$CellContext`p$$, 
                  Part[#2, 2]}], Norm[$CellContext`p$$ - Part[#, 2]] < 
               Norm[$CellContext`p$$ - Part[#2, 2]]]& ]]; 
          Map[If[$CellContext`SegmentIntersectionQ[{$CellContext`InfinteLine$,\
 #}] == True, 
             
             AppendTo[$CellContext`jList$, #]]& , \
$CellContext`listofAllLines$]; $CellContext`jList$ = 
           Sort[$CellContext`jList$, EuclideanDistance[
               $CellContext`LineIntersectionPoint[
                Chop[{$CellContext`InfinteLine$, #}]], $CellContext`p$$] < 
             EuclideanDistance[
               $CellContext`LineIntersectionPoint[
                
                Chop[{$CellContext`InfinteLine$, #}]], $CellContext`p$$]& ]; \
$CellContext`oldO$ = $CellContext`o$; $CellContext`oldP$ = $CellContext`p$$; 
          For[$CellContext`i$ = 1, $CellContext`i$ <= 
            Length[$CellContext`sortedList$], 
            Increment[$CellContext`i$], If[
              Not[
               $CellContext`intersectInteriorQRev2[$CellContext`p$$, 
                Part[$CellContext`sortedList$, $CellContext`i$]]], 
              If[
               Or[$CellContext`i$ == 1, 
                Not[
                 $CellContext`pointOnSegmentQ[{$CellContext`p$$, 
                   Part[$CellContext`sortedList$, $CellContext`i$, 2]}, 
                  Part[$CellContext`sortedList$, $CellContext`i$, 1]]]], 
               If[
                Apply[Or, 
                 Map[$CellContext`SegmentIntersectionQ[{{$CellContext`p$$, 
                    
                    Part[$CellContext`sortedList$, $CellContext`i$, 
                    2]}, #}]& , $CellContext`jList$]], $CellContext`wi$ = 
                False, $CellContext`wi$ = True], 
               If[$CellContext`wip$, 
                If[
                 Map[Apply[Or, 
                   $CellContext`SegmentIntersectionQ[{{
                    Part[$CellContext`sortedList$, $CellContext`i$, 1], 
                    
                    Part[$CellContext`sortedList$, $CellContext`i$, 
                    2]}, #}]]& , $CellContext`jList$], $CellContext`wi$ = 
                 False, $CellContext`wi$ = True], $CellContext`wi$ = 
                False]], $CellContext`wi$ = 
              False]; $CellContext`wip$ = $CellContext`wi$; 
            If[$CellContext`wi$, AppendTo[$CellContext`visibleList$, 
                Part[$CellContext`sortedList$, $CellContext`i$, 2]]; 
              AppendTo[$CellContext`jList$, {
                 Part[$CellContext`sortedList$, $CellContext`i$, 1], 
                 
                 Part[$CellContext`sortedList$, $CellContext`i$, 
                  2]}]; $CellContext`jList$ = 
               DeleteCases[$CellContext`jList$, {
                  Part[$CellContext`sortedList$, $CellContext`i$, 2], 
                  Part[$CellContext`sortedList$, $CellContext`i$, 3]}]]]; 
          Null]; $CellContext`tripoly = Map[{
            Part[#, 1], $CellContext`p$$, 
            Part[#, 2]}& , 
           $CellContext`lineList[$CellContext`visibleList$]]; \
$CellContext`sortedText$ = Table[
           Text[$CellContext`i$, {0, 0} + Mean[{$CellContext`p$$, 
               
               Part[$CellContext`sortedList$, $CellContext`i$, 
                2]}]], {$CellContext`i$, 1, 
            Length[$CellContext`sortedList$], 1}]; Graphics[{{{
             EdgeForm[Thin], White, 
             Polygon[$CellContext`boundpoly$]}}, {{LightYellow, 
             Polygon[$CellContext`tripoly]}}, {{Blue, PointSize -> Large, 
             Point[$CellContext`p$$]}}, {{
             EdgeForm[Thin], 
             Opacity[0.1], White, 
             Polygon[$CellContext`poly1$]}}, {{
             EdgeForm[Thin], 
             Opacity[0.1], White, 
             Polygon[$CellContext`poly2$]}}, {{Red, 
             Point[$CellContext`visibleList$]}}}]], 
      "Specifications" :> {{{$CellContext`o1$$, {0, 0}}, {-3, -3}, {3, 3}, 
         ControlType -> Locator}, {{$CellContext`o2$$, {2, 2}}, {-3, -3}, {3, 
         3}, ControlType -> Locator}, {{$CellContext`m$$, 1}, ControlType -> 
         None}, {{$CellContext`p$$, {1, -2}}, {-3, -3}, {3, 3}, ControlType -> 
         Locator, Appearance -> None}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{660., {334., 344.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.763323560330818*^9, 3.7633235757662334`*^9}, 
   3.763323607104048*^9, 3.7633238737857122`*^9, 3.7633239881842575`*^9, {
   3.763324083056288*^9, 3.763324106247999*^9}, {3.763324176378866*^9, 
   3.7633241794287014`*^9}, 3.7633245708235784`*^9, {3.763324768398351*^9, 
   3.763324778481129*^9}, {3.763324832068877*^9, 3.763324893292079*^9}, {
   3.7633250015032415`*^9, 3.7633250158665657`*^9}, {3.763325079002606*^9, 
   3.763325147928157*^9}, {3.763325338612707*^9, 3.7633253594167185`*^9}, {
   3.7633254138567715`*^9, 3.7633254182927446`*^9}, {3.763325466474918*^9, 
   3.7633254793813343`*^9}, {3.763325513279812*^9, 3.763325518145424*^9}, 
   3.7633255529630346`*^9, {3.763325606737672*^9, 3.76332562572264*^9}, {
   3.763325748641018*^9, 3.763325760896553*^9}, 3.7633258407478547`*^9, {
   3.7633259392556334`*^9, 3.763325958372364*^9}, 3.7633261244322243`*^9, 
   3.763326297311722*^9, {3.763561887246143*^9, 3.763561932225211*^9}, {
   3.7635619886713514`*^9, 3.763562017153596*^9}, {3.7635620685911827`*^9, 
   3.7635620900169263`*^9}, 3.763562262512334*^9, 3.763562305579076*^9, 
   3.7635690354334316`*^9, 3.763575718236121*^9, 3.7635759198346963`*^9, 
   3.7635759675885715`*^9, 3.7635760805304165`*^9, 3.7635762530122533`*^9, 
   3.76357634569936*^9, 3.763576436540934*^9, 3.7635764765868745`*^9, 
   3.763576718075438*^9, 3.7635767698103294`*^9, 3.7635768126912003`*^9, 
   3.763576854736786*^9, 3.76357691416317*^9, {3.7635769738576174`*^9, 
   3.7635769910893936`*^9}, {3.7635771597315884`*^9, 3.7635771838505297`*^9}, 
   3.7635776796693363`*^9, 3.763577723764614*^9, 3.76357776827884*^9, 
   3.763577875521739*^9, 3.7635780471760764`*^9, 3.76357894935911*^9, 
   3.763578987419936*^9, 3.763579047418207*^9, 3.7635795075968447`*^9, {
   3.763579753543925*^9, 3.763579801989495*^9}, 3.7635798914858723`*^9, 
   3.763580060245056*^9, 3.7635801896971674`*^9, 3.763580334238778*^9, {
   3.763580406341814*^9, 3.76358049007634*^9}, 3.763580578717171*^9, 
   3.763580619379899*^9, {3.763580673156073*^9, 3.7635806906091166`*^9}, 
   3.7635807278642764`*^9, 3.763580774713586*^9, 3.763580862983038*^9, 
   3.76358093573125*^9, {3.763580971632138*^9, 3.763580993394947*^9}, 
   3.763581041106678*^9, 3.763581434434167*^9, 3.7635814718349037`*^9, 
   3.7635815165414534`*^9, {3.7635816002052364`*^9, 3.7635816230130243`*^9}, 
   3.7635817176777763`*^9, {3.7635818562920685`*^9, 3.7635819704902143`*^9}, 
   3.7635820006746035`*^9, {3.763582040695054*^9, 3.7635821566551065`*^9}, 
   3.7635822677530355`*^9, 3.7635822995513005`*^9, {3.7635823420119905`*^9, 
   3.7635823543950667`*^9}, 3.7635823905886173`*^9, 3.7635827358598447`*^9, 
   3.763582773354608*^9, 3.7635829078141546`*^9, 3.7635829450586495`*^9, 
   3.7637327834903803`*^9},
 CellLabel->
  "Out[226]=",ExpressionUUID->"4d52141b-df4d-46cc-bb99-68110f0b0537"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"listA", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"listB", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"a", ",", "c", ",", "b"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "@", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"listA", ",", "#"}], "}"}], "&"}], "/@", "listB"}], 
   ")"}]}]}], "Input",
 CellChangeTimes->{{3.7626516332775917`*^9, 3.7626517069682674`*^9}, {
  3.762651746333622*^9, 3.762651792927943*^9}, {3.762651826377756*^9, 
  3.7626518276607246`*^9}, {3.7626518744338007`*^9, 3.762651895669461*^9}, {
  3.762651931070175*^9, 3.762651981195607*^9}, {3.762652025166768*^9, 
  3.76265202556579*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"59fda00d-8a5b-4d56-937a-645505f11bc5"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.762652053151943*^9, 
  3.76265205630241*^9}},ExpressionUUID->"0671e3b7-2142-464f-b025-\
ad04cee3d648"],

Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.7626538976792264`*^9, 3.7626538977200375`*^9}},
 CellLabel->
  "In[852]:=",ExpressionUUID->"51d19c7b-bfe2-4f3b-9bf7-c3ffe48323e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"poly1", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "+", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}]}], ")"}], "&"}], "/@", 
      RowBox[{"CirclePoints", "[", "4", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poly2", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "+", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}]}], ")"}], "&"}], "/@", 
      RowBox[{"CirclePoints", "[", "3", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"poly3", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"#", "+", 
         RowBox[{
         "poly1", "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}]}], 
        ")"}], "&"}], "/@", 
      RowBox[{"CirclePoints", "[", "4", "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"p", "=", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"1", "+", 
        FractionBox["1", 
         SqrtBox["2"]], "-", 
        SqrtBox["2"]}], ",", 
       RowBox[{"2", "-", 
        FractionBox["1", 
         SqrtBox["2"]], "-", 
        SqrtBox["2"]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"j", "=", 
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3", ",", 
          RowBox[{"-", "4"}]}], "}"}]}], "}"}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"i", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wi", "=", 
     RowBox[{
     "poly1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wi1", "=", 
     RowBox[{
     "poly3", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ";"}],
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Count", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"SegmentIntersectionQ", "[", 
             RowBox[{"N", "@", 
              RowBox[{"{", 
               RowBox[{"#", ",", 
                RowBox[{"{", 
                 RowBox[{"p", ",", "wi"}], "}"}]}], "}"}]}], "]"}], "&"}], "/@", 
           RowBox[{"(", 
            RowBox[{"lineList", "@", "poly1"}], ")"}]}], ",", "True"}], "]"}],
         "\[NotEqual]", "2"}], ",", 
       RowBox[{"Print", "@", "False"}], ",", 
       RowBox[{"Print", "@", "True"}]}], "]"}], ";"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{"pointOnSegmentQ", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"p", ",", "wi"}], "}"}], ",", "wi1"}], "]"}], 
   "\[IndentingNewLine]", 
   RowBox[{"Graphics", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"Gray", ",", 
        RowBox[{"Polygon", "@", "poly1"}], ",", 
        RowBox[{"Polygon", "@", "poly2"}], ",", 
        RowBox[{"Polygon", "@", "poly3"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Line", "@", 
         RowBox[{"{", 
          RowBox[{"p", ",", "wi"}], "}"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Point", "@", 
           RowBox[{"{", 
            RowBox[{"p", ",", "wi", ",", "wi1"}], "}"}]}]}], "}"}]}], "}"}]}],
      "}"}], "]"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBWIQ7XfTc90RjjeOX6zDr4DoqVVnboDoxo/ed0H0zmaW
JyA6wtL3O4i+9+fgbxB9QiP7D4i2O76e+SiQ/mbGIwSiwx7vlwLRl6NaDEF0
B7f/GhAd89J2J4i+JePCcwxIX33nLQaiJ62+rgaitzazaIHo7ZwNeiBaIuQ4
mF714KEpiN7gPt0WRP9Sfu4EolXkXMJBtIjilFgQzfVONgtEv7kWlweie+6G
F4HoNev4ykH0rDMfKkB0UdreOhDddutOPYhO+PGxFUQvYFNoA9EH4pf2gOhL
3wUngeiMr9nTQPTJ/stLQLTGVY0NIPr1/t1gWkfAbvsdTmC4dUTvAdEAPzys
Cw==
  "],
 CellLabel->
  "In[1431]:=",ExpressionUUID->"eae08493-87b5-45ff-9774-2170586ac9d5"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.7632608202316465`*^9, 3.763266976339847*^9, {3.763267031296542*^9, 
   3.7632670438249474`*^9}},
 CellLabel->
  "Out[1439]=",ExpressionUUID->"226a0c76-b21a-4245-be00-75b66e3496cd"],

Cell[BoxData[
 GraphicsBox[
  {EdgeForm[Thickness[Tiny]], 
   {GrayLevel[0.5], 
    PolygonBox[
     NCache[{{1 + 2^Rational[-1, 2], 2 - 2^Rational[-1, 2]}, {
       1 + 2^Rational[-1, 2], 2 + 2^Rational[-1, 2]}, {
       1 - 2^Rational[-1, 2], 2 + 2^Rational[-1, 2]}, {
       1 - 2^Rational[-1, 2], 2 - 2^Rational[-1, 2]}}, {{1.7071067811865475`, 
      1.2928932188134525`}, {1.7071067811865475`, 2.7071067811865475`}, {
      0.29289321881345254`, 2.7071067811865475`}, {0.29289321881345254`, 
      1.2928932188134525`}}]], 
    PolygonBox[
     NCache[{{-1 + Rational[1, 2] 3^Rational[1, 2], Rational[-1, 2]}, {-1, 
       1}, {-1 + Rational[-1, 2] 3^Rational[1, 2], 
        Rational[-1, 2]}}, {{-0.1339745962155614, -0.5}, {-1, 
       1}, {-1.8660254037844386`, -0.5}}]], 
    PolygonBox[
     NCache[{{1, 2 - 2^Rational[1, 2]}, {1, 2}, {1 - 2^Rational[1, 2], 2}, {
       1 - 2^Rational[1, 2], 2 - 2^Rational[1, 2]}}, {{
       1, 0.5857864376269049}, {1, 
       2}, {-0.41421356237309515`, 2}, {-0.41421356237309515`, 
       0.5857864376269049}}]]}, {
    LineBox[NCache[{{
       1 + 2^Rational[-1, 2] - 2^Rational[1, 2], 2 - 2^Rational[-1, 2] - 2^
        Rational[1, 2]}, {1 + 2^Rational[-1, 2], 2 - 2^Rational[-1, 2]}}, {{
      0.2928932188134523, -0.12132034355964261`}, {1.7071067811865475`, 
      1.2928932188134525`}}]], 
    {RGBColor[1, 0, 0], 
     PointBox[NCache[{{
        1 + 2^Rational[-1, 2] - 2^Rational[1, 2], 2 - 2^Rational[-1, 2] - 2^
         Rational[1, 2]}, {1 + 2^Rational[-1, 2], 2 - 2^Rational[-1, 2]}, {
        1, 2 - 2^Rational[1, 2]}}, {{
        0.2928932188134523, -0.12132034355964261`}, {1.7071067811865475`, 
        1.2928932188134525`}, {1, 0.5857864376269049}}]]}}}]], "Output",
 CellChangeTimes->{
  3.7632608202316465`*^9, 3.763266976339847*^9, {3.763267031296542*^9, 
   3.763267043836979*^9}},
 CellLabel->
  "Out[1440]=",ExpressionUUID->"43f29c46-d29c-440a-9569-56ec37034eae"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointOnSegmentQ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x3_", ",", "y3_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ABv", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x2", "-", "x1"}], ",", 
         RowBox[{"y2", "-", "y1"}], ",", "0"}], "}"}]}], ",", 
      RowBox[{"ACv", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x3", "-", "x1"}], ",", 
         RowBox[{"y3", "-", "y1"}], ",", "0"}], "}"}]}], ",", "Kac", ",", 
      "Kab"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"#", "\[Equal]", "0"}], ")"}], "&"}], "/@", 
         RowBox[{"Cross", "[", 
          RowBox[{"ABv", ",", "ACv"}], "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Kac", "=", 
        RowBox[{"ABv", ".", "ACv"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Kab", "=", 
        RowBox[{"ABv", ".", "ABv"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Kac", "<", "0"}], ",", "False", ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Kac", ">", "Kab"}], ",", "False", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"0", "<", "Kac", "<", "Kab"}], ",", "True", ",", 
             "False"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ",",
       "False"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7626994408605223`*^9, 3.7626994957070084`*^9}, {
   3.7626995310477943`*^9, 3.762699587109696*^9}, {3.7626997083021026`*^9, 
   3.762699712423989*^9}, {3.7626997510556707`*^9, 3.7626997554851513`*^9}, {
   3.7626997952220106`*^9, 3.7626998738837285`*^9}, 3.762699908937931*^9, {
   3.7626999424881754`*^9, 3.762700278668273*^9}, {3.7627003185755424`*^9, 
   3.762700395534641*^9}, {3.7627004795581913`*^9, 3.7627007245802183`*^9}, {
   3.762700775106859*^9, 3.762700996176547*^9}, {3.762701026237877*^9, 
   3.7627011139799204`*^9}, {3.762701163207965*^9, 3.762701222995221*^9}, 
   3.7627012553188334`*^9, {3.7627013084762263`*^9, 3.7627013109520063`*^9}},
 CellLabel->
  "In[216]:=",ExpressionUUID->"6ef47da8-ae4b-4d58-9064-fd495e178f5c"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"l", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"m", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"n", "=", 
   RowBox[{"{", 
    RowBox[{"2", ",", "2"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"pointOnSegmentQ", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"l", ",", "n"}], "}"}], ",", "m"}], "]"}]}], "Input",
 CellChangeTimes->{{3.762699602045926*^9, 3.762699633708133*^9}, {
  3.7626997372896004`*^9, 3.7626997462016068`*^9}, {3.7626999376062827`*^9, 
  3.7626999394658136`*^9}, {3.7627000423139977`*^9, 3.762700042579545*^9}, {
  3.7627001230764*^9, 3.7627001232539196`*^9}, {3.7627012452080326`*^9, 
  3.762701248043223*^9}, {3.7627013174144244`*^9, 3.762701318968191*^9}},
 CellLabel->
  "In[1407]:=",ExpressionUUID->"70203311-7fae-4229-9708-6e1afe8c91ca"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.763266972678363*^9},
 CellLabel->
  "Out[1410]=",ExpressionUUID->"95f333c3-cc04-46ef-9eb5-2e2f6d3b9c3d"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"m", ",", "n", ",", "l"}], "}"}], "\[Cross]", 
  RowBox[{"{", 
   RowBox[{"x", ",", "y", ",", "z"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.7626997012976217`*^9, 3.7626997315489893`*^9}},
 CellLabel->
  "In[730]:=",ExpressionUUID->"fe99acbd-eefa-4ac8-9966-5acad84ed1d4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertexList", "[", "list_", "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"list", ",", 
      RowBox[{"list", "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], "]"}], ",", "3",
     ",", "1"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7632217125289803`*^9, 3.76322172258762*^9}, {
   3.7632255886478095`*^9, 3.7632255905058174`*^9}, {3.7632256227611103`*^9, 
   3.763225629488167*^9}, 3.7632256596711035`*^9, {3.7632257080789433`*^9, 
   3.76322578038266*^9}, {3.7632272291279907`*^9, 3.763227236570083*^9}},
 CellLabel->
  "In[622]:=",ExpressionUUID->"701e3bd5-2bc6-428a-8e55-ac48c74b3c2e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Line", " ", "pwi", " ", "intersects", " ", "interior", " ", "of", " ", 
    "the", " ", "obstacle", " ", "of", " ", "the", " ", "which", " ", "wi", 
    " ", "is", " ", "the", " ", 
    RowBox[{"vertex", "."}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Manipulate", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"po1", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}], "+", "#"}], ")"}], "&"}], "/@", 
       RowBox[{"CirclePoints", "[", "4", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"po2", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "2"}]}], "}"}], "+", "#"}], ")"}], "&"}], "/@", 
       RowBox[{"CirclePoints", "[", "5", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"po3", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"2", ",", "1"}], "}"}], "+", "#"}], ")"}], "&"}], "/@", 
       RowBox[{"CirclePoints", "[", "3", "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"po4", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "0.5"}], ",", "0.5"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"SortedList", "=", 
      RowBox[{"N", "@", 
       RowBox[{"Sort", "[", 
        RowBox[{
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"vertexList", "@", "po1"}], ",", 
           RowBox[{"vertexList", "@", "po2"}], ",", 
           RowBox[{"vertexList", "@", "po3"}], ",", 
           RowBox[{"vertexList", "@", "po4"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"getAngle", "[", 
            RowBox[{"{", 
             RowBox[{"p", ",", 
              RowBox[{
              "#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "}"}], "]"}], "<", 
           RowBox[{"getAngle", "[", 
            RowBox[{"{", 
             RowBox[{"p", ",", 
              RowBox[{
              "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             "}"}], "]"}]}], " ", "&"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Q", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"intersectInteriorQRev2", "[", 
         RowBox[{"p", ",", "#"}], "]"}], "&"}], "/@", "SortedList"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Graphics", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", "White", ",", 
          RowBox[{"Polygon", "@", "po1"}], ",", 
          RowBox[{"Polygon", "@", "po2"}], ",", 
          RowBox[{"Polygon", "@", "po3"}], ",", 
          RowBox[{"Polygon", "@", "po4"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Red", ",", 
          RowBox[{"Point", "@", "p"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Blue", ",", 
          RowBox[{"Line", "@", 
           RowBox[{"{", 
            RowBox[{"p", ",", 
             RowBox[{
              RowBox[{
              "SortedList", "\[LeftDoubleBracket]", "s", 
               "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
              "\[RightDoubleBracket]"}]}], "}"}]}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{
           "Q", "\[LeftDoubleBracket]", "s", "\[RightDoubleBracket]"}], ",", 
           RowBox[{"Mean", "@", 
            RowBox[{"{", 
             RowBox[{"p", ",", 
              RowBox[{
               RowBox[{
               "SortedList", "\[LeftDoubleBracket]", "s", 
                "\[RightDoubleBracket]"}], "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], "}"}]}]}], "]"}], "}"}]}], "}"}], 
      "]"}]}], "\[IndentingNewLine]", ",", 
    RowBox[{"Control", "@", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"s", ",", "1", ",", "\"\<Move\>\""}], "}"}], ",", "1", ",", 
       RowBox[{"Length", "@", "SortedList"}], ",", "1", ",", 
       RowBox[{"Appearance", "\[Rule]", "\"\<Open\>\""}]}], "}"}]}], 
    "\[IndentingNewLine]", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"p", ",", 
        RowBox[{"{", 
         RowBox[{"2", ",", "0"}], "}"}]}], "}"}], ",", 
      RowBox[{"ControlType", "\[Rule]", "Locator"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.7632197899470453`*^9, 3.763220203417839*^9}, {
   3.7632202357260447`*^9, 3.7632202687274537`*^9}, {3.763220300066702*^9, 
   3.7632205036615343`*^9}, {3.763220610627878*^9, 3.7632206142180643`*^9}, {
   3.763220675060588*^9, 3.763220692974691*^9}, {3.7632207907458096`*^9, 
   3.763220795625111*^9}, {3.763220862127939*^9, 3.763220998716928*^9}, {
   3.763221048355981*^9, 3.7632210881759744`*^9}, {3.7632212501762753`*^9, 
   3.763221280458618*^9}, {3.7632213112151194`*^9, 3.7632214070977297`*^9}, {
   3.7632217284749794`*^9, 3.7632217736560497`*^9}, 3.76322218628858*^9, {
   3.7632222164032087`*^9, 3.763222218661491*^9}, {3.763223355962282*^9, 
   3.7632233563133717`*^9}, {3.763223720613963*^9, 3.763223813418893*^9}, {
   3.763223870644079*^9, 3.7632238707240496`*^9}, {3.763224158111418*^9, 
   3.763224187830103*^9}, {3.763224347774019*^9, 3.7632243998461475`*^9}, {
   3.7632244921429906`*^9, 3.7632245013686857`*^9}, {3.763224610348407*^9, 
   3.763224668144497*^9}, 3.7632247860050983`*^9, {3.763224824156043*^9, 
   3.7632248317460546`*^9}, {3.7632250030632496`*^9, 
   3.7632250827313566`*^9}, {3.7632255744546957`*^9, 3.763225585403745*^9}, {
   3.763227357128426*^9, 3.7632274029040556`*^9}, {3.7632274735023284`*^9, 
   3.763227529524561*^9}, {3.763237566165558*^9, 3.7632375742855635`*^9}, {
   3.7632376321169877`*^9, 3.7632376602984886`*^9}, {3.7632377681795244`*^9, 
   3.763237860515341*^9}, {3.7632378998612537`*^9, 3.7632380134283648`*^9}, {
   3.7632380886360435`*^9, 3.7632381486197605`*^9}, 3.763238479257824*^9, {
   3.7632385279386506`*^9, 3.7632385288385735`*^9}, {3.7632386038620834`*^9, 
   3.7632386062105827`*^9}, {3.7632388047283196`*^9, 3.76323882110028*^9}, {
   3.763238853572158*^9, 3.763238855336449*^9}, {3.763238933373856*^9, 
   3.7632389402219524`*^9}, {3.7632390520022135`*^9, 
   3.7632391023477044`*^9}, {3.763239171254159*^9, 3.7632391973122454`*^9}, {
   3.7632392402605076`*^9, 3.763239307587145*^9}, {3.763239673610217*^9, 
   3.763239705796475*^9}, {3.763240014965122*^9, 3.763240016849313*^9}, {
   3.7632406869204845`*^9, 3.7632407449903584`*^9}, {3.763240784741401*^9, 
   3.7632411851882124`*^9}, {3.763241327698741*^9, 3.763241340142268*^9}, {
   3.763241443384272*^9, 3.7632414436831512`*^9}, {3.7632415076238327`*^9, 
   3.7632415110980883`*^9}, {3.7632415439325333`*^9, 3.76324158101105*^9}, {
   3.7632423434126363`*^9, 3.763242343705862*^9}, {3.763242423243868*^9, 
   3.763242481008464*^9}, {3.7632425502709303`*^9, 3.7632426192717648`*^9}, {
   3.763243524952131*^9, 3.7632435791462564`*^9}, {3.7632436721236963`*^9, 
   3.763243700189269*^9}, {3.7632438286379156`*^9, 3.763243838342002*^9}, {
   3.7632439090030394`*^9, 3.763244023024229*^9}, 3.7632440918821745`*^9, {
   3.763244142789095*^9, 3.763244175186474*^9}},
 CellLabel->
  "In[122]:=",ExpressionUUID->"21f67601-67c9-422c-9c80-923538ba6bd2"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`p$$ = {2, 0}, $CellContext`s$$ = 1, 
    Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`s$$], 1, "Move"}, 1, 17, 1}, {{
       Hold[$CellContext`p$$], {2, 0}}}}, Typeset`size$$ = {
    573., {341., 350.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`s$249465$$ = 0}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`p$$ = {2, 0}, $CellContext`s$$ = 1}, 
      "ControllerVariables" :> {
        Hold[$CellContext`s$$, $CellContext`s$249465$$, 0]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, 
      "Body" :> ($CellContext`po1 = Map[{0, -1} + #& , 
          CirclePoints[4]]; $CellContext`po2 = Map[{2, -2} + #& , 
          CirclePoints[5]]; $CellContext`po3 = Map[{2, 1} + #& , 
          CirclePoints[3]]; $CellContext`po4 = {{0, 0}, {0, 1}, {-0.5, 
          0.5}, {-1, 1}, {-1, 0}}; $CellContext`SortedList = N[
          Sort[
           Join[
            $CellContext`vertexList[$CellContext`po1], 
            $CellContext`vertexList[$CellContext`po2], 
            $CellContext`vertexList[$CellContext`po3], 
            $CellContext`vertexList[$CellContext`po4]], \
$CellContext`getAngle[{$CellContext`p$$, 
              Part[#, 2]}] < $CellContext`getAngle[{$CellContext`p$$, 
              Part[#2, 2]}]& ]]; $CellContext`Q = 
        Map[$CellContext`intersectInteriorQRev2[$CellContext`p$$, #]& , \
$CellContext`SortedList]; Graphics[{{
           EdgeForm[Thin], White, 
           Polygon[$CellContext`po1], 
           Polygon[$CellContext`po2], 
           Polygon[$CellContext`po3], 
           Polygon[$CellContext`po4]}, {Red, 
           Point[$CellContext`p$$]}, {Blue, 
           Line[{$CellContext`p$$, 
             Part[
              Part[$CellContext`SortedList, $CellContext`s$$], 2]}]}, {
           Text[
            Part[$CellContext`Q, $CellContext`s$$], 
            Mean[{$CellContext`p$$, 
              Part[
               Part[$CellContext`SortedList, $CellContext`s$$], 2]}]]}}]), 
      "Specifications" :> {{{$CellContext`s$$, 1, "Move"}, 1, 17, 1, 
         Appearance -> "Open"}, {{$CellContext`p$$, {2, 0}}, ControlType -> 
         Locator}}, "Options" :> {}, "DefaultOptions" :> {}],
     ImageSizeCache->{657., {433., 443.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{3.7632669238248672`*^9, 3.763315626058317*^9, 
  3.763580722995041*^9},
 CellLabel->
  "Out[122]=",ExpressionUUID->"aff56c0d-cb81-48a1-a4aa-8d3e6b4ac84a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "True", " ", "if", " ", "w2", " ", "is", " ", "Interior", " ", "vertex", 
    " ", "from", " ", "p"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"intersectInteriorQRev2", "[", 
     RowBox[{"p_", ",", 
      RowBox[{"{", 
       RowBox[{"w1_", ",", "w2_", ",", "w3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{
     RowBox[{"getClockwiseAngle", "[", 
      RowBox[{"w1", ",", "w2", ",", "w3"}], "]"}], ">", " ", 
     RowBox[{"getClockwiseAngle", "[", 
      RowBox[{"p", ",", "w2", ",", "w3"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Clockwise", " ", "angle", " ", "bwtween", " ", "tw", " ", "o", " ", 
     "vectors"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"adndevblog", ".", "typepad", ".", "com"}], "/", 
          "manufacturing"}], "/", "2012"}], "/", "07"}], "/", "finding"}], 
      "-", "the", "-", "angle", "-", "between", "-", "two", "-", "vectors", 
      "-", "along", "-", "a", "-", "given", "-", "direction", "-", "anti", 
      "-", "clockwise", "-", "or", "-", 
      RowBox[{"clockwise", ".", "html"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getClockwiseAngle", "[", 
     RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"p3", "-", "p2"}]}], ",", 
        RowBox[{"b", "=", 
         RowBox[{"p1", "-", "p2"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"a", ",", "0"}], "]"}], ";", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"b", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Cross", "[", 
            RowBox[{"a", ",", "b"}], "]"}], "\[LeftDoubleBracket]", "3", 
           "\[RightDoubleBracket]"}], "<", "0"}], ",", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", "Pi"}], " ", "-", 
           RowBox[{"VectorAngle", "[", 
            RowBox[{"a", ",", "b"}], "]"}]}], ")"}], ",", 
         RowBox[{"VectorAngle", "[", 
          RowBox[{"a", ",", "b"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]", 
     "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Returns", " ", "if", " ", "the", " ", "vertex", " ", "is", " ", "not", 
     " ", "visible", " ", "from", " ", "point", " ", "p"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"intersectInteriorQ", "[", 
     RowBox[{"p_", ",", 
      RowBox[{"{", 
       RowBox[{"w1_", ",", "w2_", ",", "w3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Or", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"anglePoints", "[", 
        RowBox[{"w1", ",", "w2", ",", "w3"}], "]"}], "<", " ", 
       RowBox[{"anglePoints", "[", 
        RowBox[{"p", ",", "w2", ",", "w3"}], "]"}]}], ",", 
      RowBox[{
       RowBox[{"anglePoints", "[", 
        RowBox[{"w1", ",", "w2", ",", "w3"}], "]"}], "<", " ", 
       RowBox[{"anglePoints", "[", 
        RowBox[{"p", ",", "w2", ",", "w1"}], "]"}]}]}], "]"}]}], "\n", 
   RowBox[{"(*", 
    RowBox[{
    "Returns", " ", "angle", " ", "between", " ", "the", " ", "three", " ", 
     "points"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"anglePoints", "[", 
     RowBox[{"p0_", ",", "p1_", ",", "p2_"}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "p1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "p0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ")"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "p1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "p0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             ")"}], "^", "2"}]}], ")"}]}], ",", 
        RowBox[{"b", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "p1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "p2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ")"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "p1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "p2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             ")"}], "^", "2"}]}], ")"}]}], ",", 
        RowBox[{"c", "=", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "p2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "p0", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
             ")"}], "^", "2"}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "p2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "-", 
              RowBox[{
              "p0", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
             ")"}], "^", "2"}]}], ")"}]}]}], "}"}], ",", 
      RowBox[{"Mod", "[", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ArcCos", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"a", "+", "b", "-", "c"}], ")"}], "/", 
            RowBox[{"Sqrt", "[", 
             RowBox[{"4", "*", "a", "*", "b"}], "]"}]}], ")"}]}], ")"}], ",", 
        RowBox[{"2", "Pi"}]}], "]"}]}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7632417874795303`*^9, {3.763241834836933*^9, 3.7632420185773973`*^9}, {
   3.763242074854607*^9, 3.763242077918415*^9}, {3.763242112617639*^9, 
   3.763242124713317*^9}, {3.7632422161269245`*^9, 3.76324230355222*^9}, {
   3.763242734899631*^9, 3.763242892686514*^9}, {3.7632429774279547`*^9, 
   3.763243073933981*^9}, {3.763243226964872*^9, 3.763243464738119*^9}, {
   3.7632444349829597`*^9, 3.7632445753932333`*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"e53be979-dbdf-4f9f-8a36-6c9045d98802"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"f1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
     ">", 
     RowBox[{"#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f2", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     ">", 
     RowBox[{"#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
    "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Sort", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "2"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "1"}], "}"}]}], "}"}], ",", 
   RowBox[{
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "\[NotEqual]", " ", 
       RowBox[{"#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       ",", 
      RowBox[{
       RowBox[{"#1", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       "<", 
       RowBox[{"#2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
       ",", 
      RowBox[{
       RowBox[{"#1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
       ">", 
       RowBox[{
       "#2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}], 
     "]"}], "&"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.763258955550668*^9, 3.763259339127653*^9}, {
  3.7632594449356785`*^9, 3.763259696684978*^9}, {3.7632599252141485`*^9, 
  3.763259974010109*^9}},
 CellLabel->
  "In[1263]:=",ExpressionUUID->"2c7a1554-9098-41a0-9665-cc29efe5cff5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7632589560713367`*^9, {3.763258988713587*^9, 3.763259076928693*^9}, {
   3.763259125604337*^9, 3.763259340293536*^9}, {3.763259446412759*^9, 
   3.7632596445013266`*^9}, {3.763259688429791*^9, 3.7632596974221845`*^9}, 
   3.7632599770100007`*^9},
 CellLabel->
  "Out[1265]=",ExpressionUUID->"bdd17ad9-ff63-4bff-8c49-858fe648d3b7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"list", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"list", "=", " ", 
  RowBox[{"DeleteCases", "[", 
   RowBox[{"list", ",", "1"}], "]"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.763263407358281*^9, 3.7632634407727747`*^9}},
 CellLabel->
  "In[1341]:=",ExpressionUUID->"9c7da682-0d4d-4670-aebc-4f995b7da680"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"2", ",", "3", ",", "4"}], "}"}]], "Output",
 CellChangeTimes->{3.763263441046871*^9},
 CellLabel->
  "Out[1342]=",ExpressionUUID->"c2979f24-7df7-4a49-bec1-9ed4654458cc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SegmentIntersectionQ", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", "1"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "1"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "0"}], "}"}]}], "}"}]}], "}"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.7635774135655613`*^9, 3.763577443892706*^9}, {
  3.7635775498594646`*^9, 3.7635775499873676`*^9}, {3.763577588332658*^9, 
  3.763577639639632*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"58045392-ee3a-40bb-84f6-cebf636b2c39"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.763577445583229*^9, {3.763577538016214*^9, 3.7635775526727095`*^9}, {
   3.7635776400645704`*^9, 3.7635776435832777`*^9}},
 CellLabel->"Out[61]=",ExpressionUUID->"352945e0-9c26-4720-9d0c-0a3c85bb10fa"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"segmentIntQ", "[", 
   RowBox[{"line1_", ",", "line2_"}], "]"}], ":=", "\[IndentingNewLine]", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"SegmentIntersectionQ", "[", 
      RowBox[{"Chop", "@", 
       RowBox[{"{", 
        RowBox[{"line1", ",", "line2"}], "}"}]}], "]"}], ")"}], ",", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"LineIntersectionPoint", "[", 
        RowBox[{"Chop", "@", 
         RowBox[{"{", 
          RowBox[{"line1", ",", "line2"}], "}"}]}], "]"}], "\[NotEqual]", 
       RowBox[{
       "line2", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], ",",
       "True", ",", "False"}], "]"}], ",", "False"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7635784737271757`*^9, 3.763578561327077*^9}, {
   3.763580543826519*^9, 3.763580550080208*^9}, {3.7635807163190413`*^9, 
   3.7635807180551295`*^9}, 3.7635807530941024`*^9},
 CellLabel->
  "In[221]:=",ExpressionUUID->"1c3dd369-b0bb-430e-8259-344e9f46cad3"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.7635807112878094`*^9, 
  3.763580713333045*^9}},ExpressionUUID->"d66c4dcb-eaa7-4070-86b7-\
ddb0fc649152"]
},
WindowSize->{1536, 791},
WindowMargins->{{-8, Automatic}, {Automatic, 0}},
Magnification:>1.6 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 864, 21, 102, "Input",ExpressionUUID->"88d9f809-dc68-4788-9626-b8ba37abf48a",
 InitializationCell->True,
 CellID->141966600],
Cell[1425, 43, 900, 23, 102, "Input",ExpressionUUID->"036b12bf-8e74-40c6-8773-b88969294126",
 InitializationCell->True,
 CellID->126976910],
Cell[2328, 68, 221, 5, 55, "Text",ExpressionUUID->"0642877f-fdb6-4d68-b4e1-3f38f444b863"],
Cell[2552, 75, 2100, 55, 174, "Input",ExpressionUUID->"708bcef0-023e-4ed0-b2fc-09beb59b29aa",
 InitializationCell->True,
 CellID->91357628],
Cell[4655, 132, 3134, 85, 205, "Input",ExpressionUUID->"f4a0dd36-4d89-448e-9721-7a6e1410da37",
 InitializationCell->True,
 CellID->1379934535],
Cell[7792, 219, 4272, 97, 222, "Input",ExpressionUUID->"fa04a22e-df40-4dc8-ba08-b52380cf9848",
 InitializationCell->True,
 CellID->1016457520],
Cell[12067, 318, 2009, 48, 162, "Input",ExpressionUUID->"836c3ddb-844c-4fdf-a831-21622428b376",
 InitializationCell->True],
Cell[14079, 368, 737, 16, 71, "Input",ExpressionUUID->"f964c0c7-a2c9-4aab-82e0-244a9cf7bd7f",
 InitializationCell->True],
Cell[14819, 386, 1246, 36, 132, "Input",ExpressionUUID->"0df7685d-e127-4097-a63f-82b5941f3211",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[16090, 426, 34568, 688, 2326, "Input",ExpressionUUID->"69c02ee2-f928-4595-b37a-29c71f52dfde"],
Cell[50661, 1116, 10979, 196, 707, "Output",ExpressionUUID->"4d52141b-df4d-46cc-bb99-68110f0b0537"]
}, Open  ]],
Cell[61655, 1315, 814, 19, 106, "Input",ExpressionUUID->"59fda00d-8a5b-4d56-937a-645505f11bc5"],
Cell[62472, 1336, 151, 3, 45, "Input",ExpressionUUID->"0671e3b7-2142-464f-b025-ad04cee3d648"],
Cell[62626, 1341, 229, 4, 45, "Input",ExpressionUUID->"51d19c7b-bfe2-4f3b-9bf7-c3ffe48323e5"],
Cell[CellGroupData[{
Cell[62880, 1349, 4074, 126, 491, "Input",ExpressionUUID->"eae08493-87b5-45ff-9774-2170586ac9d5"],
Cell[66957, 1477, 236, 5, 51, "Output",ExpressionUUID->"226a0c76-b21a-4245-be00-75b66e3496cd"],
Cell[67196, 1484, 1935, 39, 546, "Output",ExpressionUUID->"43f29c46-d29c-440a-9569-56ec37034eae"]
}, Open  ]],
Cell[69146, 1526, 2648, 66, 312, "Input",ExpressionUUID->"6ef47da8-ae4b-4d58-9064-fd495e178f5c",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[71819, 1596, 945, 23, 136, "Input",ExpressionUUID->"70203311-7fae-4229-9708-6e1afe8c91ca"],
Cell[72767, 1621, 157, 3, 51, "Output",ExpressionUUID->"95f333c3-cc04-46ef-9eb5-2e2f6d3b9c3d"]
}, Open  ]],
Cell[72939, 1627, 323, 8, 45, "Input",ExpressionUUID->"fe99acbd-eefa-4ac8-9966-5acad84ed1d4"],
Cell[73265, 1637, 710, 15, 45, "Input",ExpressionUUID->"701e3bd5-2bc6-428a-8e55-ac48c74b3c2e"],
Cell[CellGroupData[{
Cell[74000, 1656, 7854, 180, 376, "Input",ExpressionUUID->"21f67601-67c9-422c-9c80-923538ba6bd2"],
Cell[81857, 1838, 3311, 68, 905, "Output",ExpressionUUID->"aff56c0d-cb81-48a1-a4aa-8d3e6b4ac84a"]
}, Open  ]],
Cell[85183, 1909, 6848, 183, 522, "Input",ExpressionUUID->"e53be979-dbdf-4f9f-8a36-6c9045d98802",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[92056, 2096, 1756, 50, 106, "Input",ExpressionUUID->"2c7a1554-9098-41a0-9665-cc29efe5cff5"],
Cell[93815, 2148, 585, 15, 51, "Output",ExpressionUUID->"bdd17ad9-ff63-4bff-8c49-858fe648d3b7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94437, 2168, 447, 11, 106, "Input",ExpressionUUID->"9c7da682-0d4d-4670-aebc-4f995b7da680"],
Cell[94887, 2181, 209, 5, 51, "Output",ExpressionUUID->"c2979f24-7df7-4a49-bec1-9ed4654458cc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95133, 2191, 742, 22, 45, "Input",ExpressionUUID->"58045392-ee3a-40bb-84f6-cebf636b2c39"],
Cell[95878, 2215, 257, 4, 51, "Output",ExpressionUUID->"352945e0-9c26-4720-9d0c-0a3c85bb10fa"]
}, Open  ]],
Cell[96150, 2222, 1044, 26, 132, "Input",ExpressionUUID->"1c3dd369-b0bb-430e-8259-344e9f46cad3",
 InitializationCell->True],
Cell[97197, 2250, 154, 3, 45, "Input",ExpressionUUID->"d66c4dcb-eaa7-4070-86b7-ddb0fc649152"]
}
]
*)

