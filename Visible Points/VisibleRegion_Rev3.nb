(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    106933,       2489]
NotebookOptionsPosition[    100678,       2393]
NotebookOutlinePosition[    101052,       2409]
CellTagsIndexPosition[    101009,       2406]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "invisiblePoly", ",", "poly1", ",", "poly2", ",", "bound", ",", "m", 
       ",", " ", "cval"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"cval", " ", "=", " ", 
       RowBox[{"ColorData", "[", 
        RowBox[{"87", ",", "\"\<ColorList\>\""}], "]"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{
       "Colors", " ", "for", " ", "robots", " ", "and", " ", "the", " ", 
        "visible", " ", "regions"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"invisiblePoly", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"#", "+", 
           RowBox[{"{", 
            RowBox[{"0.001", ",", "0.001"}], "}"}]}], ")"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"7", "*", 
          RowBox[{"CirclePoints", "@", "4"}]}], ")"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"poly1", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "pts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "+",
            "#"}], ")"}], "&"}], "/@", 
        RowBox[{"CirclePoints", "[", "4", "]"}]}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"polyi", " ", "are", " ", "moveable", " ", "obstacles"}], 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"poly2", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "pts", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], "+",
            "#"}], ")"}], "&"}], "/@", 
        RowBox[{"CirclePoints", "[", "3", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"bound", "=", 
       RowBox[{"(", 
        RowBox[{"5", "*", 
         RowBox[{"CirclePoints", "@", "4"}]}], ")"}]}], ";", " ", 
      RowBox[{"(*", 
       RowBox[{"boundaries", " ", "of", " ", "the", " ", "workspace"}], 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "Only", " ", "recalculate", " ", "the", " ", "visible", " ", "region", 
        " ", "if", " ", "a", " ", "point", " ", "moves", " ", 
        RowBox[{"(", 
         RowBox[{
         "or", " ", "a", " ", "moveable", " ", "obstacle", " ", "moves"}], 
         ")"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "pts", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              "\[NotEqual]", " ", 
              RowBox[{
              "ptsOld", "\[LeftDoubleBracket]", "i", 
               "\[RightDoubleBracket]"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "pts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
              "\[NotEqual]", " ", 
              RowBox[{
              "ptsOld", "\[LeftDoubleBracket]", "1", 
               "\[RightDoubleBracket]"}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
              "pts", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
              "\[NotEqual]", " ", 
              RowBox[{
              "ptsOld", "\[LeftDoubleBracket]", "2", 
               "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"visibleRegion", "\[LeftDoubleBracket]", 
              RowBox[{"i", "-", "2"}], "\[RightDoubleBracket]"}], "=", 
             RowBox[{"visiblePolysRev3", "[", 
              RowBox[{
               RowBox[{"N", "@", 
                RowBox[{"{", 
                 RowBox[{
                 "poly1", ",", "poly2", ",", "bound", ",", "invisiblePoly"}], 
                 "}"}]}], ",", 
               RowBox[{
               "pts", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "ptsOld", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}],
              "=", 
             RowBox[{
             "pts", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
            ";"}]}], "]"}], ";"}], "\[IndentingNewLine]", ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3", ",", 
          RowBox[{"s", "+", "2"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "pts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
           "\[NotEqual]", " ", 
           RowBox[{
           "ptsOld", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}],
           ")"}], "||", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
           "pts", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
           "\[NotEqual]", " ", 
           RowBox[{
           "ptsOld", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
           ")"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ptsOld", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{
          "pts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         ";", 
         RowBox[{
          RowBox[{
          "ptsOld", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{
          "pts", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "cval", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
              RowBox[{"Polygon", "@", 
               RowBox[{
               "visibleRegion", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "s"}], "}"}]}], "]"}], " ", 
          RowBox[{"(*", 
           RowBox[{"visible", " ", "regions"}], "*)"}], "\[IndentingNewLine]",
           ",", 
          RowBox[{"{", 
           RowBox[{"Transparent", ",", 
            RowBox[{"{", 
             RowBox[{"Polygon", "@", "invisiblePoly"}], "}"}], ",", 
            RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"Polygon", "@", "bound"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"Polygon", "@", "poly1"}], ",", 
              RowBox[{"Polygon", "@", "poly2"}]}], "}"}]}], "}"}], " ", 
          RowBox[{"(*", " ", "obstacles", "*)"}], "\[IndentingNewLine]", ",", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "cval", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"{", 
                RowBox[{"Thin", ",", "Black"}], "}"}], "]"}], ",", 
              RowBox[{"Disk", "[", 
               RowBox[{
                RowBox[{"pts", "\[LeftDoubleBracket]", 
                 RowBox[{"i", "+", "2"}], "\[RightDoubleBracket]"}], ",", 
                "0.1"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "s"}], "}"}]}], "]"}]}], " ", 
         RowBox[{"(*", "guards", "*)"}], "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", " ", 
         RowBox[{"4", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}]}]}],
     "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "4", ",", "\"\<Number of Guards\>\""}], "}"}], ",", 
     RowBox[{"Range", "@", "8"}], ",", 
     RowBox[{"ControlType", "->", "Setter"}]}], "}"}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"visibleRegion", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], "}"}]}], "}"}]}], "}"}], ",", " ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ptsOld", ",", 
       RowBox[{
        RowBox[{"-", "10"}], 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", "1"}], "}"}]}], "}"}]}]}], "}"}], ",", " ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pts", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0.10"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"4", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{"4", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", "Locator", ",", 
     RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764965539798676*^9, 3.7649655400444107`*^9}, {
   3.764965582574123*^9, 3.7649656055493064`*^9}, {3.7649659291979094`*^9, 
   3.764966100623652*^9}, {3.7649662172321415`*^9, 3.764966244269495*^9}, {
   3.764966293452073*^9, 3.7649662943383303`*^9}, {3.7649667599979053`*^9, 
   3.764966779688657*^9}, {3.76496681060527*^9, 3.7649668540452857`*^9}, {
   3.764966909727465*^9, 3.7649669221001153`*^9}, {3.764967851667949*^9, 
   3.764967862456826*^9}, {3.7649680256081624`*^9, 3.764968029206252*^9}, {
   3.7649687267418823`*^9, 3.7649687300283318`*^9}, {3.7649690586362677`*^9, 
   3.764969060790703*^9}, {3.7649693597672896`*^9, 3.7649693604013157`*^9}, {
   3.764985943077859*^9, 3.7649859483940115`*^9}, {3.7649862450731544`*^9, 
   3.764986250305341*^9}, {3.7649863366210203`*^9, 3.764986342145485*^9}, {
   3.7649866431198807`*^9, 3.7649866940077767`*^9}, {3.7649867259970675`*^9, 
   3.7649867691178627`*^9}, {3.764986802670251*^9, 3.764986974672299*^9}, {
   3.7649870639686365`*^9, 3.764987064068077*^9}, 3.764987179132023*^9, {
   3.7649873357780905`*^9, 3.764987379229001*^9}, {3.7649874092600155`*^9, 
   3.764987483386527*^9}, {3.7649876380320053`*^9, 3.7649877771094503`*^9}, {
   3.7649880681216087`*^9, 3.7649881496196413`*^9}, 3.7649882010672417`*^9, {
   3.7649882475013523`*^9, 3.7649882621439877`*^9}, {3.7649883409659348`*^9, 
   3.764988348835311*^9}, {3.7649886129090986`*^9, 3.7649887796524167`*^9}, {
   3.7649888503170586`*^9, 3.764989012181364*^9}, {3.764989054121647*^9, 
   3.7649891780520525`*^9}, {3.7649892520080876`*^9, 
   3.7649892523200846`*^9}, {3.764989293568593*^9, 3.764989329759313*^9}, {
   3.7649893958600626`*^9, 3.7649894045349207`*^9}, {3.764989454064685*^9, 
   3.764989468281987*^9}, {3.764989586378462*^9, 3.764989586928721*^9}, {
   3.7649897375409107`*^9, 3.7649897391847386`*^9}, {3.764990115156066*^9, 
   3.764990147181944*^9}, {3.764990186083614*^9, 3.7649903199194355`*^9}, {
   3.764990357025355*^9, 3.764990358493563*^9}, {3.7649914260664606`*^9, 
   3.764991450016022*^9}, {3.764991971276353*^9, 3.764991973684534*^9}, {
   3.765130769459999*^9, 3.76513080589145*^9}, {3.7651310898812237`*^9, 
   3.76513120724283*^9}, {3.7651318053125734`*^9, 3.7651318778324695`*^9}, {
   3.76513191087951*^9, 3.76513197154758*^9}, {3.7651320018153152`*^9, 
   3.765132138113017*^9}, {3.7654097307484436`*^9, 3.7654098902587123`*^9}, {
   3.7654099222845397`*^9, 3.7654099319601297`*^9}, {3.7654099695097756`*^9, 
   3.76540999694044*^9}, {3.7654100739618177`*^9, 3.765410074281912*^9}, {
   3.7654101251489615`*^9, 3.7654101557102003`*^9}, {3.765410197089198*^9, 
   3.7654101975277376`*^9}, {3.765410354218835*^9, 3.7654103630040183`*^9}, {
   3.765410414197678*^9, 3.765410456039402*^9}, {3.7654105172642097`*^9, 
   3.7654105756221094`*^9}, {3.7654161283264737`*^9, 3.765416140250456*^9}, {
   3.765416204953722*^9, 3.7654162103433657`*^9}, {3.765416330923199*^9, 
   3.7654163521808205`*^9}, {3.7654247618890853`*^9, 
   3.7654247621208143`*^9}, {3.765713571408181*^9, 3.765713585888489*^9}, {
   3.76571362711732*^9, 3.7657136273187795`*^9}, {3.769800324721612*^9, 
   3.769800346059581*^9}, {3.769800412315553*^9, 3.7698004437076483`*^9}, {
   3.769801882914316*^9, 3.7698019128413277`*^9}, {3.769801980090578*^9, 
   3.769802009498974*^9}, {3.7698020447038784`*^9, 3.769802218219139*^9}, {
   3.7698022759916353`*^9, 3.769802283465658*^9}, {3.769802369510709*^9, 
   3.7698025313351355`*^9}, {3.7698025725609455`*^9, 3.76980261076184*^9}, {
   3.769802663312411*^9, 3.7698027929887733`*^9}, {3.7698028234533434`*^9, 
   3.769802825251538*^9}, {3.7698028703499966`*^9, 3.7698029053025703`*^9}, {
   3.7698029379443235`*^9, 3.7698032629506245`*^9}, {3.7698033332387543`*^9, 
   3.769803633786431*^9}, {3.7698036724249487`*^9, 3.7698037898989563`*^9}, {
   3.7698038299449177`*^9, 3.769804264488443*^9}, {3.7698043302436852`*^9, 
   3.7698043392226853`*^9}, {3.7698043867098103`*^9, 3.769804407919072*^9}, {
   3.7698487807076063`*^9, 3.769848782253125*^9}, {3.769848882840413*^9, 
   3.769848885209511*^9}, {3.7698489746142073`*^9, 3.769849054572678*^9}, {
   3.769849096829094*^9, 3.769849190572721*^9}, {3.769849232459968*^9, 
   3.769849322953788*^9}, {3.769849359098021*^9, 3.769849417227084*^9}, {
   3.769849450817895*^9, 3.769849513819037*^9}, {3.769850187725575*^9, 
   3.7698501932122917`*^9}, {3.7698502861742067`*^9, 3.769850289996069*^9}, {
   3.769850340158079*^9, 3.769850356412511*^9}, {3.769850437079791*^9, 
   3.7698505250380087`*^9}, {3.76985062198176*^9, 3.769850713695861*^9}, {
   3.769850826587224*^9, 3.769850869429997*^9}, {3.7698610184260063`*^9, 
   3.769861026112302*^9}, {3.769861300078977*^9, 3.769861325137315*^9}, {
   3.7698614361398773`*^9, 3.7698615527092752`*^9}, {3.769861597071603*^9, 
   3.7698616488874474`*^9}, {3.769861679955002*^9, 3.7698617610844812`*^9}, {
   3.769861890670793*^9, 3.769861947136181*^9}, {3.769861980081015*^9, 
   3.769862020496539*^9}, {3.769862053534548*^9, 3.769862075889573*^9}, {
   3.76986218209354*^9, 3.769862330496821*^9}, {3.769862368626131*^9, 
   3.769862518725431*^9}, {3.7698625507889643`*^9, 3.769862663350587*^9}, {
   3.7698650665606394`*^9, 3.769865096601595*^9}, {3.769865137365658*^9, 
   3.7698652226425853`*^9}, {3.7698652582406974`*^9, 3.7698653041614857`*^9}},
 CellLabel->"In[33]:=",ExpressionUUID->"4b1e4c1e-ed26-4125-97e1-052f34df3a3d"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`pts$$ = {{1, 0}, {2, 
     2}, {-1.5, -0.17999999999999972`}, {1.125, -0.3599999999999999}, {1.17, 
     0.2599999999999998}, {2.0150000000000006`, 2.04}, {-2, 1}, {-1, 
     0}, {-1, -1}, {0, -1}}, $CellContext`ptsOld$$ = {{1, 0}, {2, 
     2}, {-1.5, -0.17999999999999972`}, {1.125, -0.3599999999999999}, {1.17, 
     0.2599999999999998}, {2.0150000000000006`, 
     2.04}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}}, $CellContext`s$$ \
= 4, $CellContext`visibleRegion$$ = {{{0.29289321881345254`, 
     0.7071067811865475}, {1.8953754739399316`, 1.4999999999999998`}, {
     1.1339745962155614`, 1.5}, {2., 3.}, {2.5894241103033266`, 
     3.5355339059327378`}, {-3.5355339059327373`, 
     3.5355339059327373`}, {-3.5355339059327373`, -3.5355339059327373`}, {
     3.5355339059327373`, -3.5355339059327373`}, {
     3.5355339059327378`, -1.6604362250131866`}, {
     0.29289321881345254`, -0.7071067811865475}}, {{1.7071067811865475`, 
     0.7071067811865475}, {0.29289321881345254`, 0.7071067811865475}, {
     0.29289321881345254`, -0.7071067811865475}, {
     1.7071067811865475`, -0.7071067811865475}}, {{1.7071067811865475`, 
     0.7071067811865475}, {0.29289321881345254`, 0.7071067811865475}, {
     0.29289321881345254`, -0.7071067811865475}, {
     1.7071067811865475`, -0.7071067811865475}}, {{2., 3.}, {
     1.1339745962155614`, 1.5}, {2.8660254037844384`, 1.5}}, {{1, 1}}, {{1, 
     1}}, {{1, 1}}, {{1, 1}}}, Typeset`show$$ = True, 
    Typeset`bookmarkList$$ = {}, Typeset`bookmarkMode$$ = "Menu", 
    Typeset`animator$$, Typeset`animvar$$ = 1, Typeset`name$$ = 
    "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`s$$], 4, "Number of Guards"}, {1, 2, 3, 4, 5, 6, 7, 
      8}}, {{
       Hold[$CellContext`visibleRegion$$], {{{1, 1}}, {{1, 1}}, {{1, 1}}, {{1,
        1}}, {{1, 1}}, {{1, 1}}, {{1, 1}}, {{1, 1}}}}}, {{
       Hold[$CellContext`ptsOld$$], {{-10, -10}, {-10, -10}, {-10, -10}, \
{-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, \
-10}}}}, {{
       Hold[$CellContext`pts$$], {{1, 0}, {2, 2}, {0, 0.1}, {1, 1}, {3, 0}, {
        1, 2}, {-2, 1}, {-1, 0}, {-1, -1}, {0, -1}}}, {-4, -4}, {4, 4}}}, 
    Typeset`size$$ = {558., {275., 283.}}, Typeset`update$$ = 0, 
    Typeset`initDone$$, Typeset`skipInitDone$$ = 
    True, $CellContext`s$434179$$ = 0, $CellContext`pts$434180$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`pts$$ = {{1, 0}, {2, 2}, {0, 0.1}, {1, 
          1}, {3, 0}, {1, 2}, {-2, 1}, {-1, 0}, {-1, -1}, {
          0, -1}}, $CellContext`ptsOld$$ = {{-10, -10}, {-10, -10}, {-10, \
-10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, \
{-10, -10}}, $CellContext`s$$ = 
        4, $CellContext`visibleRegion$$ = {{{1, 1}}, {{1, 1}}, {{1, 1}}, {{1, 
         1}}, {{1, 1}}, {{1, 1}}, {{1, 1}}, {{1, 1}}}}, "ControllerVariables" :> {
        Hold[$CellContext`s$$, $CellContext`s$434179$$, 0], 
        Hold[$CellContext`pts$$, $CellContext`pts$434180$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`invisiblePoly$, $CellContext`poly1$, \
$CellContext`poly2$, $CellContext`bound$, $CellContext`m$, \
$CellContext`cval$}, $CellContext`cval$ = 
         ColorData[87, "ColorList"]; $CellContext`invisiblePoly$ = 
         Map[# + {0.001, 0.001}& , 7 CirclePoints[4]]; $CellContext`poly1$ = 
         Map[Part[$CellContext`pts$$, 1] + #& , 
           CirclePoints[4]]; $CellContext`poly2$ = 
         Map[Part[$CellContext`pts$$, 2] + #& , 
           CirclePoints[3]]; $CellContext`bound$ = 5 CirclePoints[4]; Table[If[
            Or[
            Part[$CellContext`pts$$, $CellContext`i] != 
             Part[$CellContext`ptsOld$$, $CellContext`i], 
             Part[$CellContext`pts$$, 1] != Part[$CellContext`ptsOld$$, 1], 
             Part[$CellContext`pts$$, 2] != Part[$CellContext`ptsOld$$, 2]], 
            Part[$CellContext`visibleRegion$$, $CellContext`i - 
               2] = $CellContext`visiblePolysRev3[
               
               N[{$CellContext`poly1$, $CellContext`poly2$, \
$CellContext`bound$, $CellContext`invisiblePoly$}], 
               Part[$CellContext`pts$$, $CellContext`i]]; 
            Part[$CellContext`ptsOld$$, $CellContext`i] = 
             Part[$CellContext`pts$$, $CellContext`i]; Null]; 
          Null, {$CellContext`i, 3, $CellContext`s$$ + 2}]; If[
          Or[
          Part[$CellContext`pts$$, 1] != Part[$CellContext`ptsOld$$, 1], 
           Part[$CellContext`pts$$, 2] != Part[$CellContext`ptsOld$$, 2]], 
          Part[$CellContext`ptsOld$$, 1] = Part[$CellContext`pts$$, 1]; 
          Part[$CellContext`ptsOld$$, 2] = Part[$CellContext`pts$$, 2]]; 
        Graphics[{
           Table[{
             Part[$CellContext`cval$, $CellContext`i], 
             Opacity[0.3], 
             Polygon[
              
              Part[$CellContext`visibleRegion$$, $CellContext`i]]}, \
{$CellContext`i, 1, $CellContext`s$$}], {Transparent, {
             Polygon[$CellContext`invisiblePoly$]}, 
            EdgeForm[Thin], {
             Polygon[$CellContext`bound$]}, {
             Polygon[$CellContext`poly1$], 
             Polygon[$CellContext`poly2$]}}, 
           Table[{
             Part[$CellContext`cval$, $CellContext`i], 
             EdgeForm[{Thin, Black}], 
             Disk[
              Part[$CellContext`pts$$, $CellContext`i + 2], 
              0.1]}, {$CellContext`i, 1, $CellContext`s$$}]}, PlotRange -> 
          4 {{-1, 1}, {-1, 1}}]], 
      "Specifications" :> {{{$CellContext`s$$, 4, "Number of Guards"}, {1, 2, 
         3, 4, 5, 6, 7, 8}, ControlType -> 
         Setter}, {{$CellContext`visibleRegion$$, {{{1, 1}}, {{1, 1}}, {{1, 
          1}}, {{1, 1}}, {{1, 1}}, {{1, 1}}, {{1, 1}}, {{1, 1}}}}, 
         ControlType -> 
         None}, {{$CellContext`ptsOld$$, {{-10, -10}, {-10, -10}, {-10, -10}, \
{-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, \
-10}}}, ControlType -> 
         None}, {{$CellContext`pts$$, {{1, 0}, {2, 2}, {0, 0.1}, {1, 1}, {3, 
           0}, {1, 2}, {-2, 1}, {-1, 0}, {-1, -1}, {0, -1}}}, {-4, -4}, {4, 
         4}, ControlType -> Locator, Appearance -> None}}, "Options" :> {}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{642., {349., 358.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{{3.769861532143181*^9, 3.7698615535925198`*^9}, {
   3.769861626357381*^9, 3.769861763327523*^9}, {3.769861892010593*^9, 
   3.76986194792933*^9}, 3.769862015966385*^9, {3.7698620622912493`*^9, 
   3.769862076546741*^9}, 3.7698623345239897`*^9, {3.769862447120078*^9, 
   3.769862519052744*^9}, {3.7698626249174747`*^9, 3.769862663749288*^9}, 
   3.769864875943136*^9, {3.769865068982028*^9, 3.7698650972096424`*^9}, 
   3.769865183627658*^9, {3.7698652168991566`*^9, 3.769865223117152*^9}, {
   3.7698652624496193`*^9, 3.769865305216126*^9}, 3.7698824735058403`*^9, 
   3.7698825173102455`*^9},
 CellLabel->"Out[33]=",ExpressionUUID->"b7531cdb-5371-4d81-9e3a-c3d985157ace"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"1", ",", "0"}], "}"}], "\[NotEqual]", " ", 
  RowBox[{"{", 
   RowBox[{"1", ",", "0.10"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.769850556141005*^9, 3.769850568969673*^9}, {
  3.769850610089098*^9, 
  3.76985061575746*^9}},ExpressionUUID->"f5f12c5a-64ed-40f4-9242-\
ef7d383921cf"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.769850560642787*^9, 3.769850569325692*^9}, {
  3.769850610762933*^9, 
  3.7698506164081497`*^9}},ExpressionUUID->"35c96057-a024-4599-a3b9-\
3d8b860584bc"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",ExpressionUUID->"e32b32fa-366c-4519-b8ad-5bc9bc3f42e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"visiblePolysRev3", "[", 
   RowBox[{"polys_", ",", 
    RowBox[{"p", ":", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"listofAllLines", "\[IndentingNewLine]", ",", 
      RowBox[{"InfinteLine", "=", 
       RowBox[{"{", 
        RowBox[{"p", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0.11", ",", "0"}], "}"}], "+", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"MaximalBy", "[", 
              RowBox[{
               RowBox[{"Flatten", "[", 
                RowBox[{"polys", ",", "1"}], "]"}], ",", "First"}], "]"}], 
             "\[LeftDoubleBracket]", 
             RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", "y"}], 
           "}"}]}]}], "}"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"length", "=", 
       RowBox[{"Length", "@", "polys"}]}], "\[IndentingNewLine]", ",", 
      RowBox[{"orderedList", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"testpoint", "[", 
            RowBox[{
             RowBox[{
             "polys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             ",", "p"}], "]"}], ",", 
           RowBox[{"Reverse", "@", 
            RowBox[{
            "polys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            ",", 
           RowBox[{
           "polys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", 
           RowBox[{"Length", "@", "polys"}], ",", "1"}], "}"}]}], "]"}]}], 
      "\[IndentingNewLine]", ",", "sortedList", ",", 
      RowBox[{"jList", "=", 
       RowBox[{"{", "}"}]}], ",", "lvLine", ",", 
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"wi", "=", "False"}], ",", 
      RowBox[{"wip", "=", "False"}], ",", "a", ",", "b", ",", "c", ",", 
      "abcList", ",", "ba", ",", "bc", ",", "pb", ",", "pbaAngle", ",", 
      "pbcAngle", ",", 
      RowBox[{"visibleList", "=", 
       RowBox[{"{", "}"}]}], ",", "startJlistInt", ",", "m", ",", "bcVisiInt",
       ",", "gLine", ",", "giList", ",", "giPoint", ",", "giLine", ",", 
      "abNotGlaInt", ",", "abNotVisInt", ",", "bcNotVisInt"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"orderedList", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"testpoint", "[", 
           RowBox[{
            RowBox[{
            "polys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", "p"}], "]"}], ",", 
          RowBox[{"Reverse", "@", 
           RowBox[{
           "polys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{
          "polys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "polys"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"listofAllLines", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"lineList", "@", "#"}], ")"}], "&"}], "/@", 
          "orderedList"}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sortedList", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"vertexList", "@", 
               RowBox[{"N", "@", "#"}]}], ")"}], "&"}], "/@", "orderedList"}],
            "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{
         RowBox[{"angleSortCond", "[", 
          RowBox[{"p", ",", "#1", ",", "#2"}], "]"}], " ", "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Length", "@", "sortedList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SegmentIntersectionQ", "[", 
          RowBox[{"{", 
           RowBox[{"InfinteLine", ",", "#"}], "}"}], "]"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"jList", ",", 
           RowBox[{"Reverse", "@", "#"}]}], "]"}]}], "]"}], "&"}], "/@", 
      "listofAllLines"}], ";", "\[IndentingNewLine]", 
     RowBox[{"jList", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"jList", ",", 
        RowBox[{
         RowBox[{"distSortCond", "[", 
          RowBox[{"InfinteLine", ",", "#1", ",", "#2", ",", "p"}], "]"}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lvLine", "=", 
      RowBox[{"First", "@", "jList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SegmentIntersectionQ", "[", 
          RowBox[{"{", 
           RowBox[{"lvLine", ",", 
            RowBox[{
            "jList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"startJlistInt", "=", 
           RowBox[{"N", "@", 
            RowBox[{"LineIntersectionPoint", "[", 
             RowBox[{"{", 
              RowBox[{"lvLine", ",", 
               RowBox[{
               "jList", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "}"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"Nor", "@@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"SegmentIntersectionQ", "[", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "startJlistInt"}], "}"}], ",", "#"}], 
                   "}"}], "]"}], ")"}], "&"}], "/@", "listofAllLines"}], 
              ")"}]}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"visibleList", ",", "startJlistInt"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "startJlistInt", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], ">", 
                RowBox[{
                "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
                ",", 
               RowBox[{"lvLine", "=", 
                RowBox[{
                "jList", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], "]"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "jList"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", "m"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"sortedList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"b", "=", 
         RowBox[{"sortedList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
        RowBox[{"c", "=", 
         RowBox[{"sortedList", "\[LeftDoubleBracket]", 
          RowBox[{"i", ",", "3"}], "\[RightDoubleBracket]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"abcList", "=", 
         RowBox[{"{", 
          RowBox[{"a", ",", "b", ",", "c"}], "}"}]}], ";", 
        RowBox[{"ba", "=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "a"}], "}"}]}], ";", 
        RowBox[{"bc", "=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], ";", 
        RowBox[{"pb", "=", 
         RowBox[{"{", 
          RowBox[{"p", ",", "b"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pbaAngle", "=", 
         RowBox[{"getClockwiseAngle", "[", 
          RowBox[{"p", ",", "b", ",", "a"}], "]"}]}], ";", 
        RowBox[{"pbcAngle", "=", 
         RowBox[{"getClockwiseAngle", "[", 
          RowBox[{"p", ",", "b", ",", "c"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"intersectInteriorQRev2", "[", 
           RowBox[{"p", ",", "abcList"}], "]"}], ",", 
          RowBox[{"wi", "=", "False"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "\[Equal]", "1"}], " ", "||", 
             RowBox[{"Not", "@", 
              RowBox[{"pointOnSegmentQ", "[", 
               RowBox[{"pb", ",", "a"}], "]"}]}]}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Or", "@@", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"pb", ",", "#"}], "}"}], "]"}], ")"}], "&"}], "/@",
                  "jList"}], ")"}]}], ",", 
              RowBox[{"wi", "=", "False"}], ",", 
              RowBox[{"wi", "=", "True"}]}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"Not", "@", "wip"}], ",", 
              RowBox[{"wi", "=", "False"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"Or", "@@", 
                   RowBox[{"(", 
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"ba", ",", "#"}], "}"}], "]"}], ")"}]}], "&"}], "/@",
                  "jList"}], ",", 
                RowBox[{"wi", "=", "False"}], ",", 
                RowBox[{"wi", "=", "True"}]}], "]"}]}], "]"}]}], "]"}]}], 
         "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"wi", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SegmentIntersectionQ", "[", 
              RowBox[{"{", 
               RowBox[{"lvLine", ",", "bc"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"bcVisiInt", "=", 
               RowBox[{"N", "@", 
                RowBox[{"LineIntersectionPoint", "[", 
                 RowBox[{"{", 
                  RowBox[{"lvLine", ",", "bc"}], "}"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Nor", "@@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "bcVisiInt"}], "}"}], ",", "#"}], "}"}],
                     "]"}], ")"}], "&"}], "/@", "listofAllLines"}], ")"}]}], 
                ",", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"visibleList", ",", "bcVisiInt"}], "]"}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"Not", "@", 
               RowBox[{"glancingBlow", "[", 
                RowBox[{"p", ",", "abcList"}], "]"}]}], ")"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"gLine", "=", 
               RowBox[{"extendedLine", "[", 
                RowBox[{"p", ",", "b"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"giList", " ", "=", " ", 
               RowBox[{"Sort", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"gLine", ",", "#"}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"gLine", ",", "#"}], "}"}], "]"}]}], ",", "#"}], 
                    "}"}]}], "]"}], "&"}], "/@", "jList"}], ")"}], ",", 
                    "Null"}], "]"}], ")"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], "<", " ", 
                   RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "&"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"giPoint", "=", 
               RowBox[{"giList", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
              RowBox[{"giLine", "=", 
               RowBox[{"giList", "\[LeftDoubleBracket]", 
                RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pointOnSegmentQ", "[", 
                 RowBox[{"lvLine", ",", "giPoint"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{"getAngle", "[", "pb", "]"}], "]"}], 
                    "\[NotEqual]", " ", "0"}], "\[IndentingNewLine]", ",", 
                   RowBox[{"visibleList", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"visibleList", ",", 
                    RowBox[{"{", 
                    RowBox[{"giPoint", ",", "b"}], "}"}]}], "]"}]}], 
                   "\[IndentingNewLine]", ",", 
                   RowBox[{"visibleList", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"visibleList", ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "giPoint"}], "}"}]}], "]"}]}]}], "]"}], 
                 ";", "\[IndentingNewLine]", 
                 RowBox[{"lvLine", "=", "ba"}]}], "\[IndentingNewLine]", ",", 
                RowBox[{
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"giLine", ",", "lvLine"}], "}"}], "]"}], ",", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"giLine", ",", "lvLine"}], "}"}], "]"}], 
                    "\[Equal]", "giPoint"}], "\[IndentingNewLine]", ",", 
                    RowBox[{"visibleList", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"visibleList", ",", 
                    RowBox[{"{", 
                    RowBox[{"giPoint", ",", "b"}], "}"}]}], "]"}]}], 
                    "\[IndentingNewLine]", ",", 
                    RowBox[{"visibleList", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"visibleList", ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "giPoint"}], "}"}]}], "]"}]}]}], "]"}], 
                    ";", 
                    RowBox[{"lvLine", "=", "ba"}]}], "\[IndentingNewLine]", 
                   ",", 
                   RowBox[{
                    RowBox[{"visibleList", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"visibleList", ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "giPoint"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"lvLine", "=", "giLine"}]}]}], "]"}], ";"}]}], 
               "]"}]}], "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"visibleList", ",", "b"}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"lvLine", "=", "ba"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"SegmentIntersectionQ", "[", 
                   RowBox[{"{", 
                    RowBox[{"ba", ",", 
                    RowBox[{
                    "jList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"abNotGlaInt", "=", 
                    RowBox[{"N", "@", 
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"ba", ",", 
                    RowBox[{
                    "jList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Nor", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "abNotGlaInt"}], "}"}], ",", "#"}], 
                    "}"}], "]"}], "&"}], "/@", "listofAllLines"}], ")"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"visibleList", ",", "abNotGlaInt"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"lvLine", "=", 
                    RowBox[{
                    "jList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}]}], "]"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "@", "jList"}], ",", "1"}], "}"}]}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SegmentIntersectionQ", "[", 
              RowBox[{"{", 
               RowBox[{"pb", ",", "lvLine"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pbaAngle", "<", "pbcAngle"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Not", "@", 
                   RowBox[{"leftOrRight", "[", 
                    RowBox[{"p", ",", "b", ",", "a"}], "]"}]}], " ", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"lvLine", ",", "ba"}], "}"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"abNotVisInt", "=", 
                    RowBox[{"N", "@", 
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"lvLine", ",", "ba"}], "}"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Nor", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "abNotVisInt"}], "}"}], ",", "#"}], 
                    "}"}], "]"}], "&"}], "/@", "listofAllLines"}], ")"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"visibleList", ",", "abNotVisInt"}], "]"}], ";", 
                    RowBox[{"lvLine", "=", "ba"}]}]}], "]"}]}]}], "]"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pbaAngle", "<", "pbcAngle"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Not", "@", 
                   RowBox[{"leftOrRight", "[", 
                    RowBox[{"p", ",", "b", ",", "c"}], "]"}]}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"lvLine", ",", "bc"}], "}"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"bcNotVisInt", "=", 
                    RowBox[{"N", "@", 
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"lvLine", ",", "bc"}], "}"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"Nor", "@@", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"{", 
                    RowBox[{"p", ",", "bcNotVisInt"}], "}"}], ",", "#"}], 
                    "}"}], "]"}], "&"}], "/@", "listofAllLines"}], ")"}]}], 
                    ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"visibleList", ",", "bcNotVisInt"}], "]"}], ";", 
                    RowBox[{"lvLine", "=", "bc"}]}]}], "]"}]}]}], "]"}]}], 
                 "]"}]}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"wip", "=", "wi"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"pbaAngle", "<", "Pi"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"jList", ",", "ba"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"pbcAngle", "<", "Pi"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"jList", ",", "bc"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"jList", "=", 
         RowBox[{"(", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"jList", ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "b"}], "}"}]}], "]"}], ")"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "visibleList"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7698005042478313`*^9, 3.7698005067611156`*^9}, {
  3.769800663565995*^9, 3.7698007120902953`*^9}, {3.769800821544349*^9, 
  3.769800821762767*^9}, {3.7698008895525713`*^9, 3.769800889827838*^9}, {
  3.769800922992238*^9, 3.769800928805654*^9}, {3.7698010094042263`*^9, 
  3.769801146391124*^9}, {3.769801183869901*^9, 3.7698012085657644`*^9}, {
  3.769801251149911*^9, 3.769801289881386*^9}, {3.769801325189013*^9, 
  3.769801652264784*^9}, {3.7698016951422124`*^9, 3.7698017424078417`*^9}, {
  3.769801787714773*^9, 3.7698018140434303`*^9}, {3.7698018558725963`*^9, 
  3.7698018589433875`*^9}, {3.7698062809785786`*^9, 3.769806289132785*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"27e2e2df-3c39-4f6b-95e4-036ec10f660d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "true", " ", "if", " ", "pt", "  ", "is", " ", "inside", " ", "polygon"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"testpoint", "[", 
    RowBox[{"poly_", ",", "pt_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Round", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "@", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "-", 
               RowBox[{"RotateRight", "[", "#", "]"}]}], ")"}], "&"}], "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"ArcTan", "@@", 
                RowBox[{"(", 
                 RowBox[{"pt", "-", "#"}], ")"}]}], "&"}], "/@", "poly"}], 
             ")"}]}], ",", 
           RowBox[{"2", " ", "Pi"}], ",", 
           RowBox[{"-", "Pi"}]}], "]"}]}], "/", "2"}], "/", "Pi"}], ")"}], 
     "]"}], "\[NotEqual]", "0"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7635624224713607`*^9, 3.7635624330425425`*^9}, {
  3.763579666001822*^9, 3.7635796671075287`*^9}, {3.764541623441715*^9, 
  3.764541692274987*^9}, {3.7645417401984043`*^9, 3.764541752748008*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"654311e6-0b2d-4a2d-8c50-8080c3715759"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "a", " ", "Nested", " ", "list", " ", "of", " ", "pair", 
    " ", "of", " ", "points", " ", "representing", " ", "each", " ", "line", 
    " ", "in", " ", "polygon"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lineList", "[", "list_", "]"}], ":=", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"list", ",", 
        RowBox[{"First", "[", "list", "]"}]}], "]"}], ",", "2", ",", "1"}], 
     "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.760802532026407*^9, 3.7608026249231467`*^9}, {
  3.760802678975656*^9, 3.760802687697389*^9}, {3.760803348506281*^9, 
  3.760803349726018*^9}},
 CellLabel->"In[3]:=",
 CellID->141966600,ExpressionUUID->"0abaafe1-1692-4abd-a612-8fecc555de3d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "a", " ", "Vector", " ", "for", " ", "a", " ", "line", " ",
     "between", " ", "two", " ", "points"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vector", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x2", "-", "x1"}], ",", 
     RowBox[{"y2", "-", "y1"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7584068810924025`*^9, 3.75840691133554*^9}, 
   3.7585649723581924`*^9, 3.7590244926122665`*^9, {3.761068203338044*^9, 
   3.761068204944496*^9}, {3.7610689112909594`*^9, 3.761068916365572*^9}},
 CellLabel->"In[4]:=",
 CellID->126976910,ExpressionUUID->"bc6165a8-e3eb-4ba3-9d0d-4b9234310cdb"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertexList", "[", "list_", "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"list", ",", 
      RowBox[{"list", "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], "]"}], ",", "3",
     ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7632217125289803`*^9, 3.76322172258762*^9}, {
   3.7632255886478095`*^9, 3.7632255905058174`*^9}, {3.7632256227611103`*^9, 
   3.763225629488167*^9}, 3.7632256596711035`*^9, {3.7632257080789433`*^9, 
   3.76322578038266*^9}, {3.7632272291279907`*^9, 3.763227236570083*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"e527fa4b-fe74-4a3b-9430-18bf68e4c0ff"],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleSortCond", "[", 
   RowBox[{"point_", ",", "l1_", ",", "l2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"getAngle", "[", 
        RowBox[{"{", 
         RowBox[{"point", ",", 
          RowBox[{
          "l1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}]}], ",", 
      RowBox[{"b", "=", 
       RowBox[{"getAngle", "[", 
        RowBox[{"{", 
         RowBox[{"point", ",", 
          RowBox[{
          "l2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}]}], ",", 
      RowBox[{"c", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{"point", "-", 
         RowBox[{
         "l1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ",", 
      RowBox[{"d", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{"point", "-", 
         RowBox[{
         "l2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "<", "b"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[Equal]", "b"}], " ", "&&", " ", 
       RowBox[{"c", "<", "d"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.764968817029722*^9, 3.7649688201477723`*^9}, {
   3.7649694483335238`*^9, 3.764969488981026*^9}, 3.7649695508222656`*^9, {
   3.76539679410841*^9, 3.7653968235457196`*^9}, {3.765396939734459*^9, 
   3.765396945972781*^9}, {3.765410610607728*^9, 3.765410708330372*^9}, {
   3.7654107384698524`*^9, 3.765410748751981*^9}, {3.767112538244009*^9, 
   3.7671125609383097`*^9}, {3.7671126086995125`*^9, 3.767112630570035*^9}, {
   3.767112667798407*^9, 3.767112791816635*^9}, {3.7671128295816565`*^9, 
   3.7671128382583942`*^9}, {3.767112875834901*^9, 3.767112886280945*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"0ae50e1e-ae69-431e-b7aa-7505422ab6ba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{" ", 
     RowBox[{"Returns", " ", "the", " ", "angle", " ", "made", " ", 
      RowBox[{"in", " ", "[", 
       RowBox[{"o", ",", 
        RowBox[{"2", "Pi"}]}]}]}], ")"}], " ", "Range"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Reference", ":", " ", "https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "111629"}], "/", "calculating"}], "-", "the", "-",
      "angle", "-", "between", "-", "the", "-", "line", "-", "joining", "-", 
     "two", "-", "points", "-", "and", "-", "the", "-", "x", "-", "axis"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getAngle", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"x2", "-", "x1"}], ",", 
       RowBox[{"y2", "-", "y1"}]}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.762211812183926*^9, 3.762211812227189*^9}, {
  3.762212133389465*^9, 3.7622121673627377`*^9}, {3.762212462429222*^9, 
  3.762212464180242*^9}, {3.7622125740765963`*^9, 3.7622125761070414`*^9}, {
  3.762212606447076*^9, 3.7622126078563104`*^9}, {3.762212782962586*^9, 
  3.762212784950568*^9}, {3.7622129567595778`*^9, 3.762212959837753*^9}, {
  3.7622138703932433`*^9, 3.7622138731561513`*^9}, {3.762393097385004*^9, 
  3.7623931256973104`*^9}, {3.762393422476513*^9, 3.762393430482111*^9}, {
  3.7623938017506027`*^9, 3.7623938052821507`*^9}, {3.76239386930202*^9, 
  3.7623938920402184`*^9}, {3.7623940390591536`*^9, 3.7623940446881514`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"a94cad22-fc66-46ee-b05c-9851fb713d8a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "parametric", " ", "equation", " ", "of", " ", "the", " ", 
     "line", " ", "containing", " ", "the", " ", "points", " ", 
     FormBox["a",
      TraditionalForm], " ", "and", " ", 
     FormBox["b",
      TraditionalForm], " ", "is", " ", 
     FormBox[
      RowBox[{"a", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"(", 
         RowBox[{"b", "-", "a"}], ")"}]}]}],
      TraditionalForm]}], ",", " ", 
    RowBox[{"where", " ", 
     FormBox[
      RowBox[{"0", "\[LessEqual]", "\[Lambda]", "\[LessEqual]", "1"}],
      TraditionalForm], " ", "for", " ", "points", " ", "between", " ", 
     FormBox["a",
      TraditionalForm], " ", "and", " ", 
     RowBox[{
      FormBox["b",
       TraditionalForm], ".", " ", "The"}], " ", "value", " ", "of", " ", 
     FormBox["\[Lambda]",
      TraditionalForm], " ", "is", " ", "given", " ", "by"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], "]"}], "[", "p_", "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "p"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}]}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.4281084522943907`*^9, 3.428108457088719*^9}, 
   3.4281085989154177`*^9, {3.428109418727551*^9, 3.428109419857239*^9}, {
   3.428117842316123*^9, 3.4281178428869658`*^9}, {3.4281179104322577`*^9, 
   3.428117911200409*^9}, 3.4281192939076843`*^9, {3.428145787108582*^9, 
   3.4281457888069077`*^9}, {3.50090385468817*^9, 3.5009038573034554`*^9}, {
   3.761605768653043*^9, 3.7616057689312773`*^9}, 3.761605910628242*^9, {
   3.7626542824215937`*^9, 3.7626542886133804`*^9}, {3.7626543313306875`*^9, 
   3.762654333925927*^9}, {3.7653973817649574`*^9, 3.7653973922519383`*^9}},
 CellLabel->"In[8]:=",
 CellID->91357628,ExpressionUUID->"8a8ad7de-6be8-4fbc-8099-f307bed2b049"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", 
     FormBox["p",
      TraditionalForm], " ", "on", " ", "the", " ", 
     RowBox[{"line", ".", " ", "For"}], " ", 
     FormBox["p",
      TraditionalForm], " ", "not", " ", "on", " ", "the", " ", "line"}], ",",
     " ", 
    RowBox[{
     FormBox["\[Lambda]",
      TraditionalForm], " ", "gives", " ", "the", " ", "closest", " ", 
     "point", " ", "on", " ", "the", " ", 
     RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Two", " ", "lines"}], ",", " ", 
    RowBox[{
     SubscriptBox["L", 
      RowBox[{"1", " "}]], "containing", " ", "the", " ", "points", " ", "a", 
     " ", "and", " ", "b", " ", "with", " ", "line", " ", 
     FormBox[
      SubscriptBox["L", "2"],
      TraditionalForm], " ", "containing", " ", "the", " ", "points", " ", 
     FormBox["c",
      TraditionalForm], " ", "and", " ", 
     FormBox["d",
      TraditionalForm]}], ",", " ", 
    RowBox[{"intersect", " ", "at", " ", "a", " ", 
     RowBox[{
      RowBox[{"point", " ", "\[DoubleLongLeftRightArrow]", " ", 
       FormBox[
        RowBox[{
         FormBox[
          TagBox[
           RowBox[{"\[LeftBracketingBar]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "-", "b"}], ",", 
              RowBox[{"c", "-", "d"}]}], "}"}], "\[RightBracketingBar]"}],
           {Det}],
          TraditionalForm], "\[NotEqual]", "0"}],
        TraditionalForm]}], ".", "  ", "Compute"}], " ", "the", " ", 
     "intersection", " ", 
     RowBox[{"point", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LineIntersectionPoint", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c_", ",", "d_"}], "}"}]}], "}"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Det", "[", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"c", "-", "d"}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"Det", "[", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"a", "-", "b"}], ")"}]}]}], 
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "-", "b"}], ",", 
       RowBox[{"c", "-", "d"}]}], "}"}], "]"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.4281084522943907`*^9, 3.428108457088719*^9}, 
   3.4281085989154177`*^9, {3.428109418727551*^9, 3.428109419857239*^9}, {
   3.428117842316123*^9, 3.4281178428869658`*^9}, {3.4281179104322577`*^9, 
   3.428117911200409*^9}, 3.4281192939076843`*^9, {3.428145787108582*^9, 
   3.4281457888069077`*^9}, {3.50090385468817*^9, 3.5009038573034554`*^9}, {
   3.5009039001263857`*^9, 3.500903903357723*^9}, 3.500904008130921*^9, {
   3.5009048198824835`*^9, 3.50090482194969*^9}, {3.7616057550025682`*^9, 
   3.7616057609376574`*^9}, 3.7646110289073915`*^9},
 CellLabel->"In[9]:=",
 CellID->1379934535,ExpressionUUID->"8ccb9948-d2ba-4e9c-a2aa-06880e78e44f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Use", " ", 
    FormBox[
     RowBox[{
      FormBox[
       TagBox[
        RowBox[{"\[LeftBracketingBar]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "-", "b"}], ",", 
           RowBox[{"c", "-", "d"}]}], "}"}], "\[RightBracketingBar]"}],
        {Det}],
       TraditionalForm], "\[NotEqual]", "0"}],
     TraditionalForm], " ", "along", " ", "with", " ", "the", " ", 
    "condition", " ", 
    FormBox[
     RowBox[{"0", "\[LessEqual]", "\[Lambda]", "\[LessEqual]", "1"}],
     TraditionalForm], " ", "to", " ", "determine", " ", "whether", " ", 
    "two", " ", "segments", " ", 
    RowBox[{"intersect", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SegmentIntersectionQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"c_", ",", "d_"}], "}"}]}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{",", "endpoints_"}], "*)"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Chop", "@", 
        RowBox[{"Det", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "-", "b"}], ",", 
           RowBox[{"c", "-", "d"}]}], "}"}], "]"}]}], "\[Equal]", "0"}], ",", 
      "False", ",", "\[IndentingNewLine]", 
      RowBox[{"Module", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p", "=", 
          RowBox[{"Round", "[", 
           RowBox[{
            RowBox[{"LineIntersectionPoint", "[", 
             RowBox[{"{", 
              RowBox[{"p1", ",", "p2"}], "}"}], "]"}], ",", "0.0000001"}], 
           "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"0", "<", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", "p1", "]"}], "[", "p", "]"}], "<", 
            "1"}], ")"}], " ", "&&", 
          RowBox[{"(", 
           RowBox[{"0", "<", 
            RowBox[{
             RowBox[{"\[Lambda]", "[", "p2", "]"}], "[", "p", "]"}], "<", 
            "1"}], ")"}], "&&", " ", 
          RowBox[{"Not", "@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"p", "\[Equal]", " ", 
              RowBox[{"Round", "[", 
               RowBox[{"a", ",", "0.0000001"}], "]"}]}], "||", "  ", 
             RowBox[{"p", "\[Equal]", " ", 
              RowBox[{"Round", "[", 
               RowBox[{"b", " ", ",", "0.0000001"}], "]"}]}], "||", "  ", 
             RowBox[{"p", "\[Equal]", " ", 
              RowBox[{"Round", "[", 
               RowBox[{"c", ",", "0.0000001"}], "]"}]}], "||", "  ", 
             RowBox[{"p", "\[Equal]", 
              RowBox[{"Round", "[", 
               RowBox[{"d", ",", "0.0000001"}], "]"}]}]}], ")"}]}]}], ")"}]}],
        " ", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "made", " ", "a", "  ", "change", " ", "in", " ", "the", " ", 
      "condition", " ", "to", " ", "ignore", " ", "the", " ", "end", " ", 
      "points", " ", 
      RowBox[{"i", ".", "e"}], " ", "return", " ", "false", " ", "if", " ", 
      "p"}], " ", "\[Equal]", " ", 
     RowBox[{"end", " ", "points", " ", "and", " ", 
      RowBox[{"chop", "@", "p"}]}]}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4281120146814823`*^9, 3.428112038173441*^9}, {
   3.4281156218433657`*^9, 3.428115623999099*^9}, {3.428117226280767*^9, 
   3.428117227670485*^9}, {3.428117869609064*^9, 3.428117887706465*^9}, 
   3.428117957558598*^9, {3.4281190826590567`*^9, 3.4281190913794613`*^9}, {
   3.42811912287589*^9, 3.428119141904117*^9}, {3.4281191810207863`*^9, 
   3.4281191816062098`*^9}, {3.428120493598702*^9, 3.428120496943215*^9}, {
   3.428145791126446*^9, 3.428145800901572*^9}, {3.500889749371381*^9, 
   3.500889800208735*^9}, 3.5009034278288603`*^9, 3.5009038327477703`*^9, {
   3.500904329717358*^9, 3.5009043324100313`*^9}, {3.7615783582430353`*^9, 
   3.7615783608420687`*^9}, {3.7615784098649197`*^9, 
   3.7615784623365545`*^9}, {3.7615785340138035`*^9, 
   3.7615785412933445`*^9}, {3.761578623094496*^9, 3.7615786263358383`*^9}, {
   3.761578699864112*^9, 3.761578746837474*^9}, {3.7616057453114967`*^9, 
   3.761605746258957*^9}, {3.7626536723509507`*^9, 3.762653677816164*^9}, {
   3.762653926453739*^9, 3.762653928787074*^9}, {3.7626541830724773`*^9, 
   3.7626542003908863`*^9}, {3.7635775164198837`*^9, 
   3.7635775259739723`*^9}, {3.7635778270623765`*^9, 3.763577836000063*^9}, {
   3.7635790725384912`*^9, 3.763579190961801*^9}, {3.7635792381035557`*^9, 
   3.763579242357274*^9}, {3.763579365272222*^9, 3.7635794041264677`*^9}, {
   3.7635794875724025`*^9, 3.7635794883617067`*^9}, {3.7635806648743563`*^9, 
   3.763580686258615*^9}, {3.7635808515727286`*^9, 3.763580898507636*^9}, {
   3.7635816496363373`*^9, 3.7635817073519993`*^9}, {3.7638247263347735`*^9, 
   3.763824737539774*^9}, {3.7638248118710976`*^9, 3.7638248133341866`*^9}, {
   3.763824880121635*^9, 3.763824950105522*^9}, {3.763915916540468*^9, 
   3.7639159694889126`*^9}, {3.763916431909709*^9, 3.763916444728441*^9}, {
   3.7646846348426485`*^9, 3.7646846694980593`*^9}, {3.7646849520400696`*^9, 
   3.764684974069209*^9}, {3.7646879506379757`*^9, 3.764687978064746*^9}, {
   3.7646882242530756`*^9, 3.76468822925671*^9}, {3.765393656785784*^9, 
   3.7653936762842746`*^9}, {3.7653956196574183`*^9, 3.76539563686759*^9}, {
   3.7653959660144067`*^9, 3.7653959897580557`*^9}, {3.7653974058276978`*^9, 
   3.765397456765642*^9}, {3.765407350847313*^9, 3.7654073645559006`*^9}, {
   3.7654148839318104`*^9, 3.765415084507468*^9}, {3.7654154619835644`*^9, 
   3.765415512328901*^9}, {3.7654155496778045`*^9, 3.765415561186323*^9}, {
   3.76541563077349*^9, 3.7654156389921713`*^9}, {3.765415675423483*^9, 
   3.7654156766741476`*^9}, {3.7654160373306355`*^9, 3.765416045616802*^9}, {
   3.7654162204037886`*^9, 3.765416225909351*^9}, {3.765416261748746*^9, 
   3.7654162719708166`*^9}, {3.7654239425113354`*^9, 3.76542402025681*^9}, {
   3.7654240605261145`*^9, 3.765424076779188*^9}, {3.76542415841739*^9, 
   3.765424186235385*^9}, {3.765424239584928*^9, 3.7654242571113424`*^9}},
 CellLabel->"In[10]:=",
 CellID->1016457520,ExpressionUUID->"d286e39e-8748-45a6-84d6-96004e63c4d1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"distSortCond", "[", 
   RowBox[{"line_", ",", "l1_", ",", "l2_", ",", "point_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"EuclideanDistance", "[", 
        RowBox[{
         RowBox[{"LineIntersectionPoint", "[", 
          RowBox[{"Chop", "@", 
           RowBox[{"{", 
            RowBox[{"line", ",", "l1"}], "}"}]}], "]"}], ",", "point"}], 
        "]"}]}], ",", 
      RowBox[{"b", "=", 
       RowBox[{"EuclideanDistance", "[", 
        RowBox[{
         RowBox[{"LineIntersectionPoint", "[", 
          RowBox[{"Chop", "@", 
           RowBox[{"{", 
            RowBox[{"line", ",", "l2"}], "}"}]}], "]"}], ",", "point"}], 
        "]"}]}]}], "}"}], ",", 
    RowBox[{"a", "<", "b"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7649691805534678`*^9, 3.764969292155766*^9}, {
  3.764969432467591*^9, 3.7649694409428687`*^9}, {3.764969479992117*^9, 
  3.7649694909523163`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"7232f82a-ae5c-4c32-ae31-39d0576ff4af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "True", " ", "if", " ", "w2", " ", "is", " ", "Interior", " ", "vertex", 
    " ", "from", " ", "p"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"intersectInteriorQRev2", "[", 
     RowBox[{"p_", ",", 
      RowBox[{"{", 
       RowBox[{"w1_", ",", "w2_", ",", "w3_"}], "}"}]}], "]"}], ":=", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"getClockwiseAngle", "[", 
      RowBox[{"w1", ",", "w2", ",", "w3"}], "]"}], ">", " ", 
     RowBox[{"getClockwiseAngle", "[", 
      RowBox[{"p", ",", "w2", ",", "w3"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Clockwise", " ", "angle", " ", "bwtween", " ", "tw", " ", "o", " ", 
     "vectors"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"adndevblog", ".", "typepad", ".", "com"}], "/", 
          "manufacturing"}], "/", "2012"}], "/", "07"}], "/", "finding"}], 
      "-", "the", "-", "angle", "-", "between", "-", "two", "-", "vectors", 
      "-", "along", "-", "a", "-", "given", "-", "direction", "-", "anti", 
      "-", "clockwise", "-", "or", "-", 
      RowBox[{"clockwise", ".", "html"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getClockwiseAngle", "[", 
     RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"(", 
          RowBox[{"p3", "-", "p2"}], ")"}]}], ",", 
        RowBox[{"b", "=", 
         RowBox[{"(", 
          RowBox[{"p1", "-", "p2"}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"a", ",", "0"}], "]"}], ";", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"b", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cross", "[", 
             RowBox[{"a", ",", "b"}], "]"}], "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}], ")"}], "<", "0"}], ",", 
         RowBox[{"Chop", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "Pi"}], " ", "-", 
            RowBox[{"VectorAngle", "[", 
             RowBox[{"a", ",", "b"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"Chop", "@", 
          RowBox[{"VectorAngle", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}]}], "]"}]}]}], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7632417874795303`*^9, {3.763241834836933*^9, 3.7632420185773973`*^9}, {
   3.763242074854607*^9, 3.763242077918415*^9}, {3.763242112617639*^9, 
   3.763242124713317*^9}, {3.7632422161269245`*^9, 3.76324230355222*^9}, {
   3.763242734899631*^9, 3.763242892686514*^9}, {3.7632429774279547`*^9, 
   3.763243073933981*^9}, {3.763243226964872*^9, 3.763243464738119*^9}, {
   3.7632444349829597`*^9, 3.7632445753932333`*^9}, {3.764528219689684*^9, 
   3.7645282201844997`*^9}, {3.7654119561001654`*^9, 
   3.7654119563453193`*^9}, {3.7654119989827805`*^9, 
   3.7654120057366543`*^9}, {3.7654123322896976`*^9, 
   3.7654123343788958`*^9}, {3.765412365173065*^9, 3.7654123863739414`*^9}, {
   3.765412451318892*^9, 3.7654125423451333`*^9}, {3.765412658894041*^9, 
   3.7654127021985235`*^9}, {3.765412740072564*^9, 3.7654128111665483`*^9}, {
   3.765412978299034*^9, 3.7654129838292217`*^9}, {3.7654130179461584`*^9, 
   3.7654131257825747`*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"5af8c4a3-59e7-4420-b35d-5b89b91426cf"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointOnSegmentQ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x3_", ",", "y3_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ABv", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x2", "-", "x1"}], ",", 
         RowBox[{"y2", "-", "y1"}], ",", "0"}], "}"}]}], ",", 
      RowBox[{"ACv", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x3", "-", "x1"}], ",", 
         RowBox[{"y3", "-", "y1"}], ",", "0"}], "}"}]}], ",", "Kac", ",", 
      "Kab"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Chop", "@", "#"}], "\[Equal]", "0"}], ")"}], "&"}], "/@", 
         RowBox[{"Cross", "[", 
          RowBox[{"ABv", ",", "ACv"}], "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Kac", "=", 
        RowBox[{"(", 
         RowBox[{"ABv", ".", "ACv"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Kab", "=", 
        RowBox[{"(", 
         RowBox[{"ABv", ".", "ABv"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Kac", "<", " ", "0"}], ",", "False", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Kac", ">", "Kab"}], ",", "False", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"0", "<", " ", "Kac", "<", "Kab"}], ",", "True", ",", 
             "False"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ",",
       "False"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7626994408605223`*^9, 3.7626994957070084`*^9}, {
   3.7626995310477943`*^9, 3.762699587109696*^9}, {3.7626997083021026`*^9, 
   3.762699712423989*^9}, {3.7626997510556707`*^9, 3.7626997554851513`*^9}, {
   3.7626997952220106`*^9, 3.7626998738837285`*^9}, 3.762699908937931*^9, {
   3.7626999424881754`*^9, 3.762700278668273*^9}, {3.7627003185755424`*^9, 
   3.762700395534641*^9}, {3.7627004795581913`*^9, 3.7627007245802183`*^9}, {
   3.762700775106859*^9, 3.762700996176547*^9}, {3.762701026237877*^9, 
   3.7627011139799204`*^9}, {3.762701163207965*^9, 3.762701222995221*^9}, 
   3.7627012553188334`*^9, {3.7627013084762263`*^9, 3.7627013109520063`*^9}, 
   3.7645200742116685`*^9, {3.7645205722197084`*^9, 3.7645206536940107`*^9}, 
   3.7649910836569967`*^9, {3.764991133396474*^9, 3.764991190953382*^9}, {
   3.7649912752832913`*^9, 3.7649912807513027`*^9}, {3.7649913237317915`*^9, 
   3.7649913265930767`*^9}, 3.764991376340988*^9, {3.7654138107436743`*^9, 
   3.7654138773935146`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"039a91da-4e9d-467e-b3fa-094cbe6368de"],

Cell[BoxData[
 RowBox[{
  RowBox[{"glancingBlow", "[", 
   RowBox[{"a_", ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Xor", "[", 
   RowBox[{
    RowBox[{"reflex", "[", 
     RowBox[{"p1", ",", "p2", ",", "a"}], "]"}], ",", " ", 
    RowBox[{"reflex", "[", 
     RowBox[{"p3", ",", "p2", ",", "a"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[15]:=",ExpressionUUID->"b895f199-a363-46a0-b318-2cee20ae9927"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Function", " ", "Gives", " ", "whether", " ", "a", " ", "point", " ", 
     "is", " ", "reflex", " ", "or", " ", "not"}], ",", " ", 
    RowBox[{
    "Chop", " ", "is", " ", "used", " ", "to", " ", "round", " ", "of", " ", 
     "to", " ", "the", " ", "nearest", " ", 
     RowBox[{"integer", ".", " ", "From"}], " ", "Motion", " ", "Plannning", 
     " ", "Book", " ", "by", " ", "Steven", " ", 
     RowBox[{"M", ".", "LaValle"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"reflex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x3_", ",", "y3_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{"Det", "[", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "x1", "y1"},
         {"1", "x2", "y2"},
         {"1", "x3", "y3"}
        }], "\[NoBreak]", ")"}], "]"}], "]"}], ">", "  ", "0", 
    "  "}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.755908815855939*^9, 3.7559088459664335`*^9}, {
   3.755947005882975*^9, 3.755947061346826*^9}, {3.7559498333751707`*^9, 
   3.755949914995143*^9}, {3.755950054536367*^9, 3.755950065385194*^9}, {
   3.755950151887475*^9, 3.755950153163884*^9}, {3.755993678293873*^9, 
   3.7559937695215335`*^9}, {3.755993810855974*^9, 3.755993812877569*^9}, {
   3.757607439289873*^9, 3.757607439746631*^9}, {3.757609238931039*^9, 
   3.7576094670480924`*^9}, {3.757609498202787*^9, 3.7576094995541916`*^9}, {
   3.7576096406448946`*^9, 3.7576096476861033`*^9}, 3.7576101114820843`*^9, {
   3.7579840705646143`*^9, 3.757984078389755*^9}, {3.7579841540840235`*^9, 
   3.7579841568937693`*^9}, {3.757984225784856*^9, 3.757984226849011*^9}, 
   3.7579857383484926`*^9, {3.75798576993006*^9, 3.757985783572551*^9}, {
   3.7649905481590557`*^9, 3.7649905483025436`*^9}, {3.764990652657299*^9, 
   3.7649906536945343`*^9}, {3.7654213131587653`*^9, 
   3.7654213137502046`*^9}, {3.7654213437899475`*^9, 
   3.7654213447264495`*^9}, {3.765421884884285*^9, 3.7654219510256577`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"2d44fd72-a3de-423d-b141-9916ac3c1f6c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"extendedLine", "[", 
   RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"p1", ",", 
    RowBox[{"(", 
     RowBox[{"p1", "+", 
      RowBox[{"40", 
       RowBox[{"(", 
        RowBox[{"Normalize", "@", 
         RowBox[{"(", 
          RowBox[{"(", 
           RowBox[{"p2", "-", "p1"}], ")"}], ")"}]}], ")"}]}]}], ")"}]}], 
   "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7641218415977955`*^9, 3.764122022382304*^9}, {
   3.7641221162104654`*^9, 3.764122132710537*^9}, {3.7641221636645036`*^9, 
   3.7641221922742877`*^9}, {3.7641222862234545`*^9, 3.764122331904281*^9}, {
   3.764122375447214*^9, 3.764122385145474*^9}, {3.7641224344867697`*^9, 
   3.764122498310034*^9}, {3.7641225535676827`*^9, 3.764122651469599*^9}, {
   3.764122814305434*^9, 3.764122825417222*^9}, {3.7641231859448366`*^9, 
   3.7641232221201153`*^9}, {3.764123258070859*^9, 3.764123316119299*^9}, {
   3.7641233778481555`*^9, 3.7641234835794106`*^9}, {3.764123519577031*^9, 
   3.7641235726186304`*^9}, {3.764123632314707*^9, 3.7641236570526123`*^9}, {
   3.7641236956009617`*^9, 3.7641236962849665`*^9}, {3.7641237312602797`*^9, 
   3.7641238330080233`*^9}, {3.7641241597766495`*^9, 3.764124170564658*^9}, {
   3.7641244780586357`*^9, 3.7641245082752323`*^9}, 3.76412453881781*^9, {
   3.7641247699480467`*^9, 3.7641247714249496`*^9}, {3.7641248023419237`*^9, 
   3.7641248119852066`*^9}, {3.7641249132016044`*^9, 3.7641249564216557`*^9}, 
   3.7641249920445623`*^9, {3.7641250463524766`*^9, 3.764125064005801*^9}, {
   3.764125118256483*^9, 3.764125161108537*^9}, {3.7641662919246964`*^9, 
   3.76416630005577*^9}, {3.764166432499324*^9, 3.764166447091194*^9}, {
   3.7641665073455615`*^9, 3.7641665664708166`*^9}, {3.7641666054803967`*^9, 
   3.7641666421068535`*^9}, {3.7641821050636377`*^9, 3.764182116270735*^9}, 
   3.7641821505544543`*^9, {3.764182246151062*^9, 3.764182246247776*^9}, {
   3.7649898550624084`*^9, 3.764989856524984*^9}, {3.765416576202439*^9, 
   3.765416700389082*^9}, {3.7654197577399917`*^9, 3.765419796549307*^9}, {
   3.7654214508499084`*^9, 3.765421484052185*^9}, {3.7654216224863615`*^9, 
   3.7654216839878235`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"c27e09b4-e1b9-495c-a283-dac5039b6365"],

Cell[BoxData[
 RowBox[{
  RowBox[{"leftOrRight", "[", 
   RowBox[{
    RowBox[{"a", ":", 
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
    RowBox[{"b", ":", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}]}], ",", 
    RowBox[{"p", ":", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"x", "\[Minus]", "x1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"y2", "\[Minus]", "y1"}], ")"}]}], "\[Minus]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"y", "\[Minus]", "y1"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"x2", "\[Minus]", "x1"}], ")"}]}]}], ")"}], "\[GreaterEqual]", 
   "  ", "0"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7697928298279767`*^9, 3.7697929276026454`*^9}, {
  3.769792957738123*^9, 3.7697929898692102`*^9}, {3.769793051326936*^9, 
  3.76979306093027*^9}, {3.7697953321587353`*^9, 3.769795332642446*^9}, {
  3.769795392106507*^9, 3.7697953922610903`*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"ee70ffa4-70e0-45ee-b6df-b71e38d084d0"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.769801928851533*^9, 
  3.7698019388478155`*^9}},ExpressionUUID->"df89d1c1-29fd-4de6-a8d4-\
b00c25e28eaa"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"3\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,50,1094,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7698507248838882`*^9},ExpressionUUID->"69abfecd-7494-440d-b7d7-\
7512814b530f"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"4\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,50,1095,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850724942062*^9},ExpressionUUID->"bb127111-622b-4269-b7a3-\
f1cd364565a1"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"5\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,50,1096,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850724992489*^9},ExpressionUUID->"cb822315-1db9-4f94-9e6a-\
a3e36256edc5"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,50,1097,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850725043951*^9},ExpressionUUID->"23802e46-c36c-40f0-9d93-\
f26cb4d7d55d"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}], \\\")\\\"}], \\\"\[LeftDoubleBracket]\\\", \\\
\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,50,1098,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.76985072509692*^9},ExpressionUUID->"a0ebc5d8-9abf-413f-940d-32eeb3ba8a6c"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}], \\\")\\\"}], \\\"\[LeftDoubleBracket]\\\", \\\
\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,50,1099,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850725150277*^9},ExpressionUUID->"c138f18c-af93-4d56-8779-\
8ccf85789070"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}], \\\")\\\"}], \\\"\[LeftDoubleBracket]\\\", \\\
\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,50,1100,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7698507252041407`*^9},ExpressionUUID->"c7f92b4d-5e46-4e3a-bb97-\
29e6399af5f3"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,50,1101,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850725308064*^9},ExpressionUUID->"519c7bff-f809-4b3d-9e35-\
05ab428015e5"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"3\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,51,1318,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7698508017002974`*^9},ExpressionUUID->"2edae1b8-a55e-4d39-bd54-\
13e969e6a251"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"4\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,51,1319,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850801734434*^9},ExpressionUUID->"f35fc0d9-ffee-4a85-b644-\
1a0e7a825ca5"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"5\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,51,1320,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850801785095*^9},ExpressionUUID->"589e73cc-64f4-495d-a8c0-\
3f3b0f590810"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,51,1321,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7698508018371677`*^9},ExpressionUUID->"46c560c2-a877-4cf5-bb6b-\
a5aefc918bc0"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}], \\\")\\\"}], \\\"\[LeftDoubleBracket]\\\", \\\
\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,51,1322,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850801888323*^9},ExpressionUUID->"e8abfa34-f9be-4c60-a860-\
889c7b88ae47"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}], \\\")\\\"}], \\\"\[LeftDoubleBracket]\\\", \\\
\"1\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,51,1323,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7698508019427643`*^9},ExpressionUUID->"cb95cb2d-ec91-4670-9ed1-\
e0c2b68f33e8"],

Cell[BoxData[
 TemplateBox[{
  "Part","partd",
   "\"Part specification \\!\\(\\*RowBox[{RowBox[{\\\"(\\\", \
RowBox[{\\\"-\\\", \\\"1\\\"}], \\\")\\\"}], \\\"\[LeftDoubleBracket]\\\", \\\
\"2\\\", \\\"\[RightDoubleBracket]\\\"}]\\) is longer than depth of \
object.\"",2,51,1324,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850801997184*^9},ExpressionUUID->"23428565-cbbd-4bed-8f44-\
7d832f802b6e"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partd\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,51,1325,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850802047463*^9},ExpressionUUID->"315fcc1c-85f5-408d-8783-\
46ad0fa69e3e"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"3\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,52,1422,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850837143208*^9},ExpressionUUID->"c9533fa1-3d22-41ac-a5a3-\
72c244eb2a92"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"4\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,52,1423,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850837206544*^9},ExpressionUUID->"9ff4041c-555c-4461-858a-\
9d728e1485de"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"5\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,52,1424,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850837257601*^9},ExpressionUUID->"e7685460-9e1a-4686-a706-\
aa30513cf71f"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,52,1425,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850837308165*^9},ExpressionUUID->"0833ea7c-0cb4-40f7-addc-\
2d9e1bdf80eb"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"3\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,53,1550,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.76985086364777*^9},ExpressionUUID->"82ad41f9-2538-4c65-bd42-4605074247bd"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"4\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,53,1551,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7698508637011967`*^9},ExpressionUUID->"69edee8e-66d4-4668-abb5-\
1c3999a88674"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"5\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,53,1552,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7698508637521143`*^9},ExpressionUUID->"0678b111-ae17-4d12-842a-\
d006cae816b9"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,53,1553,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7698508638099413`*^9},ExpressionUUID->"89ffffca-eef9-486c-aa90-\
2990d841d349"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"3\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,54,1646,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850876045793*^9},ExpressionUUID->"5aff6d7d-99ac-4d92-af45-\
50b5713b1d3f"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"4\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,54,1647,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850876091535*^9},ExpressionUUID->"6f9ed0e9-e127-4137-8f66-\
c21ad4afff99"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"5\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,54,1648,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850876146837*^9},ExpressionUUID->"163141b5-afac-49fd-9baa-\
752f575e378a"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,54,1649,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850876198457*^9},ExpressionUUID->"af3c2f5b-e970-4276-98d3-\
d72857360521"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"3\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,55,1934,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.76985094929257*^9},ExpressionUUID->"8f3b8295-0138-454d-877f-73b96c615eb3"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"4\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,55,1935,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850949358337*^9},ExpressionUUID->"70b1c6ef-6bf4-4daa-b025-\
30e50b48ebfb"],

Cell[BoxData[
 TemplateBox[{
  "Part","partw",
   "\"Part \\!\\(\\*RowBox[{\\\"5\\\"}]\\) of \\!\\(\\*RowBox[{\\\"{\\\", \
RowBox[{RowBox[{\\\"{\\\", RowBox[{\\\"1\\\", \\\",\\\", \\\"0\\\"}], \\\"}\\\
\"}], \\\",\\\", RowBox[{\\\"{\\\", RowBox[{\\\"2\\\", \\\",\\\", \
\\\"2\\\"}], \\\"}\\\"}]}], \\\"}\\\"}]\\) does not exist.\"",2,55,1936,
   33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.769850949408079*^9},ExpressionUUID->"e4cb1a93-61de-4d49-97c0-\
62ed9716e1e9"],

Cell[BoxData[
 TemplateBox[{
  "General","stop",
   "\"Further output of \\!\\(\\*StyleBox[RowBox[{\\\"Part\\\", \\\"::\\\", \
\\\"partw\\\"}], \\\"MessageName\\\"]\\) will be suppressed during this \
calculation.\"",2,55,1937,33009364007402810294,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{
  3.7698509494645348`*^9},ExpressionUUID->"1b8676fd-74dd-4805-85b2-\
69f42bfec44d"]
}, Open  ]]
},
WindowSize->{1536, 791},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.55 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 17367, 399, 740, "Input",ExpressionUUID->"4b1e4c1e-ed26-4125-97e1-052f34df3a3d"],
Cell[17950, 423, 7723, 137, 736, "Output",ExpressionUUID->"b7531cdb-5371-4d81-9e3a-c3d985157ace"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25710, 565, 335, 9, 43, "Input",ExpressionUUID->"f5f12c5a-64ed-40f4-9242-ef7d383921cf"],
Cell[26048, 576, 208, 4, 50, "Output",ExpressionUUID->"35c96057-a024-4599-a3b9-3d8b860584bc"]
}, Open  ]],
Cell[26271, 583, 128, 1, 44, "Input",ExpressionUUID->"e32b32fa-366c-4519-b8ad-5bc9bc3f42e8"],
Cell[26402, 586, 24976, 583, 2347, "Input",ExpressionUUID->"27e2e2df-3c39-4f6b-95e4-036ec10f660d",
 InitializationCell->True],
Cell[51381, 1171, 1338, 36, 100, "Input",ExpressionUUID->"654311e6-0b2d-4a2d-8c50-8080c3715759",
 InitializationCell->True],
Cell[52722, 1209, 862, 21, 100, "Input",ExpressionUUID->"0abaafe1-1692-4abd-a612-8fecc555de3d",
 InitializationCell->True,
 CellID->141966600],
Cell[53587, 1232, 898, 23, 100, "Input",ExpressionUUID->"bc6165a8-e3eb-4ba3-9d0d-4b9234310cdb",
 InitializationCell->True,
 CellID->126976910],
Cell[54488, 1257, 732, 15, 69, "Input",ExpressionUUID->"e527fa4b-fe74-4a3b-9430-18bf68e4c0ff",
 InitializationCell->True],
Cell[55223, 1274, 1972, 49, 130, "Input",ExpressionUUID->"0ae50e1e-ae69-431e-b7aa-7505422ab6ba",
 InitializationCell->True],
Cell[57198, 1325, 2004, 47, 160, "Input",ExpressionUUID->"a94cad22-fc66-46ee-b05c-9851fb713d8a",
 InitializationCell->True],
Cell[59205, 1374, 2148, 55, 173, "Input",ExpressionUUID->"8a8ad7de-6be8-4fbc-8099-f307bed2b049",
 InitializationCell->True,
 CellID->91357628],
Cell[61356, 1431, 3156, 85, 203, "Input",ExpressionUUID->"8ccb9948-d2ba-4e9c-a2aa-06880e78e44f",
 InitializationCell->True,
 CellID->1379934535],
Cell[64515, 1518, 6411, 134, 250, "Input",ExpressionUUID->"d286e39e-8748-45a6-84d6-96004e63c4d1",
 InitializationCell->True,
 CellID->1016457520],
Cell[70929, 1654, 1107, 29, 130, "Input",ExpressionUUID->"7232f82a-ae5c-4c32-ae31-39d0576ff4af",
 InitializationCell->True],
Cell[72039, 1685, 3714, 89, 310, "Input",ExpressionUUID->"5af8c4a3-59e7-4420-b35d-5b89b91426cf",
 InitializationCell->True],
Cell[75756, 1776, 3096, 74, 310, "Input",ExpressionUUID->"039a91da-4e9d-467e-b3fa-094cbe6368de",
 InitializationCell->True],
Cell[78855, 1852, 518, 14, 100, "Input",ExpressionUUID->"b895f199-a363-46a0-b318-2cee20ae9927",
 InitializationCell->True],
Cell[79376, 1868, 2266, 47, 186, "Input",ExpressionUUID->"2d44fd72-a3de-423d-b141-9916ac3c1f6c",
 InitializationCell->True],
Cell[81645, 1917, 2284, 40, 69, "Input",ExpressionUUID->"c27e09b4-e1b9-495c-a283-dac5039b6365",
 InitializationCell->True],
Cell[83932, 1959, 1139, 32, 69, "Input",ExpressionUUID->"ee70ffa4-70e0-45ee-b6df-b71e38d084d0",
 InitializationCell->True],
Cell[CellGroupData[{
Cell[85096, 1995, 201, 4, 44, "Input",ExpressionUUID->"df89d1c1-29fd-4de6-a8d4-b00c25e28eaa"],
Cell[85300, 2001, 521, 11, 36, "Message",ExpressionUUID->"69abfecd-7494-440d-b7d7-7512814b530f"],
Cell[85824, 2014, 519, 11, 36, "Message",ExpressionUUID->"bb127111-622b-4269-b7a3-f1cd364565a1"],
Cell[86346, 2027, 519, 11, 36, "Message",ExpressionUUID->"cb822315-1db9-4f94-9e6a-a3e36256edc5"],
Cell[86868, 2040, 400, 9, 36, "Message",ExpressionUUID->"23802e46-c36c-40f0-9d93-f26cb4d7d55d"],
Cell[87271, 2051, 450, 9, 36, "Message",ExpressionUUID->"a0ebc5d8-9abf-413f-940d-32eeb3ba8a6c"],
Cell[87724, 2062, 453, 10, 36, "Message",ExpressionUUID->"c138f18c-af93-4d56-8779-8ccf85789070"],
Cell[88180, 2074, 455, 10, 36, "Message",ExpressionUUID->"c7f92b4d-5e46-4e3a-bb97-29e6399af5f3"],
Cell[88638, 2086, 400, 9, 36, "Message",ExpressionUUID->"519c7bff-f809-4b3d-9e35-05ab428015e5"],
Cell[89041, 2097, 521, 11, 36, "Message",ExpressionUUID->"2edae1b8-a55e-4d39-bd54-13e969e6a251"],
Cell[89565, 2110, 519, 11, 79, "Message",ExpressionUUID->"f35fc0d9-ffee-4a85-b644-1a0e7a825ca5"],
Cell[90087, 2123, 519, 11, 79, "Message",ExpressionUUID->"589e73cc-64f4-495d-a8c0-3f3b0f590810"],
Cell[90609, 2136, 402, 9, 79, "Message",ExpressionUUID->"46c560c2-a877-4cf5-bb6b-a5aefc918bc0"],
Cell[91014, 2147, 453, 10, 79, "Message",ExpressionUUID->"e8abfa34-f9be-4c60-a860-889c7b88ae47"],
Cell[91470, 2159, 455, 10, 79, "Message",ExpressionUUID->"cb95cb2d-ec91-4670-9ed1-e0c2b68f33e8"],
Cell[91928, 2171, 453, 10, 79, "Message",ExpressionUUID->"23428565-cbbd-4bed-8f44-7d832f802b6e"],
Cell[92384, 2183, 400, 9, 79, "Message",ExpressionUUID->"315fcc1c-85f5-408d-8783-46ad0fa69e3e"],
Cell[92787, 2194, 519, 11, 79, "Message",ExpressionUUID->"c9533fa1-3d22-41ac-a5a3-72c244eb2a92"],
Cell[93309, 2207, 519, 11, 79, "Message",ExpressionUUID->"9ff4041c-555c-4461-858a-9d728e1485de"],
Cell[93831, 2220, 519, 11, 79, "Message",ExpressionUUID->"e7685460-9e1a-4686-a706-aa30513cf71f"],
Cell[94353, 2233, 400, 9, 79, "Message",ExpressionUUID->"0833ea7c-0cb4-40f7-addc-2d9e1bdf80eb"],
Cell[94756, 2244, 516, 10, 79, "Message",ExpressionUUID->"82ad41f9-2538-4c65-bd42-4605074247bd"],
Cell[95275, 2256, 521, 11, 79, "Message",ExpressionUUID->"69edee8e-66d4-4668-abb5-1c3999a88674"],
Cell[95799, 2269, 521, 11, 79, "Message",ExpressionUUID->"0678b111-ae17-4d12-842a-d006cae816b9"],
Cell[96323, 2282, 402, 9, 79, "Message",ExpressionUUID->"89ffffca-eef9-486c-aa90-2990d841d349"],
Cell[96728, 2293, 519, 11, 79, "Message",ExpressionUUID->"5aff6d7d-99ac-4d92-af45-50b5713b1d3f"],
Cell[97250, 2306, 519, 11, 79, "Message",ExpressionUUID->"6f9ed0e9-e127-4137-8f66-c21ad4afff99"],
Cell[97772, 2319, 519, 11, 79, "Message",ExpressionUUID->"163141b5-afac-49fd-9baa-752f575e378a"],
Cell[98294, 2332, 400, 9, 79, "Message",ExpressionUUID->"af3c2f5b-e970-4276-98d3-d72857360521"],
Cell[98697, 2343, 516, 10, 79, "Message",ExpressionUUID->"8f3b8295-0138-454d-877f-73b96c615eb3"],
Cell[99216, 2355, 519, 11, 79, "Message",ExpressionUUID->"70b1c6ef-6bf4-4daa-b025-30e50b48ebfb"],
Cell[99738, 2368, 519, 11, 79, "Message",ExpressionUUID->"e4cb1a93-61de-4d49-97c0-62ed9716e1e9"],
Cell[100260, 2381, 402, 9, 79, "Message",ExpressionUUID->"1b8676fd-74dd-4805-85b2-69f42bfec44d"]
}, Open  ]]
}
]
*)

