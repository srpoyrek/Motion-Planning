(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    163626,       3767]
NotebookOptionsPosition[    159118,       3684]
NotebookOutlinePosition[    159491,       3700]
CellTagsIndexPosition[    159448,       3697]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"Manipulate", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"poly1", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "pts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "+", "#"}], ")"}], "&"}], "/@", 
         RowBox[{"CirclePoints", "[", "4", "]"}]}]}], ",", 
       RowBox[{"poly2", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
            "pts", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "+", "#"}], ")"}], "&"}], "/@", 
         RowBox[{"CirclePoints", "[", "3", "]"}]}]}], 
       RowBox[{"(*", 
        RowBox[{"polyi", " ", "are", " ", "moveable", " ", "obstacles"}], 
        "*)"}], "\[IndentingNewLine]", ",", 
       RowBox[{"bound", "=", 
        RowBox[{"(", 
         RowBox[{"5", "*", 
          RowBox[{"CirclePoints", "@", "4"}]}], ")"}]}], ",", 
       RowBox[{"invisiblePoly", "=", 
        RowBox[{"(", 
         RowBox[{"7", "*", 
          RowBox[{"CirclePoints", "@", "4"}]}], ")"}]}], 
       RowBox[{"(*", 
        RowBox[{"boundaries", " ", "of", " ", "the", " ", "workspace"}], 
        "*)"}], "\[IndentingNewLine]", ",", " ", 
       RowBox[{"cval", " ", "=", " ", 
        RowBox[{"ColorData", "[", 
         RowBox[{"100", ",", "\"\<ColorList\>\""}], "]"}]}], " ", 
       RowBox[{"(*", 
        RowBox[{
        "Colors", " ", "for", " ", "robots", " ", "and", " ", "the", " ", 
         "visible", " ", "regions"}], "*)"}], "\[IndentingNewLine]", ",", 
       "listofPoly"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "Only", " ", "recalculate", " ", "the", " ", "visible", " ", "region", 
       " ", "if", " ", "a", " ", "point", " ", "moves", " ", 
       RowBox[{"(", 
        RowBox[{
        "or", " ", "a", " ", "moveable", " ", "obstacle", " ", "moves"}], 
        ")"}], "\[IndentingNewLine]", "or", " ", "for", " ", "a", " ", "new", 
       " ", "point", " ", "added"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"listofPoly", "=", 
       RowBox[{"N", "@", 
        RowBox[{"(", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"reg", "\[Equal]", "\"\<Movable Obstacles\>\""}], ",", 
           RowBox[{"{", 
            RowBox[{
            "poly1", ",", "poly2", ",", "bound", ",", "invisiblePoly"}], 
            "}"}], "\[IndentingNewLine]", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"reg", "\[Equal]", "\"\<Irregular\>\""}], ",", 
             RowBox[{"{", 
              RowBox[{"irregularPoly", ",", "invisiblePoly"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"cubiclePoly", ",", "invisiblePoly"}], "}"}]}], "]"}]}],
           "]"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
            "pts", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "\[NotEqual]", " ", 
            RowBox[{
            "ptsOld", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}], "||", 
           RowBox[{
            RowBox[{
            "pts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
            "\[NotEqual]", " ", 
            RowBox[{
            "ptsOld", "\[LeftDoubleBracket]", "1", 
             "\[RightDoubleBracket]"}]}], "||", 
           RowBox[{
            RowBox[{
            "pts", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
            "\[NotEqual]", " ", 
            RowBox[{
            "ptsOld", "\[LeftDoubleBracket]", "2", 
             "\[RightDoubleBracket]"}]}], "||", " ", 
           RowBox[{"sOld", "<", 
            RowBox[{"i", "-", "2"}]}], "||", 
           RowBox[{"prevReg", "\[NotEqual]", "reg"}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"visibleRegion", "\[LeftDoubleBracket]", 
             RowBox[{"i", "-", "2"}], "\[RightDoubleBracket]"}], "=", 
            RowBox[{"visiblePolysRev3", "[", 
             RowBox[{"listofPoly", ",", 
              RowBox[{
              "pts", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
              "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
            "ptsOld", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            "=", 
            RowBox[{
            "pts", "\[LeftDoubleBracket]", "i", 
             "\[RightDoubleBracket]"}]}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "3", ",", 
          RowBox[{"s", "+", "2"}]}], "}"}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"update", " ", "the", " ", "Old", " ", "variables"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
          "pts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "\[NotEqual]", " ", 
          RowBox[{
          "ptsOld", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         "||", 
         RowBox[{
          RowBox[{
          "pts", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "\[NotEqual]", " ", 
          RowBox[{
          "ptsOld", "\[LeftDoubleBracket]", "2", 
           "\[RightDoubleBracket]"}]}]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{
          RowBox[{
          "ptsOld", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{
          "pts", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}]}], 
         ";", 
         RowBox[{
          RowBox[{
          "ptsOld", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], 
          "=", 
          RowBox[{
          "pts", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}]}]}],
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"sOld", "=", "s"}], ";", "\[IndentingNewLine]", 
      RowBox[{"prevReg", "=", "reg"}], ";", "\[IndentingNewLine]", 
      RowBox[{"Graphics", "[", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "cval", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"Opacity", "[", "0.3", "]"}], ",", 
              RowBox[{"Polygon", "@", 
               RowBox[{
               "visibleRegion", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "s"}], "}"}]}], "]"}], " ", 
          RowBox[{"(*", 
           RowBox[{"visible", " ", "regions"}], "*)"}], "\[IndentingNewLine]", 
          RowBox[{"(*", 
           RowBox[{",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"s", "\[GreaterEqual]", " ", "2"}], ",", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", 
                 RowBox[{"{", "Thin", "}"}], "]"}], ",", "Gray", ",", 
                RowBox[{"Line", "@", 
                 RowBox[{"Subsets", "[", 
                  RowBox[{
                   RowBox[{"pts", "\[LeftDoubleBracket]", 
                    RowBox[{"3", ";;", 
                    RowBox[{"s", "+", "2"}]}], "\[RightDoubleBracket]"}], ",", 
                   RowBox[{"{", "2", "}"}]}], "]"}]}]}], "}"}]}], "]"}]}], 
           RowBox[{"(*", 
            RowBox[{"Connect", " ", "all", " ", "the", " ", "guards"}], 
            "*)"}], "*)"}], "\[IndentingNewLine]", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"reg", "\[Equal]", "\"\<Movable Obstacles\>\""}], ",", 
            RowBox[{"(*", 
             RowBox[{"Ideal", " ", "Environment", " ", "obstacles"}], "*)"}], 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"Transparent", ",", 
               RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
               RowBox[{"{", 
                RowBox[{"Polygon", "@", "bound"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"Polygon", "@", "poly1"}], ",", 
                 RowBox[{"Polygon", "@", "poly2"}]}], "}"}]}], "}"}], "}"}]}],
            "]"}], " ", "\[IndentingNewLine]", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"reg", "\[Equal]", "\"\<Irregular\>\""}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Transparent", ",", 
                RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
                RowBox[{"Polygon", "@", "irregularPoly"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"EdgeForm", "[", 
                RowBox[{"{", 
                 RowBox[{"Thin", ",", "Black"}], "}"}], "]"}], 
               RowBox[{"(*", 
                RowBox[{",", "LightBlue", ",", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"Disk", "[", 
                    RowBox[{"#", ",", "0.1"}], "]"}], "&"}], "/@", 
                   "irregularPoly"}], ")"}]}], "*)"}], "}"}]}], "}"}]}], 
           "]"}], 
          RowBox[{"(*", 
           RowBox[{"Non", "-", 
            RowBox[{"Ideal", " ", "Envir"}]}], "*)"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"reg", "\[Equal]", "\"\<Cubicle\>\""}], ",", 
            RowBox[{"{", 
             RowBox[{"{", 
              RowBox[{"Transparent", ",", 
               RowBox[{"EdgeForm", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"Opacity", "[", "0.7", "]"}], ",", "Gray", ",", 
                  "Thick"}], "}"}], "]"}], ",", 
               RowBox[{"Polygon", "@", "cubiclePoly"}]}], "}"}], "}"}]}], 
           "]"}], 
          RowBox[{"(*", 
           RowBox[{"Complex", " ", "Envir"}], "*)"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"Table", "[", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
              "cval", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              ",", 
              RowBox[{"EdgeForm", "[", 
               RowBox[{"{", 
                RowBox[{"Thin", ",", "Black"}], "}"}], "]"}], ",", 
              RowBox[{"Disk", "[", 
               RowBox[{
                RowBox[{"pts", "\[LeftDoubleBracket]", 
                 RowBox[{"i", "+", "2"}], "\[RightDoubleBracket]"}], ",", 
                "0.1"}], "]"}]}], "}"}], ",", " ", 
            RowBox[{"{", 
             RowBox[{"i", ",", "1", ",", "s"}], "}"}]}], "]"}]}], " ", 
         RowBox[{"(*", "guards", "*)"}], "\[IndentingNewLine]", "}"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", " ", 
         RowBox[{"4", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "1"}], ",", "1"}], "}"}]}], "}"}]}]}]}], "]"}]}]}],
     "]"}], "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s", ",", "1", ",", "\"\<Number of Guards\>\""}], "}"}], ",", 
     RowBox[{"Range", "@", "8"}], ",", 
     RowBox[{"ControlType", "->", "Setter"}]}], "}"}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"reg", ",", "\"\<Cubicle\>\"", ",", "\"\<Environment\>\""}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "\"\<Movable Obstacles\>\"", ",", "\"\<Irregular\>\"", ",", 
       "\"\<Cubicle\>\""}], "}"}], ",", 
     RowBox[{"ControlType", "->", "Setter"}]}], "}"}], "\[IndentingNewLine]", 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"prevReg", ",", "\"\<\>\""}], "}"}], ",", " ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"sOld", ",", 
       RowBox[{"-", "1"}]}], "}"}], ",", " ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"visibleRegion", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"10", ",", 
         RowBox[{"{", 
          RowBox[{"8", ",", "2", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", 
     " ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"irregularPoly", "\[IndentingNewLine]", ",", 
       RowBox[{"Reverse", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.2"}], ",", 
            RowBox[{"-", "2.8"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.5"}], ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "2.3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.3"}], ",", "3.2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.75", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.9"}], ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.3"}], ",", "1.35"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.2"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.6", ",", "1"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2.1", ",", 
            RowBox[{"-", "2.7"}]}], "}"}]}], "}"}]}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"cubiclePoly", "\[IndentingNewLine]", ",", 
       RowBox[{"Reverse", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", 
            RowBox[{"-", "3.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", 
            RowBox[{"-", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.5"}], ",", 
            RowBox[{"-", "2"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.5"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.5"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.5"}], ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.5"}], ",", "0.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "3.5"}], ",", "3.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.5"}], ",", "3.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1.5"}], ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "2.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "2.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", "3.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "3.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "2.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.5", ",", "2.5"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.5", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.5", ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.5", ",", 
            RowBox[{"-", "1.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3.5", ",", 
            RowBox[{"-", "3.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "3.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"2", ",", 
            RowBox[{"-", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.5", ",", 
            RowBox[{"-", "3"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"1.5", ",", 
            RowBox[{"-", "3.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", 
            RowBox[{"-", "3.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "0.5"}], ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "0.5"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "1"}], ",", 
            RowBox[{"-", "3.5"}]}], "}"}]}], "}"}]}]}], "}"}], ",", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"ptsOld", ",", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"-", "10"}], ",", 
         RowBox[{"{", 
          RowBox[{"10", ",", "2"}], "}"}]}], "]"}]}], "}"}], ",", " ", 
     RowBox[{"ControlType", "\[Rule]", "None"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"pts", ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0.45", ",", "2.55"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1.5"}], ",", "0.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.6"}], ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2.5"}], ",", "0.5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "}"}]}], "}"}], 
     "\[IndentingNewLine]", ",", 
     RowBox[{"4", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", 
        RowBox[{"-", "1"}]}], "}"}]}], ",", 
     RowBox[{"4", 
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}]}], ",", "Locator", ",", 
     RowBox[{"Appearance", "\[Rule]", "None"}]}], "}"}], 
   "\[IndentingNewLine]", ",", 
   RowBox[{"FrameMargins", "\[Rule]", 
    RowBox[{"-", "5"}]}]}], "]"}]], "Input",
 CellChangeTimes->{{3.764965539798676*^9, 3.7649655400444107`*^9}, {
   3.764965582574123*^9, 3.7649656055493064`*^9}, {3.7649659291979094`*^9, 
   3.764966100623652*^9}, {3.7649662172321415`*^9, 3.764966244269495*^9}, {
   3.764966293452073*^9, 3.7649662943383303`*^9}, {3.7649667599979053`*^9, 
   3.764966779688657*^9}, {3.76496681060527*^9, 3.7649668540452857`*^9}, {
   3.764966909727465*^9, 3.7649669221001153`*^9}, {3.764967851667949*^9, 
   3.764967862456826*^9}, {3.7649680256081624`*^9, 3.764968029206252*^9}, {
   3.7649687267418823`*^9, 3.7649687300283318`*^9}, {3.7649690586362677`*^9, 
   3.764969060790703*^9}, {3.7649693597672896`*^9, 3.7649693604013157`*^9}, {
   3.764985943077859*^9, 3.7649859483940115`*^9}, {3.7649862450731544`*^9, 
   3.764986250305341*^9}, {3.7649863366210203`*^9, 3.764986342145485*^9}, {
   3.7649866431198807`*^9, 3.7649866940077767`*^9}, {3.7649867259970675`*^9, 
   3.7649867691178627`*^9}, {3.764986802670251*^9, 3.764986974672299*^9}, {
   3.7649870639686365`*^9, 3.764987064068077*^9}, 3.764987179132023*^9, {
   3.7649873357780905`*^9, 3.764987379229001*^9}, {3.7649874092600155`*^9, 
   3.764987483386527*^9}, {3.7649876380320053`*^9, 3.7649877771094503`*^9}, {
   3.7649880681216087`*^9, 3.7649881496196413`*^9}, 3.7649882010672417`*^9, {
   3.7649882475013523`*^9, 3.7649882621439877`*^9}, {3.7649883409659348`*^9, 
   3.764988348835311*^9}, {3.7649886129090986`*^9, 3.7649887796524167`*^9}, {
   3.7649888503170586`*^9, 3.764989012181364*^9}, {3.764989054121647*^9, 
   3.7649891780520525`*^9}, {3.7649892520080876`*^9, 
   3.7649892523200846`*^9}, {3.764989293568593*^9, 3.764989329759313*^9}, {
   3.7649893958600626`*^9, 3.7649894045349207`*^9}, {3.764989454064685*^9, 
   3.764989468281987*^9}, {3.764989586378462*^9, 3.764989586928721*^9}, {
   3.7649897375409107`*^9, 3.7649897391847386`*^9}, {3.764990115156066*^9, 
   3.764990147181944*^9}, {3.764990186083614*^9, 3.7649903199194355`*^9}, {
   3.764990357025355*^9, 3.764990358493563*^9}, {3.7649914260664606`*^9, 
   3.764991450016022*^9}, {3.764991971276353*^9, 3.764991973684534*^9}, {
   3.765130769459999*^9, 3.76513080589145*^9}, {3.7651310898812237`*^9, 
   3.76513120724283*^9}, {3.7651318053125734`*^9, 3.7651318778324695`*^9}, {
   3.76513191087951*^9, 3.76513197154758*^9}, {3.7651320018153152`*^9, 
   3.765132138113017*^9}, {3.7654097307484436`*^9, 3.7654098902587123`*^9}, {
   3.7654099222845397`*^9, 3.7654099319601297`*^9}, {3.7654099695097756`*^9, 
   3.76540999694044*^9}, {3.7654100739618177`*^9, 3.765410074281912*^9}, {
   3.7654101251489615`*^9, 3.7654101557102003`*^9}, {3.765410197089198*^9, 
   3.7654101975277376`*^9}, {3.765410354218835*^9, 3.7654103630040183`*^9}, {
   3.765410414197678*^9, 3.765410456039402*^9}, {3.7654105172642097`*^9, 
   3.7654105756221094`*^9}, {3.7654161283264737`*^9, 3.765416140250456*^9}, {
   3.765416204953722*^9, 3.7654162103433657`*^9}, {3.765416330923199*^9, 
   3.7654163521808205`*^9}, {3.7654247618890853`*^9, 
   3.7654247621208143`*^9}, {3.765713571408181*^9, 3.765713585888489*^9}, {
   3.76571362711732*^9, 3.7657136273187795`*^9}, {3.769800324721612*^9, 
   3.769800346059581*^9}, {3.769800412315553*^9, 3.7698004437076483`*^9}, {
   3.769801882914316*^9, 3.7698019128413277`*^9}, {3.769801980090578*^9, 
   3.769802009498974*^9}, {3.7698020447038784`*^9, 3.769802218219139*^9}, {
   3.7698022759916353`*^9, 3.769802283465658*^9}, {3.769802369510709*^9, 
   3.7698025313351355`*^9}, {3.7698025725609455`*^9, 3.76980261076184*^9}, {
   3.769802663312411*^9, 3.7698027929887733`*^9}, {3.7698028234533434`*^9, 
   3.769802825251538*^9}, {3.7698028703499966`*^9, 3.7698029053025703`*^9}, {
   3.7698029379443235`*^9, 3.7698032629506245`*^9}, {3.7698033332387543`*^9, 
   3.769803633786431*^9}, {3.7698036724249487`*^9, 3.7698037898989563`*^9}, {
   3.7698038299449177`*^9, 3.769804264488443*^9}, {3.7698043302436852`*^9, 
   3.7698043392226853`*^9}, {3.7698043867098103`*^9, 3.769804407919072*^9}, {
   3.7698487807076063`*^9, 3.769848782253125*^9}, {3.769848882840413*^9, 
   3.769848885209511*^9}, {3.7698489746142073`*^9, 3.769849054572678*^9}, {
   3.769849096829094*^9, 3.769849190572721*^9}, {3.769849232459968*^9, 
   3.769849322953788*^9}, {3.769849359098021*^9, 3.769849417227084*^9}, {
   3.769849450817895*^9, 3.769849513819037*^9}, {3.769850187725575*^9, 
   3.7698501932122917`*^9}, {3.7698502861742067`*^9, 3.769850289996069*^9}, {
   3.769850340158079*^9, 3.769850356412511*^9}, {3.769850437079791*^9, 
   3.7698505250380087`*^9}, {3.76985062198176*^9, 3.769850713695861*^9}, {
   3.769850826587224*^9, 3.769850869429997*^9}, {3.7698610184260063`*^9, 
   3.769861026112302*^9}, {3.769861300078977*^9, 3.769861325137315*^9}, {
   3.7698614361398773`*^9, 3.7698615527092752`*^9}, {3.769861597071603*^9, 
   3.7698616488874474`*^9}, {3.769861679955002*^9, 3.7698617610844812`*^9}, {
   3.769861890670793*^9, 3.769861947136181*^9}, {3.769861980081015*^9, 
   3.769862020496539*^9}, {3.769862053534548*^9, 3.769862075889573*^9}, {
   3.76986218209354*^9, 3.769862330496821*^9}, {3.769862368626131*^9, 
   3.769862518725431*^9}, {3.7698625507889643`*^9, 3.769862663350587*^9}, {
   3.769891682223999*^9, 3.7698917747519836`*^9}, {3.769891816409609*^9, 
   3.7698918388563423`*^9}, {3.7699045646867476`*^9, 
   3.7699045649959173`*^9}, {3.7699048124304504`*^9, 
   3.7699048540681915`*^9}, {3.7699049296192307`*^9, 
   3.7699049730772524`*^9}, {3.7699050068136263`*^9, 3.769905019278016*^9}, {
   3.7699050637502003`*^9, 3.769905124740159*^9}, {3.769905162211134*^9, 
   3.7699051815939393`*^9}, {3.769905226696947*^9, 3.769905258831931*^9}, {
   3.769905320154911*^9, 3.769905323382246*^9}, {3.769905485645966*^9, 
   3.769905499442028*^9}, {3.7699055386501703`*^9, 3.769905539381214*^9}, {
   3.7699056002085085`*^9, 3.769905644849066*^9}, {3.7699056785888095`*^9, 
   3.769905699779133*^9}, {3.7699057770324507`*^9, 3.76990579619715*^9}, {
   3.7699058268242407`*^9, 3.769905831484782*^9}, {3.7699058743551054`*^9, 
   3.769905876863387*^9}, {3.769905937836269*^9, 3.7699060448469644`*^9}, {
   3.7699061370333796`*^9, 3.769906185859764*^9}, {3.7699062293833385`*^9, 
   3.7699062399600334`*^9}, {3.769906431048835*^9, 3.769906436963002*^9}, {
   3.7699064889548903`*^9, 3.7699065441123343`*^9}, {3.7699065847795844`*^9, 
   3.769906640375859*^9}, {3.769906727452901*^9, 3.769906818514289*^9}, {
   3.7699069236769257`*^9, 3.7699069614239836`*^9}, {3.769907323065258*^9, 
   3.769907457136588*^9}, {3.769908792249564*^9, 3.7699088021290913`*^9}, {
   3.7699097522966895`*^9, 3.7699098508251095`*^9}, {3.769909897160152*^9, 
   3.7699099158989887`*^9}, {3.769909996501362*^9, 3.769910002208126*^9}, {
   3.7699100328700695`*^9, 3.769910034478764*^9}, {3.769911834889988*^9, 
   3.769911834992738*^9}, {3.7699654658595276`*^9, 3.769965653360896*^9}, {
   3.7699657445359836`*^9, 3.7699658830833783`*^9}, {3.7699674022571883`*^9, 
   3.769967562684016*^9}, {3.7699675926857247`*^9, 3.769967618383011*^9}, {
   3.7699676489197717`*^9, 3.769967710253564*^9}, {3.770409880754033*^9, 
   3.7704098945265465`*^9}, {3.7704099969018326`*^9, 
   3.7704101032794943`*^9}, {3.7704102504422674`*^9, 3.770410279661925*^9}, {
   3.77041032046436*^9, 3.7704103388717237`*^9}, {3.770410370010133*^9, 
   3.770410396121086*^9}, {3.770410447606471*^9, 3.7704104808887463`*^9}, {
   3.7704107753954306`*^9, 3.770410935293065*^9}, {3.7704109801807027`*^9, 
   3.7704111564660296`*^9}, {3.7704111906186037`*^9, 
   3.7704112469933786`*^9}, {3.7704113168800683`*^9, 
   3.7704115720805235`*^9}, {3.7704116064694395`*^9, 
   3.7704117088055058`*^9}, {3.770411799735178*^9, 3.7704119555885115`*^9}, {
   3.7704120281848507`*^9, 3.770412030752532*^9}, {3.7704120636067486`*^9, 
   3.770412067771966*^9}, {3.7704121700883503`*^9, 3.7704121711011147`*^9}, {
   3.7704122066735125`*^9, 3.7704122359056144`*^9}, {3.7704241513537035`*^9, 
   3.7704241866256227`*^9}, {3.7704242336529617`*^9, 3.770424233823223*^9}, 
   3.7704242908516264`*^9, {3.770424415785417*^9, 3.770424527196509*^9}, 
   3.770424579202776*^9, 3.7704246162227206`*^9, 3.770424664905978*^9, {
   3.7704246985941343`*^9, 3.770424714525243*^9}, {3.7704247447926292`*^9, 
   3.7704247501761637`*^9}, {3.7704247871306677`*^9, 
   3.7704248303131495`*^9}, {3.7704248610198345`*^9, 3.7704248681529665`*^9}, 
   3.770424921999316*^9, {3.7704249563653812`*^9, 3.7704249887332973`*^9}, {
   3.770425027143366*^9, 3.770425035964201*^9}, {3.7704250706529837`*^9, 
   3.7704252901328444`*^9}, {3.770425321407254*^9, 3.77042532841807*^9}, {
   3.7704253715600114`*^9, 3.770425454263549*^9}, {3.770425502852622*^9, 
   3.7704255356200123`*^9}, {3.7704255707625036`*^9, 3.770425613902828*^9}, 
   3.770425650138321*^9, 3.7704256891843133`*^9, {3.7704257251987486`*^9, 
   3.770425775410201*^9}, {3.7704260254806952`*^9, 3.770426169165684*^9}, {
   3.770489893780662*^9, 3.770489925529025*^9}, {3.7704900743258457`*^9, 
   3.770490076619949*^9}, {3.7704901312669888`*^9, 3.7704902295488014`*^9}, {
   3.770490278208726*^9, 3.7704902813693614`*^9}, {3.7705081679643145`*^9, 
   3.7705081849289484`*^9}, {3.770508283087232*^9, 3.770508311629879*^9}, {
   3.7705083458822155`*^9, 3.7705083477841377`*^9}, {3.770508398877405*^9, 
   3.7705084724505033`*^9}, 3.7705085373039603`*^9, {3.7705085697411413`*^9, 
   3.7705085949905405`*^9}, {3.7705086307628527`*^9, 
   3.7705087631914454`*^9}, {3.770508952242139*^9, 3.77050896427394*^9}, {
   3.770509058989439*^9, 3.770509059569935*^9}, {3.770562888440364*^9, 
   3.7705630719819956`*^9}, {3.770563118488617*^9, 3.7705635073455324`*^9}, {
   3.770563542207354*^9, 3.7705638260344763`*^9}, {3.7705638724469614`*^9, 
   3.7705643038466268`*^9}, {3.770564417238608*^9, 3.7705646400649276`*^9}, {
   3.7705648555673375`*^9, 3.770564905294652*^9}, 3.77063403277337*^9, 
   3.7706340786739197`*^9, {3.7711648749152117`*^9, 3.771164907511175*^9}, 
   3.7717781124093657`*^9, {3.7717785055938716`*^9, 3.771778527121514*^9}, {
   3.771782267931743*^9, 3.7717822743297596`*^9}, {3.7717823402569575`*^9, 
   3.7717823496367035`*^9}, {3.7717824006697903`*^9, 
   3.7717824887337065`*^9}, {3.7717825208413267`*^9, 3.77178252962671*^9}, {
   3.7717838988514013`*^9, 3.7717839011397514`*^9}, {3.7717839928330956`*^9, 
   3.7717839949274673`*^9}, {3.7717841309638276`*^9, 
   3.7717841565714293`*^9}, {3.771784229363046*^9, 3.771784230687127*^9}, {
   3.7717844670675344`*^9, 3.771784468822008*^9}, {3.7717851666721563`*^9, 
   3.7717851688875284`*^9}, 3.771795281901947*^9, {3.7717953843587484`*^9, 
   3.7717953870600047`*^9}, {3.771796478111786*^9, 3.771796479135993*^9}, {
   3.771796595849693*^9, 3.7717966053429413`*^9}, {3.771796839999906*^9, 
   3.771796840777276*^9}, {3.771796897828518*^9, 3.771796970188795*^9}, {
   3.771797000189295*^9, 3.7717970356792297`*^9}, {3.7717970972981567`*^9, 
   3.7717971282074842`*^9}, {3.7717971691494308`*^9, 3.771797169420049*^9}, {
   3.771797206343539*^9, 3.7717972154644704`*^9}, {3.771797260780411*^9, 
   3.7717972904751797`*^9}, {3.771797416964119*^9, 3.7717974489766383`*^9}, 
   3.7717977157628946`*^9, {3.771960439600421*^9, 3.7719604669458447`*^9}, {
   3.7719605013924484`*^9, 3.77196052853708*^9}, {3.771960564946376*^9, 
   3.7719606526349945`*^9}, {3.771960687053752*^9, 3.771960711179999*^9}, {
   3.7719607509557257`*^9, 3.7719608949143047`*^9}, {3.7719609480560513`*^9, 
   3.7719609790456963`*^9}, {3.7719613292038555`*^9, 
   3.7719613802192955`*^9}, {3.772221681361932*^9, 3.77222168152013*^9}, {
   3.772222203303686*^9, 3.772222203408782*^9}, {3.7722248192143335`*^9, 
   3.7722248224485455`*^9}, {3.7722248562515335`*^9, 3.772224905642267*^9}, {
   3.7729860918177567`*^9, 3.772986094249671*^9}, {3.772992430246068*^9, 
   3.7729924376627836`*^9}, {3.772995840729746*^9, 3.7729958439999638`*^9}},
 CellLabel->"In[23]:=",ExpressionUUID->"4b1e4c1e-ed26-4125-97e1-052f34df3a3d"],

Cell[BoxData[
 TagBox[
  StyleBox[
   DynamicModuleBox[{$CellContext`cubiclePoly$$ = {{-1, -3.5}, {-1, -0.5}, {
     0, -0.5}, {0, -1}, {-0.5, -1}, {-0.5, -3.5}, {1.5, -3.5}, {1.5, -3}, {
     2, -3}, {2, -3.5}, {3.5, -3.5}, {3.5, -1}, {2, -1}, {2, -1.5}, {
     1.5, -1.5}, {1.5, -0.5}, {3.5, -0.5}, {3.5, 2}, {1.5, 2}, {1.5, 2.5}, {
     3.5, 2.5}, {3.5, 3.5}, {-1, 3.5}, {-1, 2.5}, {0.5, 2.5}, {
     0.5, 2}, {-1.5, 2}, {-1.5, 3.5}, {-3.5, 3.5}, {-3.5, 0.5}, {-1.5, 
     0.5}, {-1.5, 0}, {-3.5, 
      0}, {-3.5, -2}, {-2, -2}, {-2, -3.5}}, $CellContext`irregularPoly$$ = {{
     2.1, -2.7}, {2.6, 1}, {0.5, 0.5}, {-1.2, -1}, {-1.3, 1.35}, {-0.9, 1}, {
     0.75, 3}, {-3.3, 3.2}, {-1, 2.3}, {-3.5, 
     0.5}, {-1.2, -2.8}}, $CellContext`prevReg$$ = 
    "Cubicle", $CellContext`pts$$ = {{1, 0}, {2, 
     2}, {-1.81, -0.3900000000000001}, {-1, 0}, {0.45, 2.55}, {-1.5, 
     0.5}, {-0.6, -1}, {-2.5, 0.5}, {-2, 
     1}, {-1, -1}}, $CellContext`ptsOld$$ = {{1, 0}, {2, 
     2}, {-1.81, -0.3900000000000001}, {-10, -10}, {-10, -10}, {-10, -10}, \
{-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}}, $CellContext`reg$$ = 
    "Cubicle", $CellContext`s$$ = 1, $CellContext`sOld$$ = 
    1, $CellContext`visibleRegion$$ = {{{3.5, 2.}, {1.5, 2.}, {1.5, 2.5}, {
     2.6453287197231834`, 3.500000000000001}, {1.9497907949790796`, 
     3.4999999999999996`}, {0.5, 2.}, {0.0897435897435894, 2.}, {-1.5, 
     0.}, {-3.5, 
     0.}, {-3.5, -2.}, {-2., -2.}, {-2., -3.5}, {-1., -3.5}, {-1., -0.5}, {
     0., -0.5}, {1.5, -0.5911602209944751}, {1.5, -0.5}, {3.5, -0.5}}, {{10, 
     10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {
     10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 
     10}}}, Typeset`show$$ = True, Typeset`bookmarkList$$ = {}, 
    Typeset`bookmarkMode$$ = "Menu", Typeset`animator$$, Typeset`animvar$$ = 
    1, Typeset`name$$ = "\"untitled\"", Typeset`specs$$ = {{{
       Hold[$CellContext`s$$], 1, "Number of Guards"}, {1, 2, 3, 4, 5, 6, 7, 
      8}}, {{
       Hold[$CellContext`reg$$], "Cubicle", "Environment"}, {
      "Movable Obstacles", "Irregular", "Cubicle"}}, {{
       Hold[$CellContext`prevReg$$], ""}}, {{
       Hold[$CellContext`sOld$$], -1}}, {{
       Hold[$CellContext`visibleRegion$$], {{{10, 10}, {10, 10}}, {{10, 10}, {
       10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 
       10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 
       10}}}}}, {{
       Hold[$CellContext`irregularPoly$$], {{2.1, -2.7}, {2.6, 1}, {0.5, 
        0.5}, {-1.2, -1}, {-1.3, 1.35}, {-0.9, 1}, {0.75, 3}, {-3.3, 
        3.2}, {-1, 2.3}, {-3.5, 0.5}, {-1.2, -2.8}}}}, {{
       Hold[$CellContext`cubiclePoly$$], {{-1, -3.5}, {-1, -0.5}, {0, -0.5}, {
        0, -1}, {-0.5, -1}, {-0.5, -3.5}, {1.5, -3.5}, {1.5, -3}, {2, -3}, {
        2, -3.5}, {3.5, -3.5}, {3.5, -1}, {2, -1}, {2, -1.5}, {1.5, -1.5}, {
        1.5, -0.5}, {3.5, -0.5}, {3.5, 2}, {1.5, 2}, {1.5, 2.5}, {3.5, 2.5}, {
        3.5, 3.5}, {-1, 3.5}, {-1, 2.5}, {0.5, 2.5}, {
        0.5, 2}, {-1.5, 2}, {-1.5, 3.5}, {-3.5, 3.5}, {-3.5, 0.5}, {-1.5, 
        0.5}, {-1.5, 0}, {-3.5, 0}, {-3.5, -2}, {-2, -2}, {-2, -3.5}}}}, {{
       Hold[$CellContext`ptsOld$$], {{-10, -10}, {-10, -10}, {-10, -10}, \
{-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, \
-10}}}}, {{
       Hold[$CellContext`pts$$], {{1, 0}, {2, 2}, {0, -1}, {-1, 0}, {0.45, 
        2.55}, {-1.5, 0.5}, {-0.6, -1}, {-2.5, 0.5}, {-2, 
        1}, {-1, -1}}}, {-4, -4}, {4, 4}}}, Typeset`size$$ = {
    540., {266., 274.}}, Typeset`update$$ = 0, Typeset`initDone$$, 
    Typeset`skipInitDone$$ = True, $CellContext`s$81814$$ = 
    0, $CellContext`reg$81815$$ = 0, $CellContext`pts$81816$$ = {0, 0}}, 
    DynamicBox[Manipulate`ManipulateBoxes[
     1, StandardForm, 
      "Variables" :> {$CellContext`cubiclePoly$$ = {{-1, -3.5}, {-1, -0.5}, {
          0, -0.5}, {0, -1}, {-0.5, -1}, {-0.5, -3.5}, {1.5, -3.5}, {
          1.5, -3}, {2, -3}, {2, -3.5}, {3.5, -3.5}, {3.5, -1}, {2, -1}, {
          2, -1.5}, {1.5, -1.5}, {1.5, -0.5}, {3.5, -0.5}, {3.5, 2}, {
          1.5, 2}, {1.5, 2.5}, {3.5, 2.5}, {3.5, 3.5}, {-1, 3.5}, {-1, 2.5}, {
          0.5, 2.5}, {0.5, 2}, {-1.5, 2}, {-1.5, 3.5}, {-3.5, 3.5}, {-3.5, 
          0.5}, {-1.5, 
          0.5}, {-1.5, 0}, {-3.5, 
           0}, {-3.5, -2}, {-2, -2}, {-2, -3.5}}, \
$CellContext`irregularPoly$$ = {{2.1, -2.7}, {2.6, 1}, {0.5, 
          0.5}, {-1.2, -1}, {-1.3, 1.35}, {-0.9, 1}, {0.75, 3}, {-3.3, 
          3.2}, {-1, 2.3}, {-3.5, 0.5}, {-1.2, -2.8}}, $CellContext`prevReg$$ = 
        "", $CellContext`pts$$ = {{1, 0}, {2, 2}, {0, -1}, {-1, 0}, {0.45, 
          2.55}, {-1.5, 0.5}, {-0.6, -1}, {-2.5, 0.5}, {-2, 
          1}, {-1, -1}}, $CellContext`ptsOld$$ = {{-10, -10}, {-10, -10}, \
{-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, \
-10}, {-10, -10}}, $CellContext`reg$$ = "Cubicle", $CellContext`s$$ = 
        1, $CellContext`sOld$$ = -1, $CellContext`visibleRegion$$ = {{{10, 
         10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 
         10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 
         10}, {10, 10}}, {{10, 10}, {10, 10}}}}, "ControllerVariables" :> {
        Hold[$CellContext`s$$, $CellContext`s$81814$$, 0], 
        Hold[$CellContext`reg$$, $CellContext`reg$81815$$, 0], 
        Hold[$CellContext`pts$$, $CellContext`pts$81816$$, {0, 0}]}, 
      "OtherVariables" :> {
       Typeset`show$$, Typeset`bookmarkList$$, Typeset`bookmarkMode$$, 
        Typeset`animator$$, Typeset`animvar$$, Typeset`name$$, 
        Typeset`specs$$, Typeset`size$$, Typeset`update$$, Typeset`initDone$$,
         Typeset`skipInitDone$$}, "Body" :> 
      Module[{$CellContext`poly1$ = Map[Part[$CellContext`pts$$, 1] + #& , 
           CirclePoints[4]], $CellContext`poly2$ = 
         Map[Part[$CellContext`pts$$, 2] + #& , 
           CirclePoints[3]], $CellContext`bound$ = 
         5 CirclePoints[4], $CellContext`invisiblePoly$ = 
         7 CirclePoints[4], $CellContext`cval$ = 
         ColorData[
          100, "ColorList"], $CellContext`listofPoly$}, \
$CellContext`listofPoly$ = N[
           
           If[$CellContext`reg$$ == 
            "Movable Obstacles", {$CellContext`poly1$, $CellContext`poly2$, \
$CellContext`bound$, $CellContext`invisiblePoly$}, 
            
            If[$CellContext`reg$$ == 
             "Irregular", {$CellContext`irregularPoly$$, \
$CellContext`invisiblePoly$}, {$CellContext`cubiclePoly$$, \
$CellContext`invisiblePoly$}]]]; Table[
          If[
           Or[
           Part[$CellContext`pts$$, $CellContext`i] != 
            Part[$CellContext`ptsOld$$, $CellContext`i], 
            Part[$CellContext`pts$$, 1] != Part[$CellContext`ptsOld$$, 1], 
            Part[$CellContext`pts$$, 2] != 
            Part[$CellContext`ptsOld$$, 
              2], $CellContext`sOld$$ < $CellContext`i - 
             2, $CellContext`prevReg$$ != $CellContext`reg$$], 
           Part[$CellContext`visibleRegion$$, $CellContext`i - 
              2] = $CellContext`visiblePolysRev3[$CellContext`listofPoly$, 
              Part[$CellContext`pts$$, $CellContext`i]]; 
           Part[$CellContext`ptsOld$$, $CellContext`i] = 
            Part[$CellContext`pts$$, $CellContext`i]], {$CellContext`i, 
           3, $CellContext`s$$ + 2}]; If[
          Or[
          Part[$CellContext`pts$$, 1] != Part[$CellContext`ptsOld$$, 1], 
           Part[$CellContext`pts$$, 2] != Part[$CellContext`ptsOld$$, 2]], 
          Part[$CellContext`ptsOld$$, 1] = Part[$CellContext`pts$$, 1]; 
          Part[$CellContext`ptsOld$$, 2] = 
           Part[$CellContext`pts$$, 
             2]]; $CellContext`sOld$$ = $CellContext`s$$; \
$CellContext`prevReg$$ = $CellContext`reg$$; Graphics[{
           Table[{
             Part[$CellContext`cval$, $CellContext`i], 
             Opacity[0.3], 
             Polygon[
              
              Part[$CellContext`visibleRegion$$, $CellContext`i]]}, \
{$CellContext`i, 1, $CellContext`s$$}], 
           If[$CellContext`reg$$ == "Movable Obstacles", {{Transparent, 
              EdgeForm[Thin], {
               Polygon[$CellContext`bound$]}, {
               Polygon[$CellContext`poly1$], 
               Polygon[$CellContext`poly2$]}}}], 
           If[$CellContext`reg$$ == "Irregular", {{Transparent, 
              EdgeForm[Thin], 
              Polygon[$CellContext`irregularPoly$$]}, {
              EdgeForm[{Thin, Black}]}}], 
           If[$CellContext`reg$$ == "Cubicle", {{Transparent, 
              EdgeForm[{
                Opacity[0.7], Gray, Thick}], 
              Polygon[$CellContext`cubiclePoly$$]}}], 
           Table[{
             Part[$CellContext`cval$, $CellContext`i], 
             EdgeForm[{Thin, Black}], 
             Disk[
              Part[$CellContext`pts$$, $CellContext`i + 2], 
              0.1]}, {$CellContext`i, 1, $CellContext`s$$}]}, PlotRange -> 
          4 {{-1, 1}, {-1, 1}}]], 
      "Specifications" :> {{{$CellContext`s$$, 1, "Number of Guards"}, {1, 2, 
         3, 4, 5, 6, 7, 8}, ControlType -> 
         Setter}, {{$CellContext`reg$$, "Cubicle", "Environment"}, {
         "Movable Obstacles", "Irregular", "Cubicle"}, ControlType -> 
         Setter}, {{$CellContext`prevReg$$, ""}, ControlType -> 
         None}, {{$CellContext`sOld$$, -1}, ControlType -> 
         None}, {{$CellContext`visibleRegion$$, {{{10, 10}, {10, 10}}, {{10, 
          10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 
          10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 10}, {10, 10}}, {{10, 
          10}, {10, 10}}}}, ControlType -> 
         None}, {{$CellContext`irregularPoly$$, {{2.1, -2.7}, {2.6, 1}, {0.5, 
           0.5}, {-1.2, -1}, {-1.3, 1.35}, {-0.9, 1}, {0.75, 3}, {-3.3, 
           3.2}, {-1, 2.3}, {-3.5, 0.5}, {-1.2, -2.8}}}, ControlType -> 
         None}, {{$CellContext`cubiclePoly$$, {{-1, -3.5}, {-1, -0.5}, {
           0, -0.5}, {0, -1}, {-0.5, -1}, {-0.5, -3.5}, {1.5, -3.5}, {
           1.5, -3}, {2, -3}, {2, -3.5}, {3.5, -3.5}, {3.5, -1}, {2, -1}, {
           2, -1.5}, {1.5, -1.5}, {1.5, -0.5}, {3.5, -0.5}, {3.5, 2}, {
           1.5, 2}, {1.5, 2.5}, {3.5, 2.5}, {3.5, 
           3.5}, {-1, 3.5}, {-1, 2.5}, {0.5, 2.5}, {0.5, 2}, {-1.5, 2}, {-1.5,
            3.5}, {-3.5, 3.5}, {-3.5, 0.5}, {-1.5, 
           0.5}, {-1.5, 0}, {-3.5, 0}, {-3.5, -2}, {-2, -2}, {-2, -3.5}}}, 
         ControlType -> 
         None}, {{$CellContext`ptsOld$$, {{-10, -10}, {-10, -10}, {-10, -10}, \
{-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, -10}, {-10, \
-10}}}, ControlType -> 
         None}, {{$CellContext`pts$$, {{1, 0}, {2, 2}, {0, -1}, {-1, 0}, {
           0.45, 2.55}, {-1.5, 0.5}, {-0.6, -1}, {-2.5, 0.5}, {-2, 
           1}, {-1, -1}}}, {-4, -4}, {4, 4}, ControlType -> Locator, 
         Appearance -> None}}, "Options" :> {FrameMargins -> -5}, 
      "DefaultOptions" :> {}],
     ImageSizeCache->{578., {337., 346.}},
     SingleEvaluation->True],
    Deinitialization:>None,
    DynamicModuleValues:>{},
    SynchronousInitialization->True,
    UndoTrackedVariables:>{Typeset`show$$, Typeset`bookmarkMode$$},
    UnsavedVariables:>{Typeset`initDone$$},
    UntrackedVariables:>{Typeset`size$$}], "Manipulate",
   Deployed->True,
   StripOnInput->False],
  Manipulate`InterpretManipulate[1]]], "Output",
 CellChangeTimes->{
  3.7704903238781214`*^9, {3.7705081450765653`*^9, 3.7705081884774885`*^9}, 
   3.7705083122631965`*^9, 3.7705084734897003`*^9, 3.770508538315243*^9, {
   3.770508682990043*^9, 3.77050871097519*^9}, {3.770508745142761*^9, 
   3.7705087635814037`*^9}, 3.7705089649012566`*^9, 3.770509060490446*^9, 
   3.770509164933919*^9, 3.770562804834746*^9, 3.7705629169827604`*^9, 
   3.770562950591157*^9, 3.7705630410494766`*^9, 3.7705630771156015`*^9, {
   3.7705633292664814`*^9, 3.7705634271038427`*^9}, {3.7705634699327126`*^9, 
   3.770563508169259*^9}, {3.7705635461950874`*^9, 3.7705636369108596`*^9}, 
   3.770563700861326*^9, {3.770563732233345*^9, 3.770563749276025*^9}, {
   3.770563780811472*^9, 3.7705638265051203`*^9}, {3.7705638772270565`*^9, 
   3.7705639471088715`*^9}, {3.7705639941378946`*^9, 3.770564029920839*^9}, 
   3.770564060460005*^9, {3.770564090823118*^9, 3.7705641613078284`*^9}, 
   3.770564195985916*^9, 3.770564226752341*^9, {3.770564262776*^9, 
   3.770564313876588*^9}, 3.7705644311874876`*^9, {3.770564463575628*^9, 
   3.770564479996069*^9}, {3.7705645518373756`*^9, 3.770564640785107*^9}, 
   3.770564672235457*^9, {3.770564872724227*^9, 3.7705649063527365`*^9}, 
   3.7705650353500566`*^9, 3.770632513386021*^9, 3.7706325718227587`*^9, 
   3.770632662712997*^9, 3.770634034496929*^9, 3.7706340801157575`*^9, 
   3.7706341934321995`*^9, {3.77116301153679*^9, 3.7711630211329436`*^9}, 
   3.771163302128455*^9, {3.771163349869788*^9, 3.7711633533139877`*^9}, 
   3.7711634017003317`*^9, 3.771164738221053*^9, {3.7711647929328976`*^9, 
   3.771164822581554*^9}, {3.771164854548294*^9, 3.771164919850131*^9}, 
   3.771777998325116*^9, 3.771778037508486*^9, {3.771778091369891*^9, 
   3.7717781197811446`*^9}, {3.771778506246929*^9, 3.7717785283724985`*^9}, {
   3.7717822627004414`*^9, 3.771782275821558*^9}, {3.771782589998741*^9, 
   3.771782623858939*^9}, {3.7717838143705807`*^9, 3.7717838216536627`*^9}, {
   3.771784081314221*^9, 3.7717841073021646`*^9}, {3.7717842272608447`*^9, 
   3.7717842312388783`*^9}, 3.771784287906736*^9, 3.7717843278789244`*^9, {
   3.771785169776997*^9, 3.7717851727202787`*^9}, 3.771794893264331*^9, {
   3.771795268621084*^9, 3.771795297622054*^9}, {3.77179537549327*^9, 
   3.7717953876981316`*^9}, {3.7717964688518643`*^9, 
   3.7717964809147053`*^9}, {3.7717965853424025`*^9, 3.771796605736719*^9}, 
   3.771796692400816*^9, 3.771796841950361*^9, {3.7717968996539536`*^9, 
   3.7717969710259795`*^9}, {3.771797003180745*^9, 3.7717970369229555`*^9}, {
   3.771797101105137*^9, 3.7717971290772038`*^9}, 3.7717971713014116`*^9, 
   3.7717972164911566`*^9, {3.7717972621497135`*^9, 3.7717972911405525`*^9}, {
   3.77179741814644*^9, 3.7717974502829943`*^9}, 3.7717977167567835`*^9, 
   3.771842809467244*^9, 3.771960396099102*^9, {3.771960440265077*^9, 
   3.771960528961768*^9}, {3.771960566110796*^9, 3.7719605888132844`*^9}, {
   3.771960624430019*^9, 3.771960653144457*^9}, {3.77196068778302*^9, 
   3.7719607115263467`*^9}, {3.7719607520162635`*^9, 
   3.7719608954553185`*^9}, {3.7719609439224377`*^9, 
   3.7719609793941298`*^9}, {3.7719613182611623`*^9, 
   3.7719614087845345`*^9}, {3.7719614630161943`*^9, 3.771961514579614*^9}, 
   3.7722206109374733`*^9, 3.772220653034422*^9, 3.7722211149245443`*^9, {
   3.772221166166707*^9, 3.772221193252549*^9}, 3.772221245843891*^9, 
   3.772221275895718*^9, 3.7722213430027003`*^9, 3.7722215527928224`*^9, {
   3.7722216187368593`*^9, 3.7722216417823377`*^9}, {3.772221686499598*^9, 
   3.7722218284008865`*^9}, {3.7722219892624006`*^9, 3.7722219964171934`*^9}, 
   3.772222093077239*^9, {3.7722221714096537`*^9, 3.772222203950014*^9}, 
   3.77222337532409*^9, {3.7722247947497663`*^9, 3.7722249060622196`*^9}, {
   3.7729825164006324`*^9, 3.77298252382281*^9}, 3.7729843208824625`*^9, 
   3.7729855919525485`*^9, 3.772985992175625*^9, 3.7729886348313303`*^9, 
   3.772988942082271*^9, {3.7729898367363167`*^9, 3.772989844336996*^9}, {
   3.7729923689051237`*^9, 3.7729924381784644`*^9}, {3.7729958121766577`*^9, 
   3.7729958658549395`*^9}, 3.7729958988721743`*^9, 3.772996172628793*^9, 
   3.772996220537033*^9, 3.7729973431850023`*^9, {3.77351219692696*^9, 
   3.773512212117777*^9}, 3.773623767317628*^9, 3.773623842825204*^9},
 CellLabel->"Out[23]=",ExpressionUUID->"b3d26449-ab1a-47e1-a3af-b75816645fc6"]
}, Open  ]],

Cell[BoxData[" "], "Input",
 CellChangeTimes->{
  3.771961525009866*^9},ExpressionUUID->"1ef0df80-8aa1-418f-b49c-\
d1c949c3113c"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellLabel->
  "In[101]:=",ExpressionUUID->"e32b32fa-366c-4519-b8ad-5bc9bc3f42e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"visiblePolysRev3", "[", 
   RowBox[{"polys_", ",", 
    RowBox[{"pm", ":", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_"}], "}"}]}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"p", ",", "listofAllLines", ",", "infiniteLine", ",", 
      RowBox[{"length", "=", 
       RowBox[{"Length", "@", "polys"}]}], ",", "orderedList", ",", 
      "sortedList", ",", 
      RowBox[{"jList", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"visibleList", "=", 
       RowBox[{"{", "}"}]}], ",", 
      RowBox[{"wi", "=", "False"}], ",", 
      RowBox[{"wip", "=", "False"}], ",", 
      RowBox[{"tFlag", "=", "False"}], ",", 
      RowBox[{"bFlag", "=", "False"}], ",", 
      RowBox[{"pFlag", "=", "False"}], ",", "lvLine", ",", "a", ",", "b", ",",
       "c", ",", "abcList", ",", "ba", ",", "bc", ",", "pb", ",", "pbaAngle", 
      ",", "pbcAngle", ",", "startJlistInt", ",", "m", ",", "bcVisiInt", ",", 
      "gLine", ",", "giList", ",", "giPoint", ",", "giLine", ",", 
      "abNotGlaInt", ",", "abNotVisInt", ",", "bcNotVisInt", ",", "collp", 
      ",", "bLast", ",", 
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"j", "=", "0"}], ",", "prevA", ",", "prevB", ",", "prevC", ",", 
      "postA", ",", "postB", ",", "tb", ",", "postC", ",", "pPostAB", ",", 
      "pPostBC", ",", "pbaColl", ",", "pbcColl", ",", "index", ",", "theta", 
      ",", 
      RowBox[{"gFlag", "=", "False"}], ",", "pprevbAngle", ",", "pbAngle"}], 
     "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"p", "=", "pm"}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"pointOnSegmentQ", "[", 
             RowBox[{"#", ",", "pm"}], "]"}], ")"}], ",", 
           RowBox[{"p", "=", 
            RowBox[{"pm", "-", 
             RowBox[{"0.00001", 
              RowBox[{"normalVector", "[", "#", "]"}]}]}]}]}], "]"}], "&"}], "/@", 
        RowBox[{"(", 
         RowBox[{"lineList", "@", 
          RowBox[{
          "polys", "\[LeftDoubleBracket]", "k", "\[RightDoubleBracket]"}]}], 
         ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"k", ",", "1", ",", "length"}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"Or", "@@", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"Or", "@@", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"index", "=", 
                 RowBox[{"Flatten", "@", 
                  RowBox[{"Position", "[", 
                   RowBox[{
                    RowBox[{
                    "polys", "\[LeftDoubleBracket]", "k", 
                    "\[RightDoubleBracket]"}], ",", "#"}], "]"}]}]}], ";", 
                RowBox[{"pm", "\[Equal]", "#"}]}], ")"}], "&"}], "/@", 
             RowBox[{
             "polys", "\[LeftDoubleBracket]", "k", 
              "\[RightDoubleBracket]"}]}], ")"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"k", ",", "1", ",", "length"}], "}"}]}], "]"}]}], ",", 
       RowBox[{"p", "=", 
        RowBox[{"pm", "-", " ", 
         RowBox[{"0.00001", 
          RowBox[{"(", 
           RowBox[{"Flatten", "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"polys", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", 
                RowBox[{"index", "-", "1"}]}], "\[RightDoubleBracket]"}], "+", 
              RowBox[{"polys", "\[LeftDoubleBracket]", 
               RowBox[{"1", ",", 
                RowBox[{"index", "+", "1"}]}], "\[RightDoubleBracket]"}]}], 
             ")"}]}], ")"}]}]}]}]}], "]"}], ";", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"infiniteLine", "=", 
      RowBox[{"{", 
       RowBox[{"p", ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0.11", ",", "0"}], "}"}], "+", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"MaximalBy", "[", 
             RowBox[{
              RowBox[{"Flatten", "[", 
               RowBox[{"polys", ",", "1"}], "]"}], ",", "First"}], "]"}], 
            "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}], ",", "y"}], 
          "}"}]}]}], "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"orderedList", "=", " ", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"testpoint", "[", 
           RowBox[{
            RowBox[{
            "polys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
            ",", "p"}], "]"}], ",", 
          RowBox[{"Reverse", "@", 
           RowBox[{
           "polys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
          ",", 
          RowBox[{
          "polys", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}], 
         "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", "1", ",", 
          RowBox[{"Length", "@", "polys"}], ",", "1"}], "}"}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"listofAllLines", "=", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"Join", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"lineList", "@", "#"}], ")"}], "&"}], "/@", 
          "orderedList"}], "]"}], ",", "1"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sortedList", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{
        RowBox[{"Flatten", "[", 
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"vertexList", "@", 
               RowBox[{"N", "@", "#"}]}], ")"}], "&"}], "/@", "orderedList"}],
            "]"}], ",", "1"}], "]"}], ",", 
        RowBox[{
         RowBox[{"angleSortCond", "[", 
          RowBox[{"p", ",", "#1", ",", "#2"}], "]"}], " ", "&"}]}], "]"}]}], 
     ";", "\[IndentingNewLine]", 
     RowBox[{"m", "=", 
      RowBox[{"Length", "@", "sortedList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SegmentIntersectionQ", "[", 
          RowBox[{"{", 
           RowBox[{"infiniteLine", ",", "#"}], "}"}], "]"}], ",", 
         RowBox[{"AppendTo", "[", 
          RowBox[{"jList", ",", 
           RowBox[{"Reverse", "@", "#"}]}], "]"}]}], "]"}], "&"}], "/@", 
      "listofAllLines"}], ";", "\[IndentingNewLine]", 
     RowBox[{"jList", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"jList", ",", 
        RowBox[{
         RowBox[{"distSortCond", "[", 
          RowBox[{"infiniteLine", ",", "#1", ",", "#2", ",", "p"}], "]"}], 
         "&"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"lvLine", "=", 
      RowBox[{"First", "@", "jList"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Table", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"SegmentIntersectionQ", "[", 
          RowBox[{"{", 
           RowBox[{"lvLine", ",", 
            RowBox[{
            "jList", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}]}],
            "}"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"startJlistInt", "=", 
           RowBox[{"N", "@", 
            RowBox[{"LineIntersectionPoint", "[", 
             RowBox[{"{", 
              RowBox[{"lvLine", ",", 
               RowBox[{
               "jList", "\[LeftDoubleBracket]", "i", 
                "\[RightDoubleBracket]"}]}], "}"}], "]"}]}]}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"noIntersection", "[", 
             RowBox[{"p", ",", "startJlistInt", ",", "listofAllLines"}], 
             "]"}], ",", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{"AppendTo", "[", 
              RowBox[{"visibleList", ",", "startJlistInt"}], "]"}], ";", 
             "\[IndentingNewLine]", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "startJlistInt", "\[LeftDoubleBracket]", "2", 
                 "\[RightDoubleBracket]"}], ">", 
                RowBox[{
                "p", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}],
                ",", 
               RowBox[{"lvLine", "=", 
                RowBox[{
                "jList", "\[LeftDoubleBracket]", "i", 
                 "\[RightDoubleBracket]"}]}]}], "]"}]}]}], "]"}]}]}], 
        "\[IndentingNewLine]", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "jList"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", "m"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"abcList", "=", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"a", ",", "b", ",", "c"}], "}"}], "=", 
          RowBox[{"sortedList", "\[LeftDoubleBracket]", 
           RowBox[{"i", ",", 
            RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pbAngle", "=", 
         RowBox[{"getAngle", "[", 
          RowBox[{"{", 
           RowBox[{"p", ",", "b"}], "}"}], "]"}]}], ";", 
        RowBox[{"pprevbAngle", "=", 
         RowBox[{"getAngle", "[", 
          RowBox[{"{", 
           RowBox[{"p", ",", "prevB"}], "}"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"prevA", ",", "prevB", ",", "prevC"}], "}"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[NotEqual]", " ", "1"}], ",", 
           RowBox[{"sortedList", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", "-", "1"}], ",", 
             RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"sortedList", "\[LeftDoubleBracket]", 
            RowBox[{"m", ",", 
             RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"postA", ",", "postB", ",", "postC"}], "}"}], "=", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"i", "\[NotEqual]", " ", "m"}], ",", 
           RowBox[{"sortedList", "\[LeftDoubleBracket]", 
            RowBox[{
             RowBox[{"i", "+", "1"}], ",", 
             RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}], ",", 
           RowBox[{"sortedList", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", 
             RowBox[{"1", ";;", "3"}]}], "\[RightDoubleBracket]"}]}], "]"}]}],
         ";", "\[IndentingNewLine]", 
        RowBox[{"tb", "=", 
         RowBox[{"N", "@", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"pointOnSegmentQ", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"p", ",", "a"}], "}"}], ",", "b"}], "]"}], ",", 
            RowBox[{"b", "+", 
             RowBox[{"0.00001", 
              RowBox[{"normalVector", "[", 
               RowBox[{"{", 
                RowBox[{"a", ",", "p"}], "}"}], "]"}]}]}], ",", "b"}], 
           "]"}]}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"ba", "=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "a"}], "}"}]}], ";", 
        RowBox[{"bc", "=", 
         RowBox[{"{", 
          RowBox[{"b", ",", "c"}], "}"}]}], ";", 
        RowBox[{"pb", "=", 
         RowBox[{"{", 
          RowBox[{"p", ",", "b"}], "}"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"pbaAngle", "=", 
         RowBox[{"getClockwiseAngle", "[", 
          RowBox[{"p", ",", "b", ",", "a"}], "]"}]}], ";", 
        RowBox[{"pbcAngle", "=", 
         RowBox[{"getClockwiseAngle", "[", 
          RowBox[{"p", ",", "b", ",", "c"}], "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"pPostAB", "=", 
         RowBox[{"getClockwiseAngle", "[", 
          RowBox[{"p", ",", "postB", ",", "postA"}], "]"}]}], ";", " ", 
        RowBox[{"pPostBC", "=", 
         RowBox[{"getClockwiseAngle", "[", 
          RowBox[{"p", ",", "postB", ",", "postC"}], "]"}]}], ";", 
        RowBox[{"pbaColl", "=", 
         RowBox[{"Not", "@", 
          RowBox[{"(", 
           RowBox[{"collinearQ", "[", 
            RowBox[{"{", 
             RowBox[{"p", ",", "b", ",", "a"}], "}"}], "]"}], ")"}]}]}], ";", 
        " ", 
        RowBox[{"pbcColl", "=", 
         RowBox[{"Not", "@", 
          RowBox[{"(", 
           RowBox[{"collinearQ", "[", 
            RowBox[{"{", 
             RowBox[{"p", ",", "b", ",", "c"}], "}"}], "]"}], ")"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"j", "+", "2"}], "\[Equal]", "i"}], ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{"tFlag", ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"visibleList", ",", "collp"}], "]"}], ";", 
              RowBox[{"tFlag", "=", "False"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"bFlag", ",", 
             RowBox[{
              RowBox[{"AppendTo", "[", 
               RowBox[{"visibleList", ",", "bLast"}], "]"}], ";", 
              RowBox[{"bFlag", "=", "False"}]}]}], "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{"pFlag", ",", 
             RowBox[{
              RowBox[{"Reverse", "@", "visibleList"}], ";", " ", 
              RowBox[{"PrependTo", "[", 
               RowBox[{"visibleList", ",", "collp"}], "]"}], ";", " ", 
              RowBox[{"pFlag", "=", "False"}]}]}], "]"}]}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"intersectInteriorQRev2", "[", 
           RowBox[{"p", ",", "abcList"}], "]"}], ",", 
          RowBox[{"wi", "=", "False"}], ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"i", "\[Equal]", "1"}], " ", "||", 
             RowBox[{"Not", "@", 
              RowBox[{"pointOnSegmentQ", "[", 
               RowBox[{"pb", ",", "a"}], "]"}]}]}], ",", 
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{"noIntersection", "[", 
               RowBox[{"p", ",", "b", ",", "jList"}], "]"}], ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"i", "\[NotEqual]", "1"}], ",", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"pbAngle", "\[NotEqual]", " ", "pprevbAngle"}], ",", 
                  RowBox[{"wi", "=", "True"}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"b", "\[Equal]", " ", "prevA"}], " ", "||", " ", 
                    RowBox[{"b", "\[Equal]", "prevC"}], " ", "||", " ", 
                    RowBox[{"b", "\[Equal]", " ", "postA"}], " ", "||", " ", 
                    RowBox[{"b", "\[Equal]", "postC"}], " ", "||", " ", 
                    "gFlag"}], ",", 
                    RowBox[{"wi", "=", "True"}], ",", 
                    RowBox[{"wi", "=", "False"}]}], "]"}]}], "]"}], ",", 
                RowBox[{"wi", "=", "True"}]}], "]"}], ",", 
              RowBox[{"wi", "=", "False"}]}], "]"}], ",", 
            RowBox[{"If", "[", 
             RowBox[{"wip", ",", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"noIntersection", "[", 
                 RowBox[{"b", ",", "a", ",", "jList"}], "]"}], ",", 
                RowBox[{"wi", "=", "True"}], ",", 
                RowBox[{"wi", "=", "False"}]}], "]"}], ",", 
              RowBox[{"wi", "=", "False"}]}], "]"}]}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{"wi", ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SegmentIntersectionQ", "[", 
              RowBox[{"{", 
               RowBox[{"lvLine", ",", "bc"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"bcVisiInt", "=", 
               RowBox[{"N", "@", 
                RowBox[{"LineIntersectionPoint", "[", 
                 RowBox[{"{", 
                  RowBox[{"lvLine", ",", "bc"}], "}"}], "]"}]}]}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"noIntersection", "[", 
                 RowBox[{"p", ",", "bcVisiInt", ",", "listofAllLines"}], 
                 "]"}], ",", "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"visibleList", ",", "bcVisiInt"}], "]"}]}], 
               "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"i", "\[NotEqual]", "1"}], "&&", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"pPostAB", ">", " ", "Pi"}], "&&", " ", 
                  RowBox[{"(", 
                   RowBox[{"pbaColl", "||", "pbcColl"}], ")"}]}], ")"}], "||", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"pbaAngle", "\[LessEqual]", " ", "Pi"}], "&&", 
                  RowBox[{"pPostAB", "\[Equal]", "0"}], " ", "&&", 
                  RowBox[{"pPostBC", "\[LessEqual]", " ", "Pi"}]}], ")"}]}], 
               ")"}], " ", "&&", 
              RowBox[{"pointOnSegmentQ", "[", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"p", ",", "postB"}], "}"}], ",", "b"}], "]"}]}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"Not", "@", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"pbaAngle", "\[LessEqual]", " ", "Pi"}], "&&", 
                   RowBox[{"pPostAB", "\[Equal]", "0"}]}], ")"}]}], ",", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"visibleList", ",", "b"}], "]"}]}], "]"}], ";", 
              "\[IndentingNewLine]", 
              RowBox[{"tFlag", "=", "True"}], ";", 
              RowBox[{"j", "=", "i"}]}]}], "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"Not", "@", 
              RowBox[{"(", 
               RowBox[{"pPostAB", ">", "0"}], ")"}]}], ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"i", "==", "1"}], ")"}], "&&", 
                 RowBox[{"pPostBC", "\[LessEqual]", " ", "Pi"}]}], ",", 
                RowBox[{"pFlag", "=", "True"}]}], "]"}], ";", 
              RowBox[{"j", "=", "i"}], ";", " ", 
              RowBox[{"bLast", "=", "b"}], ";", " ", 
              RowBox[{"bFlag", "=", "True"}], ";"}]}], "]"}], ";", 
           "\[IndentingNewLine]", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"glancingBlow", "[", 
               RowBox[{"p", ",", "abcList"}], "]"}], ")"}], ",", 
             RowBox[{"gFlag", "=", "False"}], ",", 
             RowBox[{"gFlag", "=", "True"}]}], " ", "]"}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"Not", "@", "bFlag"}], "&&", "gFlag"}], "||", " ", 
                "tFlag", "||", "pFlag"}], ")"}], "&&", 
              RowBox[{"(", 
               RowBox[{"Not", "@", 
                RowBox[{"pointOnSegmentQ", "[", 
                 RowBox[{"pb", ",", "prevB"}], "]"}]}], ")"}]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"gLine", "=", 
               RowBox[{"extendedLine", "[", 
                RowBox[{"p", ",", "tb"}], "]"}]}], ";", "\[IndentingNewLine]", 
              RowBox[{"giList", " ", "=", " ", 
               RowBox[{"Sort", "[", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"DeleteCases", "[", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"gLine", ",", "#"}], "}"}], "]"}], "||", " ", 
                    RowBox[{"And", "[", 
                    RowBox[{
                    RowBox[{"b", "\[NotEqual]", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"pointOnSegmentQ", "[", 
                    RowBox[{"gLine", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"gLine", ",", "#"}], "}"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"N", "@", 
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"gLine", ",", "#"}], "}"}], "]"}]}], ",", "#"}], 
                    "}"}], ",", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"And", "[", 
                    RowBox[{
                    RowBox[{"b", "\[NotEqual]", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], ",", 
                    RowBox[{"pointOnSegmentQ", "[", 
                    RowBox[{"gLine", ",", 
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}], ",", "#"}], "}"}], ",", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{
                    "#", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}], ",", "#"}], "}"}]}], "]"}]}], 
                    "]"}]}], "\[IndentingNewLine]", "]"}], "&"}], "/@", 
                    "jList"}], ")"}], ",", "Null"}], "]"}], ")"}], ",", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{
                    "#1", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}], "<", " ", 
                   RowBox[{"EuclideanDistance", "[", 
                    RowBox[{"p", ",", 
                    RowBox[{
                    "#2", "\[LeftDoubleBracket]", "1", 
                    "\[RightDoubleBracket]"}]}], "]"}]}], "&"}]}], "]"}]}], 
              ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"giList", "\[NotEqual]", 
                 RowBox[{"{", "}"}]}], ",", "\[IndentingNewLine]", 
                RowBox[{
                 RowBox[{"collp", "=", 
                  RowBox[{"giList", "\[LeftDoubleBracket]", 
                   RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                 "\[IndentingNewLine]", 
                 RowBox[{"If", "[", 
                  RowBox[{
                   RowBox[{"Not", "@", 
                    RowBox[{"(", 
                    RowBox[{"tFlag", " ", "&&", " ", "pFlag"}], ")"}]}], ",", 
                   "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"giPoint", "=", 
                    RowBox[{"giList", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "1"}], "\[RightDoubleBracket]"}]}], ";", 
                    RowBox[{"giLine", "=", 
                    RowBox[{"giList", "\[LeftDoubleBracket]", 
                    RowBox[{"1", ",", "2"}], "\[RightDoubleBracket]"}]}], ";",
                     "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"pointOnSegmentQ", "[", 
                    RowBox[{"lvLine", ",", "giPoint"}], "]"}], "&&", " ", 
                    RowBox[{
                    RowBox[{"Chop", "[", 
                    RowBox[{"getAngle", "[", "pb", "]"}], "]"}], 
                    "\[NotEqual]", " ", "0"}]}], ")"}], "\[IndentingNewLine]",
                     "||", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"giLine", ",", "lvLine"}], "}"}], "]"}], "&&", 
                    " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"giLine", ",", "lvLine"}], "}"}], "]"}], 
                    "\[Equal]", "giPoint"}], ")"}]}], ")"}], "||", 
                    RowBox[{"giPoint", "\[Equal]", 
                    RowBox[{
                    "lvLine", "\[LeftDoubleBracket]", "2", 
                    "\[RightDoubleBracket]"}]}]}], "\[IndentingNewLine]", ",", 
                    RowBox[{
                    RowBox[{"visibleList", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"visibleList", ",", 
                    RowBox[{"{", 
                    RowBox[{"giPoint", ",", "b"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"lvLine", "=", "ba"}]}], ",", 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"visibleList", "=", 
                    RowBox[{"Join", "[", 
                    RowBox[{"visibleList", ",", 
                    RowBox[{"{", 
                    RowBox[{"b", ",", "giPoint"}], "}"}]}], "]"}]}], ";", 
                    RowBox[{"lvLine", "=", "giLine"}]}]}], "]"}]}]}], 
                  "]"}]}]}], "]"}]}], "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"pbAngle", "\[NotEqual]", " ", "pprevbAngle"}], 
                  ")"}], "&&", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Not", "@", "bFlag"}], " ", "&&", " ", 
                    RowBox[{"Not", "@", "tFlag"}]}], ")"}], " ", "||", 
                   RowBox[{"j", "<", "i", "<", 
                    RowBox[{"j", "+", "2"}]}]}], " ", ")"}]}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"AppendTo", "[", 
                 RowBox[{"visibleList", ",", "b"}], "]"}]}], "]"}], ";", 
              RowBox[{"lvLine", "=", "ba"}], ";", "\[IndentingNewLine]", 
              RowBox[{"Table", "[", 
               RowBox[{
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"SegmentIntersectionQ", "[", 
                   RowBox[{"{", 
                    RowBox[{"ba", ",", 
                    RowBox[{
                    "jList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   RowBox[{"abNotGlaInt", "=", 
                    RowBox[{"N", "@", 
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"ba", ",", 
                    RowBox[{
                    "jList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}], "}"}], "]"}]}]}], ";", 
                   "\[IndentingNewLine]", 
                   RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"noIntersection", "[", 
                    RowBox[{"p", ",", "abNotGlaInt", ",", "listofAllLines"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"visibleList", ",", "abNotGlaInt"}], "]"}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"lvLine", "=", 
                    RowBox[{
                    "jList", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}]}]}]}], "]"}]}]}], "]"}], ",", 
                RowBox[{"{", 
                 RowBox[{"i", ",", "1", ",", 
                  RowBox[{"Length", "@", "jList"}], ",", "1"}], "}"}]}], 
               "]"}], ";"}]}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", ",", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"SegmentIntersectionQ", "[", 
              RowBox[{"{", 
               RowBox[{"pb", ",", "lvLine"}], "}"}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pbaAngle", "<", "pbcAngle"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Not", "@", 
                   RowBox[{"leftOrRight", "[", 
                    RowBox[{"p", ",", "b", ",", "a"}], "]"}]}], " ", ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"lvLine", ",", "ba"}], "}"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"abNotVisInt", "=", 
                    RowBox[{"N", "@", 
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"lvLine", ",", "ba"}], "}"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"noIntersection", "[", 
                    RowBox[{"p", ",", "abNotVisInt", ",", "listofAllLines"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"visibleList", ",", "abNotVisInt"}], "]"}], ";", 
                    RowBox[{"lvLine", "=", "ba"}]}]}], "]"}]}]}], "]"}]}], 
                 "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
              RowBox[{"If", "[", 
               RowBox[{
                RowBox[{"pbcAngle", "<", "pbaAngle"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"Not", "@", 
                   RowBox[{"leftOrRight", "[", 
                    RowBox[{"p", ",", "b", ",", "c"}], "]"}]}], ",", 
                  RowBox[{"If", "[", 
                   RowBox[{
                    RowBox[{"SegmentIntersectionQ", "[", 
                    RowBox[{"{", 
                    RowBox[{"lvLine", ",", "bc"}], "}"}], "]"}], ",", 
                    RowBox[{
                    RowBox[{"bcNotVisInt", "=", 
                    RowBox[{"N", "@", 
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"lvLine", ",", "bc"}], "}"}], "]"}]}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"noIntersection", "[", 
                    RowBox[{"p", ",", "bcNotVisInt", ",", "listofAllLines"}], 
                    "]"}], ",", "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"visibleList", ",", "bcNotVisInt"}], "]"}], ";", 
                    RowBox[{"lvLine", "=", "bc"}]}]}], "]"}]}]}], "]"}]}], 
                 "]"}]}], "]"}]}], "\[IndentingNewLine]", ",", 
             RowBox[{
              RowBox[{
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{"SegmentIntersectionQ", "[", 
                  RowBox[{"{", 
                   RowBox[{"#", ",", "lvLine"}], "}"}], "]"}], ",", 
                 RowBox[{
                  RowBox[{"AppendTo", "[", 
                   RowBox[{"visibleList", ",", 
                    RowBox[{"LineIntersectionPoint", "[", 
                    RowBox[{"{", 
                    RowBox[{"#", ",", "lvLine"}], "}"}], "]"}]}], "]"}], ";", 
                  RowBox[{"lvLine", "=", "#"}]}]}], "]"}], "&"}], "/@", 
              "jList"}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
         "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
        RowBox[{"wip", "=", "wi"}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"pbaAngle", "<", "Pi"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"jList", ",", "ba"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"pbcAngle", "<", "Pi"}], ",", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"jList", ",", "bc"}], "]"}]}], "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"jList", "=", 
         RowBox[{"(", 
          RowBox[{"DeleteCases", "[", 
           RowBox[{"jList", ",", 
            RowBox[{"{", 
             RowBox[{"_", ",", "b"}], "}"}]}], "]"}], ")"}]}], ";"}]}], 
      "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "visibleList"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7698005042478313`*^9, 3.7698005067611156`*^9}, {
   3.769800663565995*^9, 3.7698007120902953`*^9}, {3.769800821544349*^9, 
   3.769800821762767*^9}, {3.7698008895525713`*^9, 3.769800889827838*^9}, {
   3.769800922992238*^9, 3.769800928805654*^9}, {3.7698010094042263`*^9, 
   3.769801146391124*^9}, {3.769801183869901*^9, 3.7698012085657644`*^9}, {
   3.769801251149911*^9, 3.769801289881386*^9}, {3.769801325189013*^9, 
   3.769801652264784*^9}, {3.7698016951422124`*^9, 3.7698017424078417`*^9}, {
   3.769801787714773*^9, 3.7698018140434303`*^9}, {3.7698018558725963`*^9, 
   3.7698018589433875`*^9}, {3.7698062809785786`*^9, 3.769806289132785*^9}, {
   3.7699087285928154`*^9, 3.769908737056224*^9}, 3.769961379154033*^9, {
   3.769961439559438*^9, 3.7699614408390155`*^9}, {3.770400006911172*^9, 
   3.770400012242868*^9}, {3.770400042389982*^9, 3.7704000442729673`*^9}, {
   3.7704009994268675`*^9, 3.7704010943336606`*^9}, {3.7704036818987455`*^9, 
   3.7704036913076196`*^9}, {3.7711627139377656`*^9, 
   3.7711627349076447`*^9}, {3.7711627790203915`*^9, 3.771162814516395*^9}, 
   3.771162850380498*^9, {3.7711629060574417`*^9, 3.7711629438797865`*^9}, {
   3.771162978839809*^9, 3.7711630033203006`*^9}, {3.7711632945606613`*^9, 
   3.771163322274009*^9}, {3.7711645614492736`*^9, 3.77116471732237*^9}, {
   3.771164770309903*^9, 3.7711647706395025`*^9}, {3.771777646430233*^9, 
   3.771777957480303*^9}, 3.7717784613571343`*^9, {3.7717821585367117`*^9, 
   3.7717822358102427`*^9}, {3.77178364221205*^9, 3.771783644424407*^9}, 
   3.7717836760468683`*^9, {3.771783734087491*^9, 3.7717838015425777`*^9}, {
   3.7717838388101234`*^9, 3.7717838745449905`*^9}, {3.7717839363766108`*^9, 
   3.7717839462750535`*^9}, {3.7717839776811614`*^9, 
   3.7717839807928267`*^9}, {3.7717840114852448`*^9, 3.771784076598447*^9}, {
   3.771784167174958*^9, 3.7717843507775545`*^9}, {3.7717844037619424`*^9, 
   3.7717844590921974`*^9}, {3.771784509672432*^9, 3.7717845437822413`*^9}, {
   3.7717845859756308`*^9, 3.771784630014027*^9}, {3.7717846622415733`*^9, 
   3.7717846931467*^9}, {3.7717847879360185`*^9, 3.771784790476824*^9}, {
   3.771785128256211*^9, 3.771785153447566*^9}, 3.771794969612465*^9, {
   3.7717950242776937`*^9, 3.771795256392707*^9}, {3.7717952921361847`*^9, 
   3.771795353558486*^9}, {3.7717961515105257`*^9, 3.77179619045815*^9}, {
   3.7717963679262133`*^9, 3.771796462239355*^9}, {3.771796511240015*^9, 
   3.771796573897749*^9}, {3.771842898089777*^9, 3.7718429403457904`*^9}, {
   3.7719610986286545`*^9, 3.771961244604424*^9}, {3.771961284837776*^9, 
   3.771961313040526*^9}, {3.7719613440237694`*^9, 3.7719613462439384`*^9}, {
   3.7719614154548655`*^9, 3.771961451749844*^9}, {3.7719614906548386`*^9, 
   3.7719615102169437`*^9}, {3.7719615678921137`*^9, 3.771961573627469*^9}, {
   3.771961658105631*^9, 3.7719617764410768`*^9}, {3.771962223139771*^9, 
   3.771962312151781*^9}, {3.7719623546938057`*^9, 3.7719624070716114`*^9}, {
   3.771962465499015*^9, 3.7719624875279465`*^9}, {3.771962524690345*^9, 
   3.7719625653849564`*^9}, {3.771962603390987*^9, 3.7719626062154503`*^9}, 
   3.7722206247259855`*^9, {3.7722206862467413`*^9, 3.77222076189198*^9}, {
   3.772221007386054*^9, 3.7722211098525457`*^9}, {3.7722211828174453`*^9, 
   3.7722211884926105`*^9}, {3.7722212237095065`*^9, 
   3.7722212625295534`*^9}, {3.7722213190006304`*^9, 3.772221423190547*^9}, {
   3.772221463128175*^9, 3.7722214637182617`*^9}, {3.772221505624196*^9, 
   3.7722219936266375`*^9}, {3.772223341815149*^9, 3.7722233677641225`*^9}, {
   3.7722247755103445`*^9, 3.7722247894744368`*^9}, {3.7722251018338804`*^9, 
   3.7722251048833895`*^9}, {3.7729842957160206`*^9, 3.772984304955039*^9}, 
   3.772985541507193*^9, {3.7729855772117596`*^9, 3.772985584887515*^9}, {
   3.7729858878335037`*^9, 3.772985900062381*^9}, {3.7729860345526695`*^9, 
   3.7729860627806644`*^9}, 3.772988070017886*^9, {3.7729885642031775`*^9, 
   3.7729885657989197`*^9}, {3.7729886245817733`*^9, 3.772988630947749*^9}, {
   3.7729889277339997`*^9, 3.7729889374466968`*^9}, {3.7729898006937017`*^9, 
   3.772989831448451*^9}, {3.772995741022297*^9, 3.772995803540862*^9}, {
   3.7729960200413637`*^9, 3.7729960204841747`*^9}, {3.7729962070387707`*^9, 
   3.772996215211237*^9}, {3.772996732350994*^9, 3.7729967495962696`*^9}, {
   3.772997077538068*^9, 3.7729970910558977`*^9}, {3.7729971876676226`*^9, 
   3.772997211822091*^9}, {3.772997322168092*^9, 3.772997331829231*^9}, 
   3.7729975984414873`*^9},
 CellLabel->"In[1]:=",ExpressionUUID->"27e2e2df-3c39-4f6b-95e4-036ec10f660d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "true", " ", "if", " ", "pt", "  ", "is", " ", "inside", " ", "polygon"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"testpoint", "[", 
    RowBox[{"poly_", ",", "pt_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Round", "[", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"Total", "@", 
         RowBox[{"Mod", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"#", "-", 
               RowBox[{"RotateRight", "[", "#", "]"}]}], ")"}], "&"}], "@", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"ArcTan", "@@", 
                RowBox[{"(", 
                 RowBox[{"pt", "-", "#"}], ")"}]}], "&"}], "/@", "poly"}], 
             ")"}]}], ",", 
           RowBox[{"2", " ", "Pi"}], ",", 
           RowBox[{"-", "Pi"}]}], "]"}]}], "/", "2"}], "/", "Pi"}], ")"}], 
     "]"}], "\[NotEqual]", "0"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7635624224713607`*^9, 3.7635624330425425`*^9}, {
  3.763579666001822*^9, 3.7635796671075287`*^9}, {3.764541623441715*^9, 
  3.764541692274987*^9}, {3.7645417401984043`*^9, 3.764541752748008*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"489dc7cc-4609-4a3a-b301-7e75ad24757d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Returns", " ", "a", " ", "Nested", " ", "list", " ", "of", " ", "pair", 
    " ", "of", " ", "points", " ", "representing", " ", "each", " ", "line", 
    " ", "in", " ", "polygon"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"lineList", "[", "list_", "]"}], ":=", 
    RowBox[{"Partition", "[", 
     RowBox[{
      RowBox[{"Append", "[", 
       RowBox[{"list", ",", 
        RowBox[{"First", "[", "list", "]"}]}], "]"}], ",", "2", ",", "1"}], 
     "]"}]}], ";"}], " "}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.760802532026407*^9, 3.7608026249231467`*^9}, {
  3.760802678975656*^9, 3.760802687697389*^9}, {3.760803348506281*^9, 
  3.760803349726018*^9}},
 CellLabel->"In[3]:=",
 CellID->141966600,ExpressionUUID->"1c5da78c-468b-4edc-9d12-bdd89d1e53bd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "a", " ", "Vector", " ", "for", " ", "a", " ", "line", " ",
     "between", " ", "two", " ", "points"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"vector", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"x2", "-", "x1"}], ",", 
     RowBox[{"y2", "-", "y1"}]}], "}"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7584068810924025`*^9, 3.75840691133554*^9}, 
   3.7585649723581924`*^9, 3.7590244926122665`*^9, {3.761068203338044*^9, 
   3.761068204944496*^9}, {3.7610689112909594`*^9, 3.761068916365572*^9}},
 CellLabel->"In[4]:=",
 CellID->126976910,ExpressionUUID->"73000d20-a362-4638-81c8-256171429fad"],

Cell[BoxData[
 RowBox[{
  RowBox[{"vertexList", "[", "list_", "]"}], ":=", 
  RowBox[{"Partition", "[", 
   RowBox[{
    RowBox[{"Join", "[", 
     RowBox[{"list", ",", 
      RowBox[{"list", "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], "]"}], ",", "3",
     ",", "1"}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7632217125289803`*^9, 3.76322172258762*^9}, {
   3.7632255886478095`*^9, 3.7632255905058174`*^9}, {3.7632256227611103`*^9, 
   3.763225629488167*^9}, 3.7632256596711035`*^9, {3.7632257080789433`*^9, 
   3.76322578038266*^9}, {3.7632272291279907`*^9, 3.763227236570083*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"cee72fa1-6022-4201-88c7-59b2a292d876"],

Cell[BoxData[
 RowBox[{
  RowBox[{"angleSortCond", "[", 
   RowBox[{"point_", ",", "l1_", ",", "l2_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"getAngle", "[", 
        RowBox[{"{", 
         RowBox[{"point", ",", 
          RowBox[{
          "l1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}]}], ",", 
      RowBox[{"b", "=", 
       RowBox[{"getAngle", "[", 
        RowBox[{"{", 
         RowBox[{"point", ",", 
          RowBox[{
          "l2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
         "}"}], "]"}]}], ",", 
      RowBox[{"c", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{"point", "-", 
         RowBox[{
         "l1", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "]"}]}], ",", 
      RowBox[{"d", "=", 
       RowBox[{"Norm", "[", 
        RowBox[{"point", "-", 
         RowBox[{
         "l2", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
        "]"}]}]}], "}"}], ",", 
    RowBox[{
     RowBox[{"a", "<", "b"}], "||", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"a", "\[Equal]", "b"}], " ", "&&", "  ", 
       RowBox[{"c", "<", "d"}]}], ")"}]}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.764968817029722*^9, 3.7649688201477723`*^9}, {
   3.7649694483335238`*^9, 3.764969488981026*^9}, 3.7649695508222656`*^9, {
   3.76539679410841*^9, 3.7653968235457196`*^9}, {3.765396939734459*^9, 
   3.765396945972781*^9}, {3.765410610607728*^9, 3.765410708330372*^9}, {
   3.7654107384698524`*^9, 3.765410748751981*^9}, {3.767112538244009*^9, 
   3.7671125609383097`*^9}, {3.7671126086995125`*^9, 3.767112630570035*^9}, {
   3.767112667798407*^9, 3.767112791816635*^9}, {3.7671128295816565`*^9, 
   3.7671128382583942`*^9}, {3.767112875834901*^9, 3.767112886280945*^9}, 
   3.769956482714588*^9, {3.770566151023616*^9, 3.7705661525393467`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c51f5954-0da3-49f3-915a-f6169e1dbd67"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{" ", 
     RowBox[{"Returns", " ", "the", " ", "angle", " ", "made", " ", 
      RowBox[{"in", " ", "[", 
       RowBox[{"o", ",", 
        RowBox[{"2", "Pi"}]}]}]}], ")"}], " ", "Range"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Reference", ":", " ", "https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "111629"}], "/", "calculating"}], "-", "the", "-",
      "angle", "-", "between", "-", "the", "-", "line", "-", "joining", "-", 
     "two", "-", "points", "-", "and", "-", "the", "-", "x", "-", "axis"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"getAngle", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Mod", "[", 
    RowBox[{
     RowBox[{"ArcTan", "[", 
      RowBox[{
       RowBox[{"x2", "-", "x1"}], ",", 
       RowBox[{"y2", "-", "y1"}]}], "]"}], ",", 
     RowBox[{"2", " ", "\[Pi]"}]}], "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.762211812183926*^9, 3.762211812227189*^9}, {
  3.762212133389465*^9, 3.7622121673627377`*^9}, {3.762212462429222*^9, 
  3.762212464180242*^9}, {3.7622125740765963`*^9, 3.7622125761070414`*^9}, {
  3.762212606447076*^9, 3.7622126078563104`*^9}, {3.762212782962586*^9, 
  3.762212784950568*^9}, {3.7622129567595778`*^9, 3.762212959837753*^9}, {
  3.7622138703932433`*^9, 3.7622138731561513`*^9}, {3.762393097385004*^9, 
  3.7623931256973104`*^9}, {3.762393422476513*^9, 3.762393430482111*^9}, {
  3.7623938017506027`*^9, 3.7623938052821507`*^9}, {3.76239386930202*^9, 
  3.7623938920402184`*^9}, {3.7623940390591536`*^9, 3.7623940446881514`*^9}},
 CellLabel->"In[7]:=",ExpressionUUID->"8606bed4-916d-489a-89d9-6f016c2a88c4"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "The", " ", "parametric", " ", "equation", " ", "of", " ", "the", " ", 
     "line", " ", "containing", " ", "the", " ", "points", " ", 
     FormBox["a",
      TraditionalForm], " ", "and", " ", 
     FormBox["b",
      TraditionalForm], " ", "is", " ", 
     FormBox[
      RowBox[{"a", "+", 
       RowBox[{"\[Lambda]", " ", 
        RowBox[{"(", 
         RowBox[{"b", "-", "a"}], ")"}]}]}],
      TraditionalForm]}], ",", " ", 
    RowBox[{"where", " ", 
     FormBox[
      RowBox[{"0", "\[LessEqual]", "\[Lambda]", "\[LessEqual]", "1"}],
      TraditionalForm], " ", "for", " ", "points", " ", "between", " ", 
     FormBox["a",
      TraditionalForm], " ", "and", " ", 
     RowBox[{
      FormBox["b",
       TraditionalForm], ".", " ", "The"}], " ", "value", " ", "of", " ", 
     FormBox["\[Lambda]",
      TraditionalForm], " ", "is", " ", "given", " ", "by"}]}], "*)"}], 
  RowBox[{
   RowBox[{
    RowBox[{"\[Lambda]", "[", 
     RowBox[{"{", 
      RowBox[{"a_", ",", "b_"}], "}"}], "]"}], "[", "p_", "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "p"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}], ".", 
     RowBox[{"(", 
      RowBox[{"a", "-", "b"}], ")"}]}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.4281084522943907`*^9, 3.428108457088719*^9}, 
   3.4281085989154177`*^9, {3.428109418727551*^9, 3.428109419857239*^9}, {
   3.428117842316123*^9, 3.4281178428869658`*^9}, {3.4281179104322577`*^9, 
   3.428117911200409*^9}, 3.4281192939076843`*^9, {3.428145787108582*^9, 
   3.4281457888069077`*^9}, {3.50090385468817*^9, 3.5009038573034554`*^9}, {
   3.761605768653043*^9, 3.7616057689312773`*^9}, 3.761605910628242*^9, {
   3.7626542824215937`*^9, 3.7626542886133804`*^9}, {3.7626543313306875`*^9, 
   3.762654333925927*^9}, {3.7653973817649574`*^9, 3.7653973922519383`*^9}},
 CellLabel->"In[8]:=",
 CellID->91357628,ExpressionUUID->"a7cccfd8-a907-43ad-b649-59ca4fe78d7d"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"for", " ", 
     FormBox["p",
      TraditionalForm], " ", "on", " ", "the", " ", 
     RowBox[{"line", ".", " ", "For"}], " ", 
     FormBox["p",
      TraditionalForm], " ", "not", " ", "on", " ", "the", " ", "line"}], ",",
     " ", 
    RowBox[{
     FormBox["\[Lambda]",
      TraditionalForm], " ", "gives", " ", "the", " ", "closest", " ", 
     "point", " ", "on", " ", "the", " ", 
     RowBox[{"line", "."}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Two", " ", "lines"}], ",", " ", 
    RowBox[{
     SubscriptBox["L", 
      RowBox[{"1", " "}]], "containing", " ", "the", " ", "points", " ", "a", 
     " ", "and", " ", "b", " ", "with", " ", "line", " ", 
     FormBox[
      SubscriptBox["L", "2"],
      TraditionalForm], " ", "containing", " ", "the", " ", "points", " ", 
     FormBox["c",
      TraditionalForm], " ", "and", " ", 
     FormBox["d",
      TraditionalForm]}], ",", " ", 
    RowBox[{"intersect", " ", "at", " ", "a", " ", 
     RowBox[{
      RowBox[{"point", " ", "\[DoubleLongLeftRightArrow]", " ", 
       FormBox[
        RowBox[{
         FormBox[
          TagBox[
           RowBox[{"\[LeftBracketingBar]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"a", "-", "b"}], ",", 
              RowBox[{"c", "-", "d"}]}], "}"}], "\[RightBracketingBar]"}],
           {Det}],
          TraditionalForm], "\[NotEqual]", "0"}],
        TraditionalForm]}], ".", "  ", "Compute"}], " ", "the", " ", 
     "intersection", " ", 
     RowBox[{"point", ":"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"LineIntersectionPoint", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"a_", ",", "b_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"c_", ",", "d_"}], "}"}]}], "}"}], "]"}], ":=", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"Det", "[", 
       RowBox[{"{", 
        RowBox[{"a", ",", "b"}], "}"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"c", "-", "d"}], ")"}]}], "-", 
     RowBox[{
      RowBox[{"Det", "[", 
       RowBox[{"{", 
        RowBox[{"c", ",", "d"}], "}"}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{"a", "-", "b"}], ")"}]}]}], 
    RowBox[{"Det", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"a", "-", "b"}], ",", 
       RowBox[{"c", "-", "d"}]}], "}"}], "]"}]]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.35696210375764*^9, {3.4281084522943907`*^9, 3.428108457088719*^9}, 
   3.4281085989154177`*^9, {3.428109418727551*^9, 3.428109419857239*^9}, {
   3.428117842316123*^9, 3.4281178428869658`*^9}, {3.4281179104322577`*^9, 
   3.428117911200409*^9}, 3.4281192939076843`*^9, {3.428145787108582*^9, 
   3.4281457888069077`*^9}, {3.50090385468817*^9, 3.5009038573034554`*^9}, {
   3.5009039001263857`*^9, 3.500903903357723*^9}, 3.500904008130921*^9, {
   3.5009048198824835`*^9, 3.50090482194969*^9}, {3.7616057550025682`*^9, 
   3.7616057609376574`*^9}, 3.7646110289073915`*^9},
 CellLabel->"In[9]:=",
 CellID->1379934535,ExpressionUUID->"0b63a5b3-ab3d-4c25-b8f0-e4fcc0c54efc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Use", " ", 
    FormBox[
     RowBox[{
      FormBox[
       TagBox[
        RowBox[{"\[LeftBracketingBar]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"a", "-", "b"}], ",", 
           RowBox[{"c", "-", "d"}]}], "}"}], "\[RightBracketingBar]"}],
        {Det}],
       TraditionalForm], "\[NotEqual]", "0"}],
     TraditionalForm], " ", "along", " ", "with", " ", "the", " ", 
    "condition", " ", 
    FormBox[
     RowBox[{"0", "\[LessEqual]", "\[Lambda]", "\[LessEqual]", "1"}],
     TraditionalForm], " ", "to", " ", "determine", " ", "whether", " ", 
    "two", " ", "segments", " ", 
    RowBox[{"intersect", ":"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SegmentIntersectionQ", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"p1", ":", 
        RowBox[{"{", 
         RowBox[{"a_", ",", "b_"}], "}"}]}], ",", 
       RowBox[{"p2", ":", 
        RowBox[{"{", 
         RowBox[{"c_", ",", "d_"}], "}"}]}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{",", "endpoints_"}], "*)"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"roundoff", "=", "0.0000001"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Chop", "@", 
          RowBox[{"Det", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"a", "-", "b"}], ",", 
             RowBox[{"c", "-", "d"}]}], "}"}], "]"}]}], "\[Equal]", "0"}], 
        ",", "False", ",", "\[IndentingNewLine]", 
        RowBox[{"Module", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p", "=", 
            RowBox[{"Round", "[", 
             RowBox[{
              RowBox[{"LineIntersectionPoint", "[", 
               RowBox[{"{", 
                RowBox[{"p1", ",", "p2"}], "}"}], "]"}], ",", "roundoff"}], 
             "]"}]}], "}"}], ",", "\[IndentingNewLine]", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"0", "<", 
              RowBox[{
               RowBox[{"\[Lambda]", "[", "p1", "]"}], "[", "p", "]"}], "<", 
              "1"}], ")"}], " ", "&&", 
            RowBox[{"(", 
             RowBox[{"0", "<", 
              RowBox[{
               RowBox[{"\[Lambda]", "[", "p2", "]"}], "[", "p", "]"}], "<", 
              "1"}], ")"}], "&&", " ", 
            RowBox[{"Not", "@", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"p", "\[Equal]", " ", 
                RowBox[{"Round", "[", 
                 RowBox[{"a", ",", "roundoff"}], "]"}]}], "||", "  ", 
               RowBox[{"p", "\[Equal]", " ", 
                RowBox[{"Round", "[", 
                 RowBox[{"b", " ", ",", "roundoff"}], "]"}]}], "||", "  ", 
               RowBox[{"p", "\[Equal]", " ", 
                RowBox[{"Round", "[", 
                 RowBox[{"c", ",", "roundoff"}], "]"}]}], "||", "  ", 
               RowBox[{"p", "\[Equal]", 
                RowBox[{"Round", "[", 
                 RowBox[{"d", ",", "roundoff"}], "]"}]}]}], ")"}]}]}], 
           ")"}]}], " ", "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "made", " ", "a", "  ", "change", " ", "in", " ", "the", " ", 
      "condition", " ", "to", " ", "ignore", " ", "the", " ", "end", " ", 
      "points", " ", 
      RowBox[{"i", ".", "e"}], " ", "return", " ", "false", " ", "if", " ", 
      "p"}], " ", "\[Equal]", " ", 
     RowBox[{"end", " ", "points", " ", "and", " ", 
      RowBox[{"chop", "@", "p"}]}]}], "*)"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.4281120146814823`*^9, 3.428112038173441*^9}, {
   3.4281156218433657`*^9, 3.428115623999099*^9}, {3.428117226280767*^9, 
   3.428117227670485*^9}, {3.428117869609064*^9, 3.428117887706465*^9}, 
   3.428117957558598*^9, {3.4281190826590567`*^9, 3.4281190913794613`*^9}, {
   3.42811912287589*^9, 3.428119141904117*^9}, {3.4281191810207863`*^9, 
   3.4281191816062098`*^9}, {3.428120493598702*^9, 3.428120496943215*^9}, {
   3.428145791126446*^9, 3.428145800901572*^9}, {3.500889749371381*^9, 
   3.500889800208735*^9}, 3.5009034278288603`*^9, 3.5009038327477703`*^9, {
   3.500904329717358*^9, 3.5009043324100313`*^9}, {3.7615783582430353`*^9, 
   3.7615783608420687`*^9}, {3.7615784098649197`*^9, 
   3.7615784623365545`*^9}, {3.7615785340138035`*^9, 
   3.7615785412933445`*^9}, {3.761578623094496*^9, 3.7615786263358383`*^9}, {
   3.761578699864112*^9, 3.761578746837474*^9}, {3.7616057453114967`*^9, 
   3.761605746258957*^9}, {3.7626536723509507`*^9, 3.762653677816164*^9}, {
   3.762653926453739*^9, 3.762653928787074*^9}, {3.7626541830724773`*^9, 
   3.7626542003908863`*^9}, {3.7635775164198837`*^9, 
   3.7635775259739723`*^9}, {3.7635778270623765`*^9, 3.763577836000063*^9}, {
   3.7635790725384912`*^9, 3.763579190961801*^9}, {3.7635792381035557`*^9, 
   3.763579242357274*^9}, {3.763579365272222*^9, 3.7635794041264677`*^9}, {
   3.7635794875724025`*^9, 3.7635794883617067`*^9}, {3.7635806648743563`*^9, 
   3.763580686258615*^9}, {3.7635808515727286`*^9, 3.763580898507636*^9}, {
   3.7635816496363373`*^9, 3.7635817073519993`*^9}, {3.7638247263347735`*^9, 
   3.763824737539774*^9}, {3.7638248118710976`*^9, 3.7638248133341866`*^9}, {
   3.763824880121635*^9, 3.763824950105522*^9}, {3.763915916540468*^9, 
   3.7639159694889126`*^9}, {3.763916431909709*^9, 3.763916444728441*^9}, {
   3.7646846348426485`*^9, 3.7646846694980593`*^9}, {3.7646849520400696`*^9, 
   3.764684974069209*^9}, {3.7646879506379757`*^9, 3.764687978064746*^9}, {
   3.7646882242530756`*^9, 3.76468822925671*^9}, {3.765393656785784*^9, 
   3.7653936762842746`*^9}, {3.7653956196574183`*^9, 3.76539563686759*^9}, {
   3.7653959660144067`*^9, 3.7653959897580557`*^9}, {3.7653974058276978`*^9, 
   3.765397456765642*^9}, {3.765407350847313*^9, 3.7654073645559006`*^9}, {
   3.7654148839318104`*^9, 3.765415084507468*^9}, {3.7654154619835644`*^9, 
   3.765415512328901*^9}, {3.7654155496778045`*^9, 3.765415561186323*^9}, {
   3.76541563077349*^9, 3.7654156389921713`*^9}, {3.765415675423483*^9, 
   3.7654156766741476`*^9}, {3.7654160373306355`*^9, 3.765416045616802*^9}, {
   3.7654162204037886`*^9, 3.765416225909351*^9}, {3.765416261748746*^9, 
   3.7654162719708166`*^9}, {3.7654239425113354`*^9, 3.76542402025681*^9}, {
   3.7654240605261145`*^9, 3.765424076779188*^9}, {3.76542415841739*^9, 
   3.765424186235385*^9}, {3.765424239584928*^9, 3.7654242571113424`*^9}, {
   3.769958006384404*^9, 3.769958062778595*^9}},
 CellLabel->"In[10]:=",
 CellID->1016457520,ExpressionUUID->"ef6b92ba-e910-42c9-9ea0-866c5cdeb63b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"distSortCond", "[", 
   RowBox[{"line_", ",", "l1_", ",", "l2_", ",", "point_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"a", "=", 
       RowBox[{"EuclideanDistance", "[", 
        RowBox[{
         RowBox[{"LineIntersectionPoint", "[", 
          RowBox[{"Chop", "@", 
           RowBox[{"{", 
            RowBox[{"line", ",", "l1"}], "}"}]}], "]"}], ",", "point"}], 
        "]"}]}], ",", 
      RowBox[{"b", "=", 
       RowBox[{"EuclideanDistance", "[", 
        RowBox[{
         RowBox[{"LineIntersectionPoint", "[", 
          RowBox[{"Chop", "@", 
           RowBox[{"{", 
            RowBox[{"line", ",", "l2"}], "}"}]}], "]"}], ",", "point"}], 
        "]"}]}]}], "}"}], ",", 
    RowBox[{"a", "<", "b"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7649691805534678`*^9, 3.764969292155766*^9}, {
  3.764969432467591*^9, 3.7649694409428687`*^9}, {3.764969479992117*^9, 
  3.7649694909523163`*^9}},
 CellLabel->"In[11]:=",ExpressionUUID->"2ce32eea-1519-4da2-9881-eb2c7572e819"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "True", " ", "if", " ", "w2", " ", "is", " ", "Interior", " ", "vertex", 
    " ", "from", " ", "p"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"intersectInteriorQRev2", "[", 
     RowBox[{"p_", ",", 
      RowBox[{"{", 
       RowBox[{"w1_", ",", "w2_", ",", "w3_"}], "}"}]}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"getClockwiseAngle", "[", 
          RowBox[{"w1", ",", "w2", ",", "w3"}], "]"}]}], ",", 
        RowBox[{"b", "=", " ", 
         RowBox[{"getClockwiseAngle", "[", 
          RowBox[{"p", ",", "w2", ",", "w3"}], "]"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"b", "\[Equal]", "0"}], ",", 
         RowBox[{"b", "=", "6.28319"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"a", ">", "b"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
    "Clockwise", " ", "angle", " ", "bwtween", " ", "tw", " ", "o", " ", 
     "vectors"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{"https", ":"}], "//", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"adndevblog", ".", "typepad", ".", "com"}], "/", 
          "manufacturing"}], "/", "2012"}], "/", "07"}], "/", "finding"}], 
      "-", "the", "-", "angle", "-", "between", "-", "two", "-", "vectors", 
      "-", "along", "-", "a", "-", "given", "-", "direction", "-", "anti", 
      "-", "clockwise", "-", "or", "-", 
      RowBox[{"clockwise", ".", "html"}]}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"getClockwiseAngle", "[", 
     RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"a", "=", 
         RowBox[{"(", 
          RowBox[{"p3", "-", "p2"}], ")"}]}], ",", 
        RowBox[{"b", "=", 
         RowBox[{"(", 
          RowBox[{"p1", "-", "p2"}], ")"}]}]}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"AppendTo", "[", 
        RowBox[{"a", ",", "0"}], "]"}], ";", 
       RowBox[{"AppendTo", "[", 
        RowBox[{"b", ",", "0"}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Cross", "[", 
             RowBox[{"a", ",", "b"}], "]"}], "\[LeftDoubleBracket]", "3", 
            "\[RightDoubleBracket]"}], ")"}], "<", " ", "0"}], ",", 
         RowBox[{"Chop", "@", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", "Pi"}], " ", "-", 
            RowBox[{"VectorAngle", "[", 
             RowBox[{"a", ",", "b"}], "]"}]}], ")"}]}], ",", 
         RowBox[{"Chop", "@", 
          RowBox[{"VectorAngle", "[", 
           RowBox[{"a", ",", "b"}], "]"}]}]}], "]"}]}]}], 
     "]"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{
  3.7632417874795303`*^9, {3.763241834836933*^9, 3.7632420185773973`*^9}, {
   3.763242074854607*^9, 3.763242077918415*^9}, {3.763242112617639*^9, 
   3.763242124713317*^9}, {3.7632422161269245`*^9, 3.76324230355222*^9}, {
   3.763242734899631*^9, 3.763242892686514*^9}, {3.7632429774279547`*^9, 
   3.763243073933981*^9}, {3.763243226964872*^9, 3.763243464738119*^9}, {
   3.7632444349829597`*^9, 3.7632445753932333`*^9}, {3.764528219689684*^9, 
   3.7645282201844997`*^9}, {3.7654119561001654`*^9, 
   3.7654119563453193`*^9}, {3.7654119989827805`*^9, 
   3.7654120057366543`*^9}, {3.7654123322896976`*^9, 
   3.7654123343788958`*^9}, {3.765412365173065*^9, 3.7654123863739414`*^9}, {
   3.765412451318892*^9, 3.7654125423451333`*^9}, {3.765412658894041*^9, 
   3.7654127021985235`*^9}, {3.765412740072564*^9, 3.7654128111665483`*^9}, {
   3.765412978299034*^9, 3.7654129838292217`*^9}, {3.7654130179461584`*^9, 
   3.7654131257825747`*^9}, {3.7705744677772493`*^9, 
   3.7705744679257545`*^9}, {3.770599106752963*^9, 3.770599107208674*^9}, {
   3.770600097857574*^9, 3.770600208143329*^9}, {3.770600332760761*^9, 
   3.770600383266607*^9}},
 CellLabel->"In[12]:=",ExpressionUUID->"155ff77f-05d4-4dc5-b4cf-48e7b762424f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pointOnSegmentQ", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"x3_", ",", "y3_"}], "}"}]}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"ABv", " ", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x2", "-", "x1"}], ",", 
         RowBox[{"y2", "-", "y1"}], ",", "0"}], "}"}]}], ",", 
      RowBox[{"ACv", "=", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x3", "-", "x1"}], ",", 
         RowBox[{"y3", "-", "y1"}], ",", "0"}], "}"}]}], ",", "Kac", ",", 
      "Kab"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{"If", "[", 
     RowBox[{
      RowBox[{"And", "@@", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Chop", "@", "#"}], "\[Equal]", "0"}], ")"}], "&"}], "/@", 
         RowBox[{"Cross", "[", 
          RowBox[{"ABv", ",", "ACv"}], "]"}]}], ")"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Kac", "=", 
        RowBox[{"(", 
         RowBox[{"ABv", ".", "ACv"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Kab", "=", 
        RowBox[{"(", 
         RowBox[{"ABv", ".", "ABv"}], ")"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"Kac", "<", " ", "0"}], ",", "False", ",", 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"Kac", ">", "Kab"}], ",", "False", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"0", "<", " ", "Kac", "<", "Kab"}], ",", "True", ",", 
             "False"}], "]"}]}], "\[IndentingNewLine]", "]"}]}], "]"}]}], ",",
       "False"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7626994408605223`*^9, 3.7626994957070084`*^9}, {
   3.7626995310477943`*^9, 3.762699587109696*^9}, {3.7626997083021026`*^9, 
   3.762699712423989*^9}, {3.7626997510556707`*^9, 3.7626997554851513`*^9}, {
   3.7626997952220106`*^9, 3.7626998738837285`*^9}, 3.762699908937931*^9, {
   3.7626999424881754`*^9, 3.762700278668273*^9}, {3.7627003185755424`*^9, 
   3.762700395534641*^9}, {3.7627004795581913`*^9, 3.7627007245802183`*^9}, {
   3.762700775106859*^9, 3.762700996176547*^9}, {3.762701026237877*^9, 
   3.7627011139799204`*^9}, {3.762701163207965*^9, 3.762701222995221*^9}, 
   3.7627012553188334`*^9, {3.7627013084762263`*^9, 3.7627013109520063`*^9}, 
   3.7645200742116685`*^9, {3.7645205722197084`*^9, 3.7645206536940107`*^9}, 
   3.7649910836569967`*^9, {3.764991133396474*^9, 3.764991190953382*^9}, {
   3.7649912752832913`*^9, 3.7649912807513027`*^9}, {3.7649913237317915`*^9, 
   3.7649913265930767`*^9}, 3.764991376340988*^9, {3.7654138107436743`*^9, 
   3.7654138773935146`*^9}},
 CellLabel->"In[14]:=",ExpressionUUID->"a1faed7e-f698-4005-bb8e-a49abc8f82fa"],

Cell[BoxData[
 RowBox[{
  RowBox[{"glancingBlow", "[", 
   RowBox[{"a_", ",", 
    RowBox[{"{", 
     RowBox[{"p1_", ",", "p2_", ",", "p3_"}], "}"}]}], "]"}], ":=", 
  "\[IndentingNewLine]", 
  RowBox[{"Xor", "[", 
   RowBox[{
    RowBox[{"reflex", "[", 
     RowBox[{"p1", ",", "p2", ",", "a"}], "]"}], ",", " ", 
    RowBox[{"reflex", "[", 
     RowBox[{"p3", ",", "p2", ",", "a"}], "]"}]}], "]"}]}]], "Input",
 InitializationCell->True,
 CellLabel->"In[15]:=",ExpressionUUID->"03c90cc8-d266-427d-8b34-2bccc4dc1885"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Function", " ", "Gives", " ", "whether", " ", "a", " ", "point", " ", 
     "is", " ", "reflex", " ", "or", " ", "not"}], ",", " ", 
    RowBox[{
    "Chop", " ", "is", " ", "used", " ", "to", " ", "round", " ", "of", " ", 
     "to", " ", "the", " ", "nearest", " ", 
     RowBox[{"integer", ".", " ", "From"}], " ", "Motion", " ", "Plannning", 
     " ", "Book", " ", "by", " ", "Steven", " ", 
     RowBox[{"M", ".", "LaValle"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"reflex", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x1_", ",", "y1_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"x3_", ",", "y3_"}], "}"}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"Chop", "[", 
     RowBox[{"Det", "[", 
      RowBox[{"(", "\[NoBreak]", GridBox[{
         {"1", "x1", "y1"},
         {"1", "x2", "y2"},
         {"1", "x3", "y3"}
        }], "\[NoBreak]", ")"}], "]"}], "]"}], ">", "  ", "0", 
    "  "}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.755908815855939*^9, 3.7559088459664335`*^9}, {
   3.755947005882975*^9, 3.755947061346826*^9}, {3.7559498333751707`*^9, 
   3.755949914995143*^9}, {3.755950054536367*^9, 3.755950065385194*^9}, {
   3.755950151887475*^9, 3.755950153163884*^9}, {3.755993678293873*^9, 
   3.7559937695215335`*^9}, {3.755993810855974*^9, 3.755993812877569*^9}, {
   3.757607439289873*^9, 3.757607439746631*^9}, {3.757609238931039*^9, 
   3.7576094670480924`*^9}, {3.757609498202787*^9, 3.7576094995541916`*^9}, {
   3.7576096406448946`*^9, 3.7576096476861033`*^9}, 3.7576101114820843`*^9, {
   3.7579840705646143`*^9, 3.757984078389755*^9}, {3.7579841540840235`*^9, 
   3.7579841568937693`*^9}, {3.757984225784856*^9, 3.757984226849011*^9}, 
   3.7579857383484926`*^9, {3.75798576993006*^9, 3.757985783572551*^9}, {
   3.7649905481590557`*^9, 3.7649905483025436`*^9}, {3.764990652657299*^9, 
   3.7649906536945343`*^9}, {3.7654213131587653`*^9, 
   3.7654213137502046`*^9}, {3.7654213437899475`*^9, 
   3.7654213447264495`*^9}, {3.765421884884285*^9, 3.7654219510256577`*^9}},
 CellLabel->"In[16]:=",ExpressionUUID->"03691ca4-71d8-4a59-a3c9-2a77dc4c1e9b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"extendedLine", "[", 
   RowBox[{"p1_", ",", "p2_"}], "]"}], ":=", 
  RowBox[{"{", 
   RowBox[{"p1", ",", 
    RowBox[{"(", 
     RowBox[{"p1", "+", 
      RowBox[{"40", 
       RowBox[{"(", 
        RowBox[{"Normalize", "@", 
         RowBox[{"(", 
          RowBox[{"(", 
           RowBox[{"p2", "-", "p1"}], ")"}], ")"}]}], ")"}]}]}], ")"}]}], 
   "}"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7641218415977955`*^9, 3.764122022382304*^9}, {
   3.7641221162104654`*^9, 3.764122132710537*^9}, {3.7641221636645036`*^9, 
   3.7641221922742877`*^9}, {3.7641222862234545`*^9, 3.764122331904281*^9}, {
   3.764122375447214*^9, 3.764122385145474*^9}, {3.7641224344867697`*^9, 
   3.764122498310034*^9}, {3.7641225535676827`*^9, 3.764122651469599*^9}, {
   3.764122814305434*^9, 3.764122825417222*^9}, {3.7641231859448366`*^9, 
   3.7641232221201153`*^9}, {3.764123258070859*^9, 3.764123316119299*^9}, {
   3.7641233778481555`*^9, 3.7641234835794106`*^9}, {3.764123519577031*^9, 
   3.7641235726186304`*^9}, {3.764123632314707*^9, 3.7641236570526123`*^9}, {
   3.7641236956009617`*^9, 3.7641236962849665`*^9}, {3.7641237312602797`*^9, 
   3.7641238330080233`*^9}, {3.7641241597766495`*^9, 3.764124170564658*^9}, {
   3.7641244780586357`*^9, 3.7641245082752323`*^9}, 3.76412453881781*^9, {
   3.7641247699480467`*^9, 3.7641247714249496`*^9}, {3.7641248023419237`*^9, 
   3.7641248119852066`*^9}, {3.7641249132016044`*^9, 3.7641249564216557`*^9}, 
   3.7641249920445623`*^9, {3.7641250463524766`*^9, 3.764125064005801*^9}, {
   3.764125118256483*^9, 3.764125161108537*^9}, {3.7641662919246964`*^9, 
   3.76416630005577*^9}, {3.764166432499324*^9, 3.764166447091194*^9}, {
   3.7641665073455615`*^9, 3.7641665664708166`*^9}, {3.7641666054803967`*^9, 
   3.7641666421068535`*^9}, {3.7641821050636377`*^9, 3.764182116270735*^9}, 
   3.7641821505544543`*^9, {3.764182246151062*^9, 3.764182246247776*^9}, {
   3.7649898550624084`*^9, 3.764989856524984*^9}, {3.765416576202439*^9, 
   3.765416700389082*^9}, {3.7654197577399917`*^9, 3.765419796549307*^9}, {
   3.7654214508499084`*^9, 3.765421484052185*^9}, {3.7654216224863615`*^9, 
   3.7654216839878235`*^9}},
 CellLabel->"In[17]:=",ExpressionUUID->"bc4a6c7d-8a3e-476d-8781-6ebed49ca949"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "returns", " ", "true", " ", "if", " ", "the", " ", "point", " ", "p", " ",
     "lies", " ", "on", " ", "the", " ", "right", " ", "side", " ", "else", 
    " ", "falses"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"leftOrRight", "[", 
    RowBox[{
     RowBox[{"a", ":", 
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}]}], ",", 
     RowBox[{"b", ":", 
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}]}], ",", 
     RowBox[{"p", ":", 
      RowBox[{"{", 
       RowBox[{"x_", ",", "y_"}], "}"}]}]}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"x", "\[Minus]", "x1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"y2", "\[Minus]", "y1"}], ")"}]}], "\[Minus]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"y", "\[Minus]", "y1"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"x2", "\[Minus]", "x1"}], ")"}]}]}], ")"}], "\[GreaterEqual]",
     "  ", "0"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7697928298279767`*^9, 3.7697929276026454`*^9}, {
  3.769792957738123*^9, 3.7697929898692102`*^9}, {3.769793051326936*^9, 
  3.76979306093027*^9}, {3.7697953321587353`*^9, 3.769795332642446*^9}, {
  3.769795392106507*^9, 3.7697953922610903`*^9}, {3.770400835226767*^9, 
  3.770400908075852*^9}},
 CellLabel->"In[18]:=",ExpressionUUID->"c3b2fcf1-fe29-48ea-8383-52c8fc38f62e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "returns", " ", "False", " ", "if", " ", "the", " ", 
    "line", " ", "formed", " ", "by", " ", "points", " ", "p1", " ", "and", 
    " ", "p2", " ", "intersect", " ", "any", " ", "of", " ", "the", " ", 
    RowBox[{"line", "'"}], "s", "  ", "in", " ", "linelist", " ", "else", " ",
     "returns", " ", "true"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"noIntersection", "[", 
    RowBox[{"p1_", ",", "p2_", ",", "linelist_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"Nor", "@@", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"SegmentIntersectionQ", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"p1", ",", "p2"}], "}"}], ",", "#"}], "}"}], "]"}], "&"}], 
      "/@", "linelist"}], ")"}]}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7704004507754483`*^9, 3.770400563114132*^9}, {
  3.7704007510588636`*^9, 3.7704008323404236`*^9}},
 CellLabel->"In[19]:=",ExpressionUUID->"bfea244a-17b2-4ffb-a981-b074f811348e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Returns", " ", "a", " ", "Normal", " ", "Vector", " ", "for", " ", "a", 
    " ", "line", " ", "between", " ", "two", " ", "points"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"normalVector", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"x2_", ",", "y2_"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"x1_", ",", "y1_"}], "}"}]}], "}"}], "]"}], ":=", 
   RowBox[{"Normalize", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "y2"}], "+", "y1"}], ")"}], ",", 
      RowBox[{"x2", "-", "x1"}]}], "}"}], " ", "]"}]}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{3.770635832226679*^9},
 CellLabel->"In[20]:=",ExpressionUUID->"e1a26427-ae47-4f58-92f4-b54e608e581a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Retruns", " ", "True", " ", "if", " ", "collinear", " ", "else", " ", 
    "false"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"https", ":"}], "//", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"mathematica", ".", "stackexchange", ".", "com"}], "/", 
        "questions"}], "/", "120773"}], "/", "remove"}], "-", "inner", "-", 
     "points", "-", "from", "-", "collinear", "-", 
     RowBox[{"list", "/", "120777"}]}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"collinearQ", "[", 
    RowBox[{"pts_", "?", "MatrixQ"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"MatrixRank", "[", 
     RowBox[{"Standardize", "[", 
      RowBox[{"pts", ",", "Mean", ",", 
       RowBox[{"1", "&"}]}], "]"}], "]"}], "==", " ", 
    RowBox[{"Last", "[", 
     RowBox[{"Dimensions", "[", "pts", "]"}], "]"}]}]}]}]], "Input",
 InitializationCell->True,
 InitializationGroup->True,
 CellChangeTimes->{{3.7621801084783154`*^9, 3.7621801883373456`*^9}, {
  3.762180248725587*^9, 3.7621802795787*^9}, {3.762180309790893*^9, 
  3.7621803348501854`*^9}, {3.762180435292134*^9, 3.762180439479703*^9}, {
  3.762180959857411*^9, 3.762180996379208*^9}, {3.7621814567291937`*^9, 
  3.762181508519907*^9}, {3.7621819910234723`*^9, 3.762181993255295*^9}, {
  3.762182024954994*^9, 3.7621820264628983`*^9}, {3.762194903243216*^9, 
  3.762194904835965*^9}, {3.7621949411209636`*^9, 3.76219496035658*^9}},
 CellLabel->"In[21]:=",
 CellID->293955417,ExpressionUUID->"01f52473-7e57-4a4f-a927-a2f371f2e4f5"],

Cell[BoxData[
 RowBox[{"Clear", "[", "\"\<Global`*\>\"", "]"}]], "Input",
 CellChangeTimes->{{3.769801928851533*^9, 3.7698019388478155`*^9}},
 CellLabel->
  "In[558]:=",ExpressionUUID->"df89d1c1-29fd-4de6-a8d4-b00c25e28eaa"],

Cell["\<\
Update 06/18/2019 :
1) Corrected the angleSortCond (same angle points should be sorted based on \
distance closest comes last )
2) In visiblePolysRev3 function visible condition updated for points having \
same angles, check if the next point is closer and has the same angle if so \
its not visible.
3) Added Invisible Polygon in the manipulate, removes the error when point is \
out if the boundary polygon. \
\>", "Subsection",
 CellChangeTimes->{{3.7699088561616*^9, 3.7699092543168974`*^9}, {
  3.7699092957340903`*^9, 3.769909304879629*^9}, {3.7699614630014515`*^9, 
  3.7699614837230167`*^9}, {3.769961564086722*^9, 
  3.769961580861846*^9}},ExpressionUUID->"a174cf14-f58b-46ba-acb9-\
c6aac99a08f6"],

Cell["\<\
Update 06/19/2019:
1) Fixed: The glancing intersection point could not be the vertex of a \
polygon.     

Update 06/022/2019:
1) Fixed: (visiblePolysRev3)The point after glancing point which is not \
visible and lines \[OpenCurlyDoubleQuote]pb\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]lvLine\[CloseCurlyDoubleQuote] do not intersect no \
proper intersection point obtained. 
2) added the \[OpenCurlyDoubleQuote]noIntersection\[CloseCurlyDoubleQuote] \
function.
3) Point on the segment condition changed.

Update 06/24/2019:
1) Added the 2 environment\[CloseCurlyQuote]s
2)joined all the guards.

Update 07/1/2019:
1)Added tFlag condition & offset by getting the unit normal vector with a \
attenuation factor to b value when three points are collinear.
2) Added the pFlag and bFlag Flag\[CloseCurlyQuote]s to decide the glancing \
blow condition.
3) Added new variables to store recurrent operations. 
4) Fixed the errors for point of reference is same as one of the vertices.  
5) Fixed the errors for point of reference is on a line segment.
6)Changed the Names of Environments
\
\>", "Subsection",
 CellChangeTimes->{{3.7699610828543367`*^9, 3.769961322590242*^9}, {
  3.769961544595904*^9, 3.7699615454864836`*^9}, {3.7704000663360014`*^9, 
  3.7704000986918154`*^9}, {3.770401115203468*^9, 3.7704011237042065`*^9}, {
  3.7704038145046415`*^9, 3.7704038422381067`*^9}, {3.770565068967491*^9, 
  3.770565152630473*^9}, {3.7717954081139107`*^9, 3.7717955535492096`*^9}, {
  3.7717955903495617`*^9, 3.77179575573779*^9}, {3.7717957931588078`*^9, 
  3.771796007963355*^9}, {3.771796710359644*^9, 
  3.7717967439564357`*^9}},ExpressionUUID->"6d396458-bf60-46b3-a5c0-\
4551a98bff4d"],

Cell[CellGroupData[{

Cell["\<\
Changes to be Done :
4) Comments
5)Make a Demo and writeup
6)Code review\
\>", "Subsection",
 CellChangeTimes->{{3.7699688755549793`*^9, 3.7699690276421537`*^9}, {
  3.771782925116787*^9, 3.7717829262527857`*^9}, {3.7717967487876463`*^9, 
  3.7717967633189116`*^9}},ExpressionUUID->"a0e5984f-e27a-4833-bc38-\
eb8682c894e5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"ColorData", "[", 
   RowBox[{"100", ",", "\"\<ColorList\>\""}], "]"}]}]], "Input",
 CellChangeTimes->{{3.7717974731446176`*^9, 3.771797633667289*^9}, {
  3.7717976812326*^9, 3.771797703885063*^9}},
 CellLabel->
  "In[686]:=",ExpressionUUID->"6ffa06f4-25a9-4e77-9318-7a875a83fa6d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.0684356, 0.645252, 0.782123], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[
        0.04562373333333333, 0.43016800000000005`, 0.5214153333333333],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"0.0684356`", ",", "0.645252`", ",", "0.782123`"}], "]"}], 
       NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.0684356, 0.645252, 0.782123]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.0684356, 0.645252, 0.782123],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.98993, 0.699651, 0.0271887], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.6599533333333334, 0.466434, 0.0181258],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"0.98993`", ",", "0.699651`", ",", "0.0271887`"}], "]"}], 
       NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.98993, 0.699651, 0.0271887]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.98993, 0.699651, 0.0271887],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.450866, 0.379481, 1.], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[
        0.30057733333333336`, 0.25298733333333334`, 0.6666666666666667],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"0.450866`", ",", "0.379481`", ",", "1.`"}], "]"}], 
       NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.450866, 0.379481, 1.]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.450866, 0.379481, 1.],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.369422, 0.7, 0.229826], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[
        0.24628133333333332`, 0.4666666666666667, 0.15321733333333334`],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"0.369422`", ",", "0.7`", ",", "0.229826`"}], "]"}], 
       NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.369422, 0.7, 0.229826]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.369422, 0.7, 0.229826],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.942659, 0.463296, 0.151884], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.6284393333333333, 0.308864, 0.101256],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"0.942659`", ",", "0.463296`", ",", "0.151884`"}], "]"}], 
       NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.942659, 0.463296, 0.151884]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.942659, 0.463296, 0.151884],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.214511, 0.528391, 0.957413], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[
        0.14300733333333335`, 0.3522606666666667, 0.6382753333333333],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"0.214511`", ",", "0.528391`", ",", "0.957413`"}], "]"}], 
       NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.214511, 0.528391, 0.957413]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.214511, 0.528391, 0.957413],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.827693, 0.730855, 0.], RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.5517953333333334, 0.4872366666666667, 0.],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"0.827693`", ",", "0.730855`", ",", "0.`"}], "]"}], 
       NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.827693, 0.730855, 0.]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.827693, 0.730855, 0.],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.546532, 0.322857, 0.883671], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.3643546666666667, 0.215238, 0.589114],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"0.546532`", ",", "0.322857`", ",", "0.883671`"}], "]"}], 
       NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.546532, 0.322857, 0.883671]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.546532, 0.322857, 0.883671],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.0575287, 0.697632, 0.634101], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[
        0.03835246666666667, 0.46508800000000006`, 0.42273400000000005`],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"0.0575287`", ",", "0.697632`", ",", "0.634101`"}], "]"}], 
       NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.0575287, 0.697632, 0.634101]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.0575287, 0.697632, 0.634101],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.971874, 0.609371, 0.0759396], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[0.647916, 0.40624733333333335`, 0.0506264],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{"0.971874`", ",", "0.609371`", ",", "0.0759396`"}], "]"}], 
       NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.971874, 0.609371, 0.0759396]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.971874, 0.609371, 0.0759396],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[
         0.24027755634958686`, 0.5134535951530563, 0.9542792262231498], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[
        0.16018503756639124`, 0.3423023967687042, 0.6361861508154332],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{
          "0.24027755634958686`", ",", "0.5134535951530563`", ",", 
           "0.9542792262231498`"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[
          0.24027755634958686`, 0.5134535951530563, 0.9542792262231498]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.24027755634958686`, 0.5134535951530563, 0.9542792262231498],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[
         0.664468179450943, 0.7160576871329034, 0.038246733312056906`], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[
        0.4429787863006287, 0.47737179142193564`, 0.025497822208037937`],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{
          "0.664468179450943`", ",", "0.7160576871329034`", ",", 
           "0.038246733312056906`"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[
          0.664468179450943, 0.7160576871329034, 0.038246733312056906`]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.664468179450943, 0.7160576871329034, 0.038246733312056906`],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.5359107296880482, 0.3292005458464977, 0.8879524511010058],
          RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[
        0.35727381979203215`, 0.2194670305643318, 0.591968300734004],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{
          "0.5359107296880482`", ",", "0.3292005458464977`", ",", 
           "0.8879524511010058`"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.5359107296880482, 0.3292005458464977, 0.8879524511010058]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.5359107296880482, 0.3292005458464977, 0.8879524511010058],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[
         0.09300232680379224, 0.6615923955711573, 0.7003478159388691], 
         RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[
        0.06200155120252816, 0.44106159704743825`, 0.46689854395924607`],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{
          "0.09300232680379224`", ",", "0.6615923955711573`", ",", 
           "0.7003478159388691`"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[
          0.09300232680379224, 0.6615923955711573, 0.7003478159388691]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.09300232680379224, 0.6615923955711573, 0.7003478159388691],
    Editable->False,
    Selectable->False], ",", 
   InterpretationBox[
    ButtonBox[
     TooltipBox[
      GraphicsBox[{
        {GrayLevel[0], RectangleBox[{0, 0}]}, 
        {GrayLevel[0], RectangleBox[{1, -1}]}, 
        {RGBColor[0.9875991060491971, 0.716733028919815, 0.01761147689957558],
          RectangleBox[{0, -1}, {2, 1}]}},
       AspectRatio->1,
       DefaultBaseStyle->"ColorSwatchGraphics",
       Frame->True,
       FrameStyle->RGBColor[
        0.6583994040327981, 0.4778220192798767, 0.011740984599717055`],
       FrameTicks->None,
       ImageSize->
        Dynamic[{
         Automatic, 1.35 CurrentValue["FontCapHeight"]/AbsoluteCurrentValue[
          Magnification]}],
       PlotRangePadding->None],
      StyleBox[
       RowBox[{"RGBColor", "[", 
         RowBox[{
          "0.9875991060491971`", ",", "0.716733028919815`", ",", 
           "0.01761147689957558`"}], "]"}], NumberMarks -> False]],
     Appearance->None,
     BaseStyle->{},
     BaselinePosition->Baseline,
     ButtonFunction:>With[{Typeset`box$ = EvaluationBox[]}, 
       If[
        Not[
         AbsoluteCurrentValue["Deployed"]], 
        SelectionMove[Typeset`box$, All, Expression]; 
        FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
        FrontEnd`Private`$ColorSelectorInitialColor = 
         RGBColor[0.9875991060491971, 0.716733028919815, 0.01761147689957558]; 
        FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
        MathLink`CallFrontEnd[
          FrontEnd`AttachCell[Typeset`box$, 
           FrontEndResource["RGBColorValueSelector"], {0, {Left, Bottom}}, {
           Left, Top}, 
           "ClosingActions" -> {
            "SelectionDeparture", "ParentChanged", "EvaluatorQuit"}]]]],
     DefaultBaseStyle->{},
     Evaluator->Automatic,
     Method->"Preemptive"],
    RGBColor[0.9875991060491971, 0.716733028919815, 0.01761147689957558],
    Editable->False,
    Selectable->False]}], "}"}]], "Output",
 CellChangeTimes->{{3.7717974845153604`*^9, 3.7717976341742306`*^9}, {
  3.7717976836730704`*^9, 3.7717977042163877`*^9}},
 CellLabel->
  "Out[686]=",ExpressionUUID->"1e069079-93c5-45cc-8008-5dc83e188c44"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"xyz", "=", 
   RowBox[{"N", "@", 
    RowBox[{"CirclePoints", "@", "6"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xa", "=", 
   RowBox[{"xyz", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"xb", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"Position", "[", 
    RowBox[{"xyz", ",", "xa"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"xyz", "\[LeftDoubleBracket]", 
  RowBox[{"xb", "-", "1"}], "\[RightDoubleBracket]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xyz", "\[LeftDoubleBracket]", 
   RowBox[{"xb", "+", "1"}], "\[RightDoubleBracket]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.771961787672107*^9, 3.7719618852185116`*^9}, {
  3.7719619438715315`*^9, 
  3.7719622051821203`*^9}},ExpressionUUID->"9f1f461d-5848-40a3-99dc-\
0990880f90a2"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{{3.771962136530673*^9, 3.771962201908392*^9}},
 CellLabel->
  "Out[166]=",ExpressionUUID->"41d21d22-c738-4745-b853-493476945b19"],

Cell[BoxData[
 RowBox[{"{", "2", "}"}]], "Output",
 CellChangeTimes->{{3.771962136530673*^9, 3.7719622019143314`*^9}},
 CellLabel->
  "Out[167]=",ExpressionUUID->"23511494-5429-4d81-837d-f4c6ddb52766"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0.5`", ",", 
    RowBox[{"-", "0.8660254037844386`"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.771962136530673*^9, 3.771962201923736*^9}},
 CellLabel->
  "Out[168]=",ExpressionUUID->"0e1dd045-857d-4fd1-8d11-c402f6ff0fdb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"0.5`", ",", "0.8660254037844386`"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.771962136530673*^9, 3.7719622019344854`*^9}},
 CellLabel->
  "Out[169]=",ExpressionUUID->"86da9574-fb7e-4eb6-86ff-e5cb79d30b80"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1536, 791},
WindowMargins->{{-8, Automatic}, {Automatic, -8}},
Magnification:>1.5 Inherited,
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (March 6, 2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 32091, 707, 1320, "Input",ExpressionUUID->"4b1e4c1e-ed26-4125-97e1-052f34df3a3d"],
Cell[32674, 731, 15747, 260, 711, "Output",ExpressionUUID->"b3d26449-ab1a-47e1-a3af-b75816645fc6"]
}, Open  ]],
Cell[48436, 994, 129, 3, 43, "Input",ExpressionUUID->"1ef0df80-8aa1-418f-b49c-d1c949c3113c"],
Cell[48568, 999, 156, 3, 43, "Input",ExpressionUUID->"e32b32fa-366c-4519-b8ad-5bc9bc3f42e8"],
Cell[48727, 1004, 39491, 875, 3200, "Input",ExpressionUUID->"27e2e2df-3c39-4f6b-95e4-036ec10f660d",
 InitializationCell->True],
Cell[88221, 1881, 1338, 36, 97, "Input",ExpressionUUID->"489dc7cc-4609-4a3a-b301-7e75ad24757d",
 InitializationCell->True],
Cell[89562, 1919, 862, 21, 97, "Input",ExpressionUUID->"1c5da78c-468b-4edc-9d12-bdd89d1e53bd",
 InitializationCell->True,
 CellID->141966600],
Cell[90427, 1942, 898, 23, 97, "Input",ExpressionUUID->"73000d20-a362-4638-81c8-256171429fad",
 InitializationCell->True,
 CellID->126976910],
Cell[91328, 1967, 732, 15, 67, "Input",ExpressionUUID->"cee72fa1-6022-4201-88c7-59b2a292d876",
 InitializationCell->True],
Cell[92063, 1984, 2047, 50, 126, "Input",ExpressionUUID->"c51f5954-0da3-49f3-915a-f6169e1dbd67",
 InitializationCell->True],
Cell[94113, 2036, 2004, 47, 155, "Input",ExpressionUUID->"8606bed4-916d-489a-89d9-6f016c2a88c4",
 InitializationCell->True],
Cell[96120, 2085, 2148, 55, 168, "Input",ExpressionUUID->"a7cccfd8-a907-43ad-b649-59ca4fe78d7d",
 InitializationCell->True,
 CellID->91357628],
Cell[98271, 2142, 3156, 85, 996, "Input",ExpressionUUID->"0b63a5b3-ab3d-4c25-b8f0-e4fcc0c54efc",
 InitializationCell->True,
 CellID->1379934535],
Cell[101430, 2229, 6692, 140, 1224, "Input",ExpressionUUID->"ef6b92ba-e910-42c9-9ea0-866c5cdeb63b",
 InitializationCell->True,
 CellID->1016457520],
Cell[108125, 2371, 1107, 29, 636, "Input",ExpressionUUID->"2ce32eea-1519-4da2-9881-eb2c7572e819",
 InitializationCell->True],
Cell[109235, 2402, 4300, 103, 1665, "Input",ExpressionUUID->"155ff77f-05d4-4dc5-b4cf-48e7b762424f",
 InitializationCell->True],
Cell[113538, 2507, 3096, 74, 1518, "Input",ExpressionUUID->"a1faed7e-f698-4005-bb8e-a49abc8f82fa",
 InitializationCell->True],
Cell[116637, 2583, 518, 14, 490, "Input",ExpressionUUID->"03c90cc8-d266-427d-8b34-2bccc4dc1885",
 InitializationCell->True],
Cell[117158, 2599, 2266, 47, 911, "Input",ExpressionUUID->"03691ca4-71d8-4a59-a3c9-2a77dc4c1e9b",
 InitializationCell->True],
Cell[119427, 2648, 2284, 40, 337, "Input",ExpressionUUID->"bc4a6c7d-8a3e-476d-8781-6ebed49ca949",
 InitializationCell->True],
Cell[121714, 2690, 1464, 39, 490, "Input",ExpressionUUID->"c3b2fcf1-fe29-48ea-8383-52c8fc38f62e",
 InitializationCell->True],
Cell[123181, 2731, 1093, 26, 783, "Input",ExpressionUUID->"bfea244a-17b2-4ffb-a981-b074f811348e",
 InitializationCell->True],
Cell[124277, 2759, 826, 24, 490, "Input",ExpressionUUID->"e1a26427-ae47-4f58-92f4-b54e608e581a",
 InitializationCell->True],
Cell[125106, 2785, 1597, 37, 636, "Input",ExpressionUUID->"01f52473-7e57-4a4f-a927-a2f371f2e4f5",
 InitializationCell->True,
 InitializationGroup->True,
 CellID->293955417],
Cell[126706, 2824, 224, 4, 216, "Input",ExpressionUUID->"df89d1c1-29fd-4de6-a8d4-b00c25e28eaa"],
Cell[126933, 2830, 716, 14, 1203, "Subsection",ExpressionUUID->"a174cf14-f58b-46ba-acb9-c6aac99a08f6"],
Cell[127652, 2846, 1705, 37, 4475, "Subsection",ExpressionUUID->"6d396458-bf60-46b3-a5c0-4551a98bff4d"],
Cell[CellGroupData[{
Cell[129382, 2887, 333, 9, 3411, "Subsection",ExpressionUUID->"a0e5984f-e27a-4833-bc38-eb8682c894e5"],
Cell[CellGroupData[{
Cell[129740, 2900, 338, 7, 1431, "Input",ExpressionUUID->"6ffa06f4-25a9-4e77-9318-7a875a83fa6d"],
Cell[130081, 2909, 27076, 714, 951, "Output",ExpressionUUID->"1e069079-93c5-45cc-8008-5dc83e188c44"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157194, 3628, 901, 22, 4342, "Input",ExpressionUUID->"9f1f461d-5848-40a3-99dc-0990880f90a2"],
Cell[158098, 3652, 226, 5, 951, "Output",ExpressionUUID->"41d21d22-c738-4745-b853-493476945b19"],
Cell[158327, 3659, 201, 4, 951, "Output",ExpressionUUID->"23511494-5429-4d81-837d-f4c6ddb52766"],
Cell[158531, 3665, 287, 7, 951, "Output",ExpressionUUID->"0e1dd045-857d-4fd1-8d11-c402f6ff0fdb"],
Cell[158821, 3674, 269, 6, 951, "Output",ExpressionUUID->"86da9574-fb7e-4eb6-86ff-e5cb79d30b80"]
}, Open  ]]
}, Open  ]]
}
]
*)

